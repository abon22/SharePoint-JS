<script type="text/javascript" src="/SiteAssets/Scripts/jquery.min.js"></script><script src="/SiteAssets/sputility.min.js"></script><script type="text/javascript" src="/SiteAssets/Scripts/jquery.timeago.js"></script><script type="text/javascript" src="/_layouts/15/SP.dateTimeUtil.js"></script><script src="/SiteAssets/jquery.SPServices-2013.02a.js" type="text/javascript"></script>
<!DOCTYPE html>
<html>
<head>

<meta name="layout" />
 
      <!--Import Google Icon Font-->
      <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
      <!--Import materialize.css-->
      <link type="text/css" rel="stylesheet" href="https://intranet.houseofit.com.au/SiteAssets/CSR%20TEMPLATE/EmployeeProfile/MaterialDesign/css/materialize.css"  media="screen,projection"/>

      <!-- SWEET ALERT -->
      <link href="https://intranet.houseofit.com.au/SiteAssets/CSR%20TEMPLATE/EmployeeProfile/MaterialDesign/SweetAlert2/sweetalert2.css" rel="stylesheet"/>

      <link href="https://intranet.houseofit.com.au/SiteAssets/CSR%20TEMPLATE/EmployeeProfile/MaterialDesign/SweetAlert2/animate.css" rel="stylesheet">


<style type="text/css">
  
  .AlignButtonRight{
  float: right;
}

.ModalTopDistance{
	top:2% !important;
}

i.icon-blue {
    color: #03a9f4;
}

</style>

 <script type="text/javascript">
  
  $(document).ready(function() {

  $('select').material_select();
  $('.collapsible').collapsible();
  $('.tooltipped').tooltip({delay: 30});
  $('.modal').modal();
  // $(".button-collapse").sideNav();

 $('.timepicker').pickatime({
    default: 'now', // Set default time
    fromnow: 0,       // set default time to * milliseconds from now (using with default = 'now')
    twelvehour: true, // Use AM/PM or 24-hour format
    donetext: 'OK', // text for done-button
    cleartext: 'Clear', // text for clear-button
    canceltext: 'Cancel', // Text for cancel-button
    autoclose: true, // automatic close timepicker
    ampmclickable: true, // make AM PM clickable
    aftershow: function(){} //Function for after opening timepicker  
  });

   $('.datepicker').pickadate({
    selectMonths: true, // Creates a dropdown to control month
    selectYears: 100, // Creates a dropdown of 15 years to control year,
    today: 'Today',
    clear: 'Clear',
    close: 'Ok',
    closeOnSelect: true,
    format: 'mm/dd/yyyy',
  });

  $('.button-collapse').sideNav({
      menuWidth: 600, // Default is 240
      edge: 'right', // Choose the horizontal origin
      closeOnClick: true// Closes side-nav on <a> clicks, useful for Angular/Meteor
    }
  );


  $('.dropdown-button').dropdown({
      inDuration: 300,
      outDuration: 225,
      constrainWidth: false, // Does not change width of dropdown to that of the activator
      hover: true, // Activate on hover
      gutter: 0, // Spacing from edge
      belowOrigin: false, // Displays dropdown below the button
      alignment: 'left', // Displays dropdown with edge aligned to the left of button
      stopPropagation: false // Stops event propagation
    }
  );




// var CurrentTime =  new Date().toLocaleTimeString('en-US', { hour12: true, 
//                                              hour: "numeric", 
//                                              minute: "numeric"});


document.getElementById("ctl00_PlaceHolderSearchArea_SmallSearchInputBox1_csr_sboxdiv").remove();
// ExecuteOrDelayUntilScriptLoaded(checkuserprofile,'sp.js');

 // var userid= _spPageContextInfo.userId;
 //  var requestUri = _spPageContextInfo.webAbsoluteUrl + "/_api/web/getuserbyid(" + userid + ")";
 //  var requestHeaders = { "accept" : "application/json;odata=verbose" };
 //  $.ajax({
 //    url : requestUri,
 //    contentType : "application/json;odata=verbose",
 //    headers : requestHeaders,
 //    success : onSuccess,
 //    error : onError
 //  });
//---------------------------------------------------------------------------------------------------


  $('#ModalNewEntry').modal({
      dismissible: false, // Modal can be dismissed by clicking outside of the modal
      opacity: .5, // Opacity of modal background
      inDuration: 300, // Transition in duration
      outDuration: 200, // Transition out duration
      startingTop: '0%', // Starting top style attribute
      endingTop: '10%', // Ending top style attribute
      ready: function(modal, trigger) { // Callback for Modal open. Modal and trigger parameters available.
         $('select').material_select();
        
      },
      complete: function() {  } // Callback for Modal close
    }
  );

  $('#Modal_Entries').modal({
      dismissible: false, // Modal can be dismissed by clicking outside of the modal
      opacity: .5, // Opacity of modal background
      inDuration: 300, // Transition in duration
      outDuration: 200, // Transition out duration
      startingTop: '0%', // Starting top style attribute
      endingTop: '10%', // Ending top style attribute
      ready: function(modal, trigger) { // Callback for Modal open. Modal and trigger parameters available.
         $('select').material_select();
        
      },
      complete: function() {  } // Callback for Modal close
    }
  );





// new Chart(document.getElementById("chart_Errors"), {
//     type: 'horizontalBar',
//     data: {
//       labels: ["Africa", "Asia", "Europe", "Latin America", "North America","Africa", "Asia", "Europe", "Latin America", "North America"],
//       datasets: [
//         {
//           label: "Error Count",
//           backgroundColor: ["#3cba9f","#3cba9f","#3cba9f","#3cba9f","#3cba9f","#3cba9f","#3cba9f","#3cba9f","#3cba9f","#3cba9f","#3cba9f","#3cba9f","#3cba9f","#3cba9f","#3cba9f","#3cba9f","#3cba9f","#3cba9f","#3cba9f","#3cba9f","#3cba9f","#3cba9f","#3cba9f","#3cba9f","#3cba9f","#3cba9f","#3cba9f","#3cba9f","#3cba9f","#3cba9f","#3cba9f","#3cba9f","#3cba9f","#3cba9f","#3cba9f","#3cba9f"],
//           data: [1,2,0,3,0,1,1,0,0,0,1,0,1,0,0]
//         }
//       ]
//     },
//     options: {
//       legend: { display: false },
//       title: {
//         display: true,
//         text: 'ERRORS'
//       },
//               scales: {
//             xAxes: [{
//                 ticks: {
//                   stepSize: 1,
//                     beginAtZero:true,
//                     max:5
//                 }
//             }]
//         },
//     }
// });

  var months = [ "January", "February", "March", "April", "May", "June",
    "July", "August", "September", "October", "November", "December" ];
  var current_date = new Date();
  var current_month = months[current_date.getMonth()];


new Chart(document.getElementById("chart_Reworks"), {
    type: 'horizontalBar',
    data: {
      labels: ["Africa", "Asia", "Europe", "Latin America", "North America"],
      datasets: [
        {
          label: "Population (millions)",
          backgroundColor: "#3e95cd",
          data: [0,1,0,2,1]
        }
      ]
    },
    options: {
      legend: { display: false },
      title: {
        display: true,
        text: 'REWORKS'
      },
                    scales: {
            xAxes: [{
                ticks: {
                  stepSize: 1,
                    beginAtZero:true,
                    max:5
                }
            }]
        },
    }
});

new Chart(document.getElementById("chart_TotalPoints_CurrentMonth"), {
    type: 'horizontalBar',
    data: {
      labels: ["Africa", "Asia", "Europe", "Latin America", "North America"],
      datasets: [
        {
          label: "Population (millions)",
          backgroundColor: "#c45850",
          data: [1,0,1,2,1]
        }
      ]
    },
    options: {
      legend: { display: false },
      title: {
        display: true,
        text: current_month
      },
                    scales: {
            xAxes: [{
                ticks: {
                  stepSize: 1,
                    beginAtZero:true,
                    max:5
                }
            }]
        },
    }
});

new Chart(document.getElementById("chart_TotalPoints_perMonth"), {
    type: 'bar',
    data: {
      labels: ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"],
      datasets: [
        {
          label: "Regularized Employee(s)",
          backgroundColor: ["#3e95cd", "#8e5ea2","#3cba9f","#e8c3b9","#c45850","#3e95cd","#8e5ea2","#3cba9f","#e8c3b9","#c45850","#3e95cd", "#8e5ea2"],
          data: [2,6,13,3,7]
        }
      ]
    },
    options: {
      legend: { display: false },
      ticks: {beginAtZero:true},
      title: {
        display: true,
        text: 'Regularized Employee(s)'
      },
      scales: {
            yAxes: [{
                ticks: {
                	stepSize: 1,
                    beginAtZero:true
                }
            }]
        },
    }
});


// EXECUTE SCRIPTS
ExecuteOrDelayUntilScriptLoaded(Load_EmployeeNames,'sp.js');
ExecuteOrDelayUntilScriptLoaded(Get_Entries,'sp.js');


//------------------------------------------------


$(document).on('change',"#DP_EntryType", function() { 
  // alert( $(this).val())
      if($(this).val() == "Error"){
          document.getElementById("TB_Points").value = "1";
      }
      else if($(this).val() == "Rework"){
          document.getElementById("TB_Points").value = "2";
      }      
});


}); //---------------------------------------END OF DOCUMENT READY FUNCTION----------------------------------------------------------

//---------------------> GET CURRENT USER <---------------------------------------------------------

  // function onSuccess(data, request){
  //   var loginName = data.d.Title;
  //   // alert(loginName);
  //   if(loginName != "Fernando Durano Singson Jr." && loginName != "Victor Surita" && loginName != "Idrian Belleza" && loginName != "Victor Surita" && loginName != "Carl James Ambowang" && loginName != "Lito Abon Jr."){
  //   	  document.getElementById("ShowExcel").remove();
  //   }

  // }
  // function onError(error) {
  //   alert("error");
  // }

  // IF EMPTY OR WHITE SPACE ----------------------------------------------------------------------------------------------
function isEmptyOrSpaces(str){
    return str === null || str.match(/^ *$/) !== null;
}
//----------------------------------------------------------------------------------------------
// OPEN MODALS

function AddEntry_Clicked(){
	Entry_Function = "Add";
	OpenNewEntry_Modal();
}

function OpenNewEntry_Modal(){
  $('#ModalNewEntry').modal('open');
}
function CloseNewEntry_Modal(){
  $('#ModalNewEntry').modal('close');
}


function Open_Entries_Modal(){
  $('#Modal_Entries').modal('open');
}
function Close_Entries_Modal(){
  $('#Modal_Entries').modal('close');
}

function Clear_EntryFormFields(){
	document.getElementById('DP_EmployeeName').selectedIndex = 0;
	document.getElementById('DP_Section').selectedIndex = 0;
	document.getElementById('DP_EntryType').selectedIndex = 0;
	document.getElementById("TB_Points").value = "";
	document.getElementById("Date_EntryDate").value = "";
	document.getElementById("TB_TicketNumber").value = "";
	document.getElementById("Txt_Description").value = "";
}

//------------------------------------------------------------------------------------------------------------------
// VARIABLES

var Entry_Function;
var IT_Employees = [];
var IT_Employees_ID = [];
var TotalPoints_Error_PerEmployee = [];

var IT_Employees_Items;

function Load_EmployeeNames() {
  var siteUrl = 'https://intranet.houseofit.com.au/it/';
	var clientContext = new SP.ClientContext(siteUrl);

  // Department
  var Departments = clientContext.get_web().get_lists().getByTitle("IT Members");
  var camlQuery_Department = new SP.CamlQuery();
      camlQuery_Department.set_viewXml(
      '<View>'+
      '<Query>'+
      '<Where>'+          
      '<Eq>'+
      '<FieldRef Name=\'Status\'/>' + 
      '<Value Type=\'Text\'>'+"Active"+'</Value>'+
      '</Eq>'+
      '</Where>'+
      '</Query>'+
      '</View>');
  this.IT_Employees_Items = Departments.getItems(camlQuery_Department);

  clientContext.load(IT_Employees_Items);
  clientContext.executeQueryAsync(Read_Employee_Succeeded, onQueryFailed);

}

function Read_Employee_Succeeded(sender, args) {
    var listItemsCollection = IT_Employees_Items.getEnumerator();
    var Array_Employee= [];

    while (listItemsCollection.moveNext()) {
      var listItem = listItemsCollection.get_current();
        Array_Employee.push(listItem.get_item('Title'));
        IT_Employees.push(listItem.get_item('Title'));
        IT_Employees_ID.push(listItem.get_item('Employee_ID'));

      //  console.log(IT_Employees + " = " + IT_Employees_ID);
    }

    for (var i = 0; i<=Array_Employee.length-1; i++){
        var opt = document.createElement('option');
        opt.innerHTML = Array_Employee[i];
        opt.value = Array_Employee[i];
      document.getElementById('DP_EmployeeName').appendChild(opt);
    }



new Chart(document.getElementById("chart_Errors"), {
    type: 'horizontalBar',
    data: {
      labels: IT_Employees,
      datasets: [
        {
          label: "Error Count",
          backgroundColor: "#3cba9f",
          data: [1,1,1,1,1,1,3,5,2]
        }
      ]
    },
    options: {
      legend: { display: false },
      title: {
        display: true,
        text: 'ERRORS'
      },
              scales: {
            xAxes: [{
                ticks: {
                  stepSize: 1,
                    beginAtZero:true,
                    max:5
                }
            }]
        },
    }
});


    $('select').material_select();

    ExecuteOrDelayUntilScriptLoaded(GetErrors,'sp.js');
   // ExecuteOrDelayUntilScriptLoaded(LoadErrors,'sp.js');
}

//-----------------------------------------------------------------------------------------------------------------

function onQueryFailed(sender, args) {

    alert('Request failed. ' + args.get_message() + '\n' + args.get_stackTrace());
}


var oListItem_Points;
function AddEntry(){

	var months = [ "January", "February", "March", "April", "May", "June",
	    "July", "August", "September", "October", "November", "December" ];

	var V_CurrentTime =  new Date().toLocaleTimeString('en-US', { hour12: true, 
	                                             hour: "numeric", 
	                                             minute: "numeric"});


	  var EntryDate = new Date(document.getElementById("Date_EntryDate").value); 
	  var Moth_EntryDate = EntryDate.getMonth()+1;

	  var V_MonthEntryDate = months[parseInt(Moth_EntryDate)-1];
	  var V_YearEntryDate = EntryDate.getFullYear();  	
    

	var siteUrl = 'https://intranet.houseofit.com.au/';
	var clientContext = new SP.ClientContext(siteUrl);
	var oList = clientContext.get_web().get_lists().getByTitle('IT Point System');

	var itemCreateInfo = new SP.ListItemCreationInformation();
	this.oListItem_Points = oList.addItem(itemCreateInfo);

	oListItem_Points.set_item('LI_EmployeeID', IT_Employees_ID[IT_Employees.indexOf(document.getElementById('DP_EmployeeName').value)]);
	oListItem_Points.set_item('LI_EmployeeName', document.getElementById('DP_EmployeeName').value);
	oListItem_Points.set_item('LI_Section', document.getElementById('DP_Section').value);
	oListItem_Points.set_item('LI_EntryType', document.getElementById('DP_EntryType').value);
	oListItem_Points.set_item('LI_EntryPoints', document.getElementById('TB_Points').value);
	oListItem_Points.set_item('LI_TicketNumber', document.getElementById('TB_TicketNumber').value);
	oListItem_Points.set_item('LI_EntryDescription', document.getElementById('Txt_Description').value);
	oListItem_Points.set_item('LI_EntryDate', document.getElementById('Date_EntryDate').value);
	oListItem_Points.set_item('LI_EntryMonth', V_MonthEntryDate);
	oListItem_Points.set_item('LI_EntryYear', V_YearEntryDate);
	oListItem_Points.set_item('LI_TimeAdded', V_CurrentTime);

	oListItem_Points.update();
	clientContext.load(oListItem_Points);
	clientContext.executeQueryAsync(Function.createDelegate(this, this.onQuerySucceeded_AddPoints), Function.createDelegate(this, this.onQueryFailed));
}


function onQuerySucceeded_AddPoints() {

swal({
  type: 'success',
  title: 'Entry has been saved',
  showConfirmButton: false,
  timer: 1000
})

	Clear_EntryFormFields();
	CloseNewEntry_Modal();

	for(var i=document.getElementById("Table_Entries").rows.length;i>1;i--) {
	document.getElementById("Table_Entries").deleteRow(i-1);}
  	ExecuteOrDelayUntilScriptLoaded(Get_Entries, "sp.js");


}

function EditEntry(){

	var months = [ "January", "February", "March", "April", "May", "June",
	    "July", "August", "September", "October", "November", "December" ];

	var V_CurrentTime =  new Date().toLocaleTimeString('en-US', { hour12: true, 
	                                             hour: "numeric", 
	                                             minute: "numeric"});


	  var EntryDate = new Date(document.getElementById("Date_EntryDate").value); 
	  var Moth_EntryDate = EntryDate.getMonth()+1;

	  var V_MonthEntryDate = months[parseInt(Moth_EntryDate)-1];
	  var V_YearEntryDate = EntryDate.getFullYear();  	
    

	var siteUrl = 'https://intranet.houseofit.com.au/';
	var clientContext = new SP.ClientContext(siteUrl);
	var oList = clientContext.get_web().get_lists().getByTitle('IT Point System');

	this.oListItem_Points = oList.getItemById(Entry_ID_ToEdit);

	oListItem_Points.set_item('LI_EmployeeID', IT_Employees_ID[IT_Employees.indexOf(document.getElementById('DP_EmployeeName').value)]);
	oListItem_Points.set_item('LI_EmployeeName', document.getElementById('DP_EmployeeName').value);
	oListItem_Points.set_item('LI_Section', document.getElementById('DP_Section').value);
	oListItem_Points.set_item('LI_EntryType', document.getElementById('DP_EntryType').value);
	oListItem_Points.set_item('LI_EntryPoints', document.getElementById('TB_Points').value);
	oListItem_Points.set_item('LI_TicketNumber', document.getElementById('TB_TicketNumber').value);
	oListItem_Points.set_item('LI_EntryDescription', document.getElementById('Txt_Description').value);
	oListItem_Points.set_item('LI_EntryDate', document.getElementById('Date_EntryDate').value);
	oListItem_Points.set_item('LI_EntryMonth', V_MonthEntryDate);
	oListItem_Points.set_item('LI_EntryYear', V_YearEntryDate);
	oListItem_Points.set_item('LI_TimeAdded', V_CurrentTime);

	oListItem_Points.update();
	clientContext.load(oListItem_Points);
	clientContext.executeQueryAsync(Function.createDelegate(this, this.onQuerySucceeded_AddPoints), Function.createDelegate(this, this.onQueryFailed));
}


function Validate_PointsFields(){
	if(isEmptyOrSpaces(document.getElementById("DP_EmployeeName").options[ document.getElementById("DP_EmployeeName").selectedIndex ].value) ||
		isEmptyOrSpaces(document.getElementById("DP_Section").options[ document.getElementById("DP_Section").selectedIndex ].value) ||
		isEmptyOrSpaces(document.getElementById("DP_EntryType").options[ document.getElementById("DP_EntryType").selectedIndex ].value) ||
		isEmptyOrSpaces(document.getElementById('TB_Points').value) ||
		isEmptyOrSpaces(document.getElementById('Date_EntryDate').value) ||
		isEmptyOrSpaces(document.getElementById('Txt_Description').value)){

		  swal(
		  'Oops...',
		  'Please fill all the required fields!',
		  'error'
		)

	}
	else{
		if(Entry_Function == "Add"){
			AddEntry();
		}
		else if(Entry_Function == "Edit"){
			EditEntry();
		}		

	}

}

var Entry_Items;
function Get_Entries(){
	var	context = SP.ClientContext.get_current();

  var Entries = context.get_web().get_lists().getByTitle("IT Point System");
  var camlQuery = SP.CamlQuery.createAllItemsQuery();
  this.Entry_Items = Entries.getItems(camlQuery);

  context.load(Entry_Items);
  context.executeQueryAsync(GetEntries_Succeeded, onQueryFailed);
}

function GetEntries_Succeeded(sender, args) {
    var listItemsCollection = Entry_Items.getEnumerator();

    while (listItemsCollection.moveNext()) {
      var listItem = listItemsCollection.get_current();

       var var_ItemID = listItem.get_item('ID');

                              $("#Table_Entries").append("<tr align='middle'>" +
                               "<td align='left'>"+listItem.get_item('LI_EmployeeName')+"</td>" +
                               "<td align='left'>"+listItem.get_item('LI_Section')+"</td>" +
                               "<td align='left'>"+listItem.get_item('LI_EntryType')+"</td>"  +
                               "<td align='left'>"+listItem.get_item('LI_EntryPoints')+"</td>"  +
                               "<td align='left'>"+listItem.get_item('LI_TicketNumber')+"</td>"  +
                               "<td align='left'>"+listItem.get_item('LI_EntryDescription')+"</td>"  +
                               "<td align='left'>"+listItem.get_item('LI_EntryDate')+"</td>"  +
                               "<td align='left'>"+listItem.get_item('LI_TimeAdded')+"</td>"  +
                               '<td><a class="btn-floating waves-effect waves-light light-blue z-depth-2 hoverable" id="'+var_ItemID+'" onclick="EditEntry_Clicked(this)" ><i class=" material-icons">mode_edit</i></a></td>' +
                               "</tr>");


    }
}

var Entry_ID_ToEdit;
function EditEntry_Clicked(objButton){
	Entry_ID_ToEdit = objButton.id;
	ExecuteOrDelayUntilScriptLoaded(GetEntry_ToEdit,'sp.js');
	Entry_Function = "Edit";
}

var Entry_ToEdit;
function GetEntry_ToEdit(){
	 var clientContext = new SP.ClientContext(); 
     var targetList = clientContext.get_web().get_lists().getByTitle('IT Point System');
     Entry_ToEdit = targetList.getItemById(Entry_ID_ToEdit);
     clientContext.load(Entry_ToEdit);
     clientContext.executeQueryAsync(Function.createDelegate(this, this.GetEntry_ToEdit_Success), Function.createDelegate(this, this.onQueryFailed));
}
function GetEntry_ToEdit_Success(){
	document.getElementById("DP_EmployeeName").value = Entry_ToEdit.get_item('LI_EmployeeName');
	document.getElementById("DP_Section").value = Entry_ToEdit.get_item('LI_Section');
	document.getElementById("DP_EntryType").value = Entry_ToEdit.get_item('LI_EntryType');
	document.getElementById("TB_Points").value = Entry_ToEdit.get_item('LI_EntryPoints');
	document.getElementById("Date_EntryDate").value = Entry_ToEdit.get_item('LI_EntryDate');
	document.getElementById("TB_TicketNumber").value = Entry_ToEdit.get_item('LI_TicketNumber');
	document.getElementById("Txt_Description").value = Entry_ToEdit.get_item('LI_EntryDescription');

	Close_Entries_Modal();
	OpenNewEntry_Modal();
}


//---------------------------------------------------------------------------------------------------------------
// LOAD CHARTS WITH DATA

var Get_Errors_Items;

var Arrray_Name = [];
var Arrray_Points = [];
var Array_PointsPerEmp = [];


function GetErrors(){
  var CurrentYear = (new Date()).getFullYear();

  var months = [ "January", "February", "March", "April", "May", "June",
    "July", "August", "September", "October", "November", "December" ];
  var current_date = new Date();
  var current_month = months[current_date.getMonth()];

console.log("IT_Employees_ID: " +IT_Employees_ID)

for (var i = 0 ; i <= 1 ; i++){
	console.log("IT_Employees_ID["+i+"]: "+IT_Employees_ID[i])

	   var clientContext = new SP.ClientContext('https://intranet.houseofit.com.au/');
	    var oList = clientContext.get_web().get_lists().getByTitle('IT Point System');
	    var camlQuery = new SP.CamlQuery();
	    camlQuery.set_viewXml(	    
	    '<View>'+
	      '<Query>'+
	      '<Where>'+
	      '<And>'+
	      '<Eq>'+
	      '<FieldRef Name=\'LI_EntryType\'/>' + 
	      '<Value Type=\'Text\'>'+"Error"+'</Value>'+
	      '</Eq>'+  
	      '<And>'+
	      '<Eq>'+
	      '<FieldRef Name=\'LI_EntryMonth\'/>' + 
	      '<Value Type=\'Text\'>'+current_month+'</Value>'+
	      '</Eq>'+ 
	      '<Eq>'+
	      '<FieldRef Name=\'LI_EmployeeID\'/>' + 
	      '<Value Type=\'Text\'>'+IT_Employees_ID[i]+'</Value>'+
	      '</Eq>'+      
	      '</And>'+
	      '</And>'+
	      '</Where>'+
	      '<RowLimit>'+
	      '</RowLimit>'+
	      '</Query>'+
	      '</View>');
	    this.Get_Errors_Items = oList.getItems(camlQuery);
	    clientContext.load(Get_Errors_Items);
	    clientContext.executeQueryAsync(Function.createDelegate(this, 


function(){

	var listItemsCollection = Get_Errors_Items.getEnumerator();

 while (listItemsCollection.moveNext()) {
	var listItem = listItemsCollection.get_current();
	console.log("LI_EmployeeID: "+listItem.get_item('LI_EmployeeID'));

	}
}




	    	), Function.createDelegate(this, this.onQueryFailed)); 
}

/*
  for (var i = 0 ; i <= IT_Employees_ID.length - 1 ; i++)
  {
	  	
	  	var test_id = IT_Employees_ID[i];
	  	console.log("test_id: "+test_id)
	    var clientContext = new SP.ClientContext('https://intranet.houseofit.com.au/');
	    var oList = clientContext.get_web().get_lists().getByTitle('IT Point System');
	    var camlQuery = new SP.CamlQuery();
	    camlQuery.set_viewXml(	    
	    '<View>'+
	      '<Query>'+
	      '<Where>'+
	      '<And>'+
	      '<Eq>'+
	      '<FieldRef Name=\'LI_EntryType\'/>' + 
	      '<Value Type=\'Text\'>'+"Error"+'</Value>'+
	      '</Eq>'+  
	      '<And>'+
	      '<Eq>'+
	      '<FieldRef Name=\'LI_EntryMonth\'/>' + 
	      '<Value Type=\'Text\'>'+current_month+'</Value>'+
	      '</Eq>'+ 
	      '<Eq>'+
	      '<FieldRef Name=\'LI_EmployeeID\'/>' + 
	      '<Value Type=\'Text\'>'+test_id+'</Value>'+
	      '</Eq>'+      
	      '</And>'+
	      '</And>'+
	      '</Where>'+
	      '<RowLimit>'+
	      '</RowLimit>'+
	      '</Query>'+
	      '</View>');
	    this.Get_Errors_Items = oList.getItems(camlQuery);
	    clientContext.load(Get_Errors_Items);
	    clientContext.executeQueryAsync(Function.createDelegate(this, this.GetErrors_Succeeded), Function.createDelegate(this, this.onQueryFailed)); 
  }

	  	console.log(IT_Employees_ID)
	    var clientContext = new SP.ClientContext('https://intranet.houseofit.com.au/');
	    var oList = clientContext.get_web().get_lists().getByTitle('IT Point System');
	    var camlQuery = new SP.CamlQuery();
	    camlQuery.set_viewXml(	    
	    '<View>'+
	      '<Query>'+
	      '<Where>'+
	      '<And>'+
	      '<Eq>'+
	      '<FieldRef Name=\'LI_EntryType\'/>' + 
	      '<Value Type=\'Text\'>'+"Error"+'</Value>'+
	      '</Eq>'+  
	      '<And>'+
	      '<Eq>'+
	      '<FieldRef Name=\'LI_EntryMonth\'/>' + 
	      '<Value Type=\'Text\'>'+current_month+'</Value>'+
	      '</Eq>'+ 
	      '<Eq>'+
	      '<FieldRef Name=\'LI_EntryYear\'/>' + 
	      '<Value Type=\'Text\'>'+CurrentYear+'</Value>'+
	      '</Eq>'+      
	      '</And>'+
	      '</And>'+
	      '</Where>'+
	      '<RowLimit>'+
	      '</RowLimit>'+
	      '</Query>'+
	      '</View>');
	    this.Get_Errors_Items = oList.getItems(camlQuery);
	    clientContext.load(Get_Errors_Items);
	    clientContext.executeQueryAsync(Function.createDelegate(this, this.GetErrors_Succeeded), Function.createDelegate(this, this.onQueryFailed)); 
*/
}

function GetErrors_Succeeded(sender, args){


console.log("a");


/*
 	 //console.log(EmployeeID + " - ");
 	 console.log("Get_Errors_Items.get_count(): "+Get_Errors_Items.get_count() )
 	
 	 	var IDs = [];

  		var listItemsCollection = Get_Errors_Items.getEnumerator();
	    while (listItemsCollection.moveNext()) {
	    	for (var i = 0 ; i <= IT_Employees_ID.length - 1 ; i++){
	    		var listItem = listItemsCollection.get_current();
		    	if(IT_Employees_ID[i] == listItem.get_item('LI_EmployeeID')){
		    		Arrray_Points.push(listItem.get_item('LI_EmployeeID') + ": "+listItem.get_item('LI_EntryPoints')); 
		    	}
		    	else{
		    		Arrray_Points.push(listItem.get_item('LI_EmployeeID')+ ": 0");
		    	}
	    	}

	    }

	    for (var i = 0 ; i <= IT_Employees_ID.length - 1 ; i++){
	  		var listItemsCollection = Get_Errors_Items.getEnumerator();
		    while (listItemsCollection.moveNext()) {
		    	var listItem = listItemsCollection.get_current();
			    	if(IT_Employees_ID[i] == listItem.get_item('LI_EmployeeID')){
			    		Arrray_Points.push(listItem.get_item('LI_EmployeeID') + ": "+listItem.get_item('LI_EntryPoints')); 
			    	}
			    	else{
			    		Arrray_Points.push(listItem.get_item('LI_EmployeeID')+ ": 0");
			    	}
		   	}
	    }


	   console.log(Arrray_Points);

	    var IDs = [];

 		var listItemsCollection = Get_Errors_Items.getEnumerator();
	    while (listItemsCollection.moveNext()) {
	      var listItem = listItemsCollection.get_current();
	        // Arrray_Name.push(listItem.get_item('LI_EmployeeName')); 
	        Arrray_Points.push(listItem.get_item('LI_EntryPoints')); 
	        IDs.push(listItem.get_item('LI_EmployeeID')); 
	    }
*/

}


function GetID(){
	
	// alert(IT_Employees_ID[IT_Employees.indexOf(document.getElementById('DP_EmployeeName').value)]);

	// alert(IT_Employees_ID.length);
}




 </script>

<body>

<main>

    <div class="row">
      	<div class="col s12">
         	<a class="dropdown-button btn-large btn-floating btn-flat light-blue lighten-5 AlignButtonRight tooltipped " id="ViewNotifications" data-position="bottom" data-delay="40" data-tooltip="Show Entries" id="Btn_ViewEntries" onclick="Open_Entries_Modal()"><i class="large material-icons icon-blue">open_in_new</i></a>
      	</div>
    </div>


<div class="row card-panel">

<div class="col s6">
  <div class="card-panel col z-depth-2">
    <canvas id="chart_Errors" width="830" height="320">
      
    </canvas>
  </div>
</div>

<div class="col s6">
  <div class="card-panel col z-depth-2">
    <canvas id="chart_Reworks" width="830" height="320">
      
    </canvas>
  </div>
</div>

<div class="col s6">
  <div class="card-panel col z-depth-2">
    <canvas id="chart_TotalPoints_CurrentMonth" width="830" height="320">
      
    </canvas>
  </div>
</div>

<div class="col s6">
  <div class="card-panel col z-depth-2">
    <canvas id="chart_TotalPoints_perMonth" width="830" height="320">
      
    </canvas>
  </div>
</div>

</div>

<div class="fixed-action-btn">
    <a class="btn-floating btn-large waves-effect waves-light orange z-depth-1 btn-large hoverable" onclick="AddEntry_Clicked()">
      <i class="large material-icons">add</i>
    </a>
</div>

</main>

<!-- --------------------------------------------------------------------------------------------------------------------- -->

<div id="ModalNewEntry" class="modal ModalTopDistance">
    <div id="ModalNewEntryContent" class="modal-content">
          <div class="row">
              <a class="btn-floating red AlignButtonRight" onclick="CloseNewEntry_Modal()"><i class=" material-icons">close</i></a>
          </div>

        <div class="row">
            <div class="col s4"></div>
            <div class="col s4">
                  <div class="card-panel z-depth-2">
                      <div class="input-field row">
                          <select id="DP_EmployeeName">
                            <option value="" disabled selected>Choose an Employee</option>
                          </select>
                          <label>Name</label>
                      </div>                      
                      <div class="input-field row">
                          <select id="DP_Section" >
                            <option value="" disabled selected>Choose a Section</option>
                            <option value="Manage Office">Manage Office</option>
                            <option value="Internal Tech">Internal Tech</option>
                            <option value="Fiber Tech">Fiber Tech</option>
                            <option value="SharePoint Developer">SharePoint Developer</option>
                          </select>
                          <label>Section</label>
                      </div>
                      <div class="input-field row">
                          <select id="DP_EntryType" >
                            <option value="" disabled selected>Choose a Type</option>
                            <option value="Error">Error</option>
                            <option value="Rework">Rework</option>
                          </select>
                          <label>Type</label>
                      </div>                     
                      <div class="input-field row">
                            <input id="TB_Points" type="text" disabled placeholder="">
                            <label for="TB_Points">Points</label>
                      </div>
                      <div class="input-field row">
                            <label>Date</label>
                            <input type = "text" class = "datepicker" id="Date_EntryDate" placeholder="">    
                      </div>
                      <div class="input-field row">
                            <input id="TB_TicketNumber" type="text"  placeholder="">
                            <label for="TB_TicketNumber">Ticket Number</label>
                      </div>                  
                      <div class="input-field row">
	                      <textarea id="Txt_Description" class="materialize-textarea" placeholder=""></textarea>
	                      <label for="Txt_Description">Description</label>
                      </div>                  
                      <div class="row">
                        <a class="waves-effect waves-light btn light-blue darken-1 AlignButtonRight hoverable" onclick="GetID()">Save</a>
                      </div>
                  </div>      
            </div>         
        </div>
    </div>
</div>

<!-- ------------------------------------------------------------------------------------------------------------------- -->


<div id="Modal_Entries" class="modal ModalTopDistance">
    <div id="Modal_EntriesContent" class="modal-content">
      <div class="row">
    <a class="btn-floating red AlignButtonRight" onclick="Close_Entries_Modal()"><i class=" material-icons">close</i></a>
    </div>
    <div class="row">
          <table class="bordered responsive-table card-panel z-depth-2" id="Table_Entries">
                  <thead>
                    <tr>
                        <th>Employee Name</th>
                        <th>Section</th>
                        <th>Type</th>
                        <th>Points</th>
                        <th>Ticket Number</th>
                        <th>Description</th>
                        <th>Date</th>
                        <th>Entry Time</th>
                        <th>Edit</th>
                    </tr>
                  </thead>
              </table>  
      </div>
    </div>
</div>

<!-- --------------------------------------------------------------------------------------------------------------------- -->

  <!--SCRIPT-->

    <script type = "text/javascript" src = "https://code.jquery.com/jquery-2.1.1.min.js"></script>           
    <script src="https://intranet.houseofit.com.au/SiteAssets/CSR%20TEMPLATE/EmployeeProfile/MaterialDesign/js/materialize.min.js"></script>

    <script src="https://intranet.houseofit.com.au/SiteAssets/CSR%20TEMPLATE/EmployeeProfile/MaterialDesign/SweetAlert2/sweetalert2.js"></script>

<!-- CHARTS JS -->
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.1/Chart.bundle.js"></script>
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.1/Chart.bundle.min.js"></script>
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.1/Chart.js"></script>
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.1/Chart.min.js"></script>

	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.20.1/moment.min.js"></script>
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.20.1/moment.js"></script>

</body>
 
</html>
