<script type="text/javascript" src="/SiteAssets/Scripts/jquery.min.js"></script><script src="/SiteAssets/sputility.min.js"></script><script type="text/javascript" src="/SiteAssets/Scripts/jquery.timeago.js"></script><script type="text/javascript" src="../LND%20Point%20System/_layouts/15/sp.runtime.js"></script>
<script type="text/javascript" src="../LND%20Point%20System/_layouts/15/sp.js"></script></script>
<!DOCTYPE html>
<html>
<head>

<meta name="layout" />
 
      <!--Import Google Icon Font-->
      <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
      <!--Import materialize.css-->
      <link type="text/css" rel="stylesheet" href="https://intranet.houseofit.com.au/SiteAssets/CSR%20TEMPLATE/EmployeeProfile/MaterialDesign/css/materialize.css"  media="screen,projection"/>

      <!-- SEMANTIC UI -->
      <link href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.3.1/semantic.min.css" rel="stylesheet" type="text/css" />

      <!-- SWEET ALERT -->
      <link href="https://intranet.houseofit.com.au/SiteAssets/CSR%20TEMPLATE/EmployeeProfile/MaterialDesign/SweetAlert2/sweetalert2.css" rel="stylesheet"/>

      <link href="https://intranet.houseofit.com.au/SiteAssets/CSR%20TEMPLATE/EmployeeProfile/MaterialDesign/SweetAlert2/animate.css" rel="stylesheet">


<style type="text/css">
  
  .AlignButtonRight{
  float: right;
}

  .AlignLeft{
  float: left;
}

.ModalTopDistance{
  top:2% !important;
}

i.icon-blue {
    color: #03a9f4;
}

i.icon-flat {
    color: #ffffff;
}

#sideNavBox {
display: none;
}
#contentBox {
margin-left: 20px;
}
.ms-fullscreenmode #contentBox
{
    margin-left: 0;
}

.spancenter {
    display: flex;
    justify-content: center;
    align-items: center;
}



</style>

 <script type="text/javascript">
  
  $(document).ready(function() {

  $('select').material_select();
  $('.collapsible').collapsible();
  $('.tooltipped').tooltip({delay: 30});
  $('.modal').modal();

  // $(".button-collapse").sideNav();

// document.getElementById("contentRow").style.backgroundColor = "#f2f2f2";
// document.getElementById("s4-titlerow").style.backgroundColor = "#f2f2f2";


 $('.timepicker').pickatime({
    default: 'now', // Set default time
    fromnow: 0,       // set default time to * milliseconds from now (using with default = 'now')
    twelvehour: true, // Use AM/PM or 24-hour format
    donetext: 'OK', // text for done-button
    cleartext: 'Clear', // text for clear-button
    canceltext: 'Cancel', // Text for cancel-button
    autoclose: true, // automatic close timepicker
    ampmclickable: true, // make AM PM clickable
    aftershow: function(){} //Function for after opening timepicker  
  });

   $('.datepicker').pickadate({
    selectMonths: true, // Creates a dropdown to control month
    selectYears: 200, // Creates a dropdown of 15 years to control year,
    today: 'Today',
    clear: 'Clear',
    close: 'Ok',
    closeOnSelect: true,
    format: 'mm/dd/yyyy',
  });

  $('.button-collapse').sideNav({
      menuWidth: 600, // Default is 240
      edge: 'right', // Choose the horizontal origin
      closeOnClick: true// Closes side-nav on <a> clicks, useful for Angular/Meteor
    }
  );

$('.ui.dropdown')
  .dropdown()
;



  document.getElementById('ViewProfileModalTrigger').style.display = 'none';

  ExecuteOrDelayUntilScriptLoaded(retrieveListItems, "sp.js"); 
  // ExecuteOrDelayUntilScriptLoaded(Load_Dropdown_Items, "sp.js");


document.getElementById("ctl00_PlaceHolderSearchArea_SmallSearchInputBox1_csr_sboxdiv").remove();
document.getElementById("DeltaPlaceHolderPageTitleInTitleArea").remove();

// document.getElementById("TB_SearchID")
//     .addEventListener("keyup", function(event) {
//     event.preventDefault();
//     if (event.keyCode === 13) {
//       if(isEmptyOrSpaces(document.getElementById('TB_SearchID').value)){
//           // $('#Div_Container').empty();
//           ExecuteOrDelayUntilScriptLoaded(retrieveListItems, "sp.js"); 
//       }
//       else{
//           // $('#Div_Container').empty();
//           ExecuteOrDelayUntilScriptLoaded(SearchByID, "sp.js");
//       }
//     }
// });

  // $("#TB_SearchID").keypress(function (e) {
  //    //if the letter is not digit then display error and don't type anything
  //    if (e.which != 8 && e.which != 0 && (e.which < 48 || e.which > 57)) {
  //       //display error message
  //       $("#errmsg").html("Digits Only").show().fadeOut("slow");
  //              return false;
  //   }
  //  });


//   document.getElementById("TB_SearchLastName")
//     .addEventListener("keyup", function(event) {
//     event.preventDefault();
//     if (event.keyCode === 13) {
//       if(isEmptyOrSpaces(document.getElementById('TB_SearchLastName').value)){
//           // $('#Div_Container').empty();
//           ExecuteOrDelayUntilScriptLoaded(retrieveListItems, "sp.js"); 
//       }
//       else{
//           // $('#Div_Container').empty();
//           ExecuteOrDelayUntilScriptLoaded(SearchByLastName, "sp.js");
//       }
//     }
// });


// // FILTER DEPARTMENT ON CHANGE EVENT
// $(document).on('change',"#DP_Department", function() { 
//   // alert( $(this).val())
//       if($(this).val() == "Select All"){
//           // $('#Div_Container').empty();
//           ExecuteOrDelayUntilScriptLoaded(retrieveListItems, "sp.js"); 
//       }
//       else{
//           // $('#Div_Container').empty();
//           ExecuteOrDelayUntilScriptLoaded(SearchByDepartment, "sp.js");
//       }
// });

// // FILTER SECTION ON CHANGE EVENT
// $(document).on('change',"#DP_Section", function() { 
//   // alert( $(this).val())
//       if($(this).val() == "Select All"){
//           // $('#Div_Container').empty();
//           ExecuteOrDelayUntilScriptLoaded(retrieveListItems, "sp.js"); 
//       }
//       else{
//           // $('#Div_Container').empty();
//           ExecuteOrDelayUntilScriptLoaded(SearchBySection, "sp.js");
//       }
// });

// // FILTER IMMEDIATE HEAD ON CHANGE EVENT
// $(document).on('change',"#DP_ImmediateHead", function() { 
//   // alert( $(this).val())
//       if($(this).val() == "Select All"){
//           // $('#Div_Container').empty();
//           ExecuteOrDelayUntilScriptLoaded(retrieveListItems, "sp.js"); 
//       }
//       else{
//           // $('#Div_Container').empty();
//           ExecuteOrDelayUntilScriptLoaded(SearchByImmediateHead, "sp.js");
//       }
// });

// // FILTER DEPARTMENT HEAD ON CHANGE EVENT
// $(document).on('change',"#DP_DepartmentHead", function() { 
//   // alert( $(this).val())
//       if($(this).val() == "Select All"){
//           // $('#Div_Container').empty();
//           ExecuteOrDelayUntilScriptLoaded(retrieveListItems, "sp.js"); 
//       }
//       else{
//           // $('#Div_Container').empty();
//           ExecuteOrDelayUntilScriptLoaded(SearchByDepartemntHead, "sp.js");
//       }
// });


// swal({
//   type: 'success',
//   title: 'Employee Database Loaded',
//   html: $('<div>')
//     .addClass('some-class')
//     .text(''),
//   animation: false,
//   customClass: 'animated tada'
// })

  $('.dropdown-button').dropdown({
      inDuration: 300,
      outDuration: 225,
      constrainWidth: false, // Does not change width of dropdown to that of the activator
      hover: true, // Activate on hover
      gutter: 0, // Spacing from edge
      belowOrigin: false, // Displays dropdown below the button
      alignment: 'right', // Displays dropdown with edge aligned to the left of button
      stopPropagation: false // Stops event propagation
    }
  );


// LoadCharts();
// LOAD HIRED EMPLOYEES PER MONTH

  ExecuteOrDelayUntilScriptLoaded(GetHiredEmployees_Monthly, "sp.js");
  // ExecuteOrDelayUntilScriptLoaded(GetRegularizedEmployeeMonthly, "sp.js");
  ExecuteOrDelayUntilScriptLoaded(Get_Regularized_Employee_Per_Month, "sp.js");
  

  // LOAD NOTIFICATION DATA
  ExecuteOrDelayUntilScriptLoaded(GetMonthly_ForRegularization, "sp.js");
  ExecuteOrDelayUntilScriptLoaded(GetMonthly_BirtthdayCelebrants, "sp.js");

document.getElementById('Switch_Filter').checked = true;

//  HIDE SCROLL VERTICAL SCROLL BAR >>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
// document.getElementById("s4-workspace").style.overflow = 'hidden';;


// $('.switch input').change(function(){
//     if ( $('.switch input').is(':checked') ) {
//         $('#Div_Container').empty();
//         ExecuteOrDelayUntilScriptLoaded(retrieveListItems, "sp.js"); 
//     }
//     else {
//         $('#Div_Container').empty();
//         ExecuteOrDelayUntilScriptLoaded(retrieveListItems_Separated, "sp.js"); 
//     }
// });

$('#Switch_Filter').change(function(){
    // if ( $('#Switch_Filter').is(':checked') ) {
    //     $('#Div_Container').empty();

    //     ExecuteOrDelayUntilScriptLoaded(retrieveListItems, "sp.js"); 

    // }
    // else {
    //     $('#Div_Container').empty();
    //     ExecuteOrDelayUntilScriptLoaded(retrieveListItems_Separated, "sp.js"); 
    // }


      if (document.getElementById("Switch_Filter").checked == true && document.getElementById("Switch_FilterEmployeeTrainee").checked == false) {
        Filter_By_Switch = "Active-Employeee";
        LI_Separated = "Active";
        LI_EmployeeStatus = "Employee";
        // console.log(Filter_By_Switch +" -- "+ LI_Separated +" -- "+LI_EmployeeStatus);
        // $('#Div_Container').empty();
        ExecuteOrDelayUntilScriptLoaded(retrieveListItems, "sp.js");
      }
      if (document.getElementById("Switch_Filter").checked == false && document.getElementById("Switch_FilterEmployeeTrainee").checked == false) {
        Filter_By_Switch = "Separated-Employeee";
        LI_Separated = "Separated";
        LI_EmployeeStatus = "Employee";
        // console.log(Filter_By_Switch +" -- "+ LI_Separated +" -- "+LI_EmployeeStatus);
        // $('#Div_Container').empty();
        ExecuteOrDelayUntilScriptLoaded(retrieveListItems, "sp.js");
      }
      if (document.getElementById("Switch_Filter").checked == true && document.getElementById("Switch_FilterEmployeeTrainee").checked == true) {
        Filter_By_Switch = "Active-Trainee";
        LI_Separated = "Active";
        LI_EmployeeStatus = "Trainee";
        // console.log(Filter_By_Switch +" -- "+ LI_Separated +" -- "+LI_EmployeeStatus);
        // $('#Div_Container').empty();
        ExecuteOrDelayUntilScriptLoaded(retrieveListItems, "sp.js");
      }
      if (document.getElementById("Switch_Filter").checked == false && document.getElementById("Switch_FilterEmployeeTrainee").checked == true) {
        Filter_By_Switch = "Separated-Trainee";
        LI_Separated = "Separated";
        LI_EmployeeStatus = "Trainee";
        // console.log(Filter_By_Switch +" -- "+ LI_Separated +" -- "+LI_EmployeeStatus);
        // $('#Div_Container').empty();
        ExecuteOrDelayUntilScriptLoaded(retrieveListItems, "sp.js");
      }

});

$('#Switch_FilterEmployeeTrainee').change(function(){
    // if ( $('#Switch_FilterEmployeeTrainee').is(':checked') ) {
    //     $('#Div_Container').empty();
    //     ExecuteOrDelayUntilScriptLoaded(retrieveListItems_Trainee, "sp.js"); 
    // }
    // else {
    //     $('#Div_Container').empty();
    //     ExecuteOrDelayUntilScriptLoaded(retrieveListItems, "sp.js");
    // }

      if (document.getElementById("Switch_Filter").checked == true && document.getElementById("Switch_FilterEmployeeTrainee").checked == false) {
        Filter_By_Switch = "Active-Employeee";
        LI_Separated = "Active";
        LI_EmployeeStatus = "Employee";
        console.log(Filter_By_Switch +" -- "+ LI_Separated +" -- "+LI_EmployeeStatus);
        // $('#Div_Container').empty();
        ExecuteOrDelayUntilScriptLoaded(retrieveListItems, "sp.js");
      }
      if (document.getElementById("Switch_Filter").checked == false && document.getElementById("Switch_FilterEmployeeTrainee").checked == false) {
        Filter_By_Switch = "Separated-Employeee";
        LI_Separated = "Separated";
        LI_EmployeeStatus = "Employee";
        console.log(Filter_By_Switch +" -- "+ LI_Separated +" -- "+LI_EmployeeStatus);
        // $('#Div_Container').empty();
        ExecuteOrDelayUntilScriptLoaded(retrieveListItems, "sp.js");
      }
      if (document.getElementById("Switch_Filter").checked == true && document.getElementById("Switch_FilterEmployeeTrainee").checked == true) {
        Filter_By_Switch = "Active-Trainee";
        LI_Separated = "Active";
        LI_EmployeeStatus = "Trainee";
        console.log(Filter_By_Switch +" -- "+ LI_Separated +" -- "+LI_EmployeeStatus);
        // $('#Div_Container').empty();
        ExecuteOrDelayUntilScriptLoaded(retrieveListItems, "sp.js");
      }
      if (document.getElementById("Switch_Filter").checked == false && document.getElementById("Switch_FilterEmployeeTrainee").checked == true) {
        Filter_By_Switch = "Separated-Trainee";
        LI_Separated = "Separated";
        LI_EmployeeStatus = "Trainee";
        console.log(Filter_By_Switch +" -- "+ LI_Separated +" -- "+LI_EmployeeStatus);
        // $('#Div_Container').empty();
        ExecuteOrDelayUntilScriptLoaded(retrieveListItems, "sp.js");
      }
});

//--------------------> FOR REGULARIZATION <----------------------

var CurrentTime =  new Date().toLocaleTimeString('en-US', { hour12: true, 
                                             hour: "numeric", 
                                             minute: "numeric"});

// alert(CurrentTime);

// alert(ForRegularizationWithin10Days());

  // if(CurrentTime >= "9:00 AM" && CurrentTime <= "10:20 AM"){
  // ExecuteOrDelayUntilScriptLoaded(GetItemID, "sp.js");
  // ExecuteOrDelayUntilScriptLoaded(Get_Employees_Regularized_Within_10Days, "sp.js");
  // }


//--------------------> CHECK CURRENT USER <--------------------------------------------------------


// ExecuteOrDelayUntilScriptLoaded(checkuserprofile,'sp.js');

 var userid= _spPageContextInfo.userId;
  var requestUri = _spPageContextInfo.webAbsoluteUrl + "/_api/web/getuserbyid(" + userid + ")";
  var requestHeaders = { "accept" : "application/json;odata=verbose" };
  $.ajax({
    url : requestUri,
    contentType : "application/json;odata=verbose",
    headers : requestHeaders,
    success : onSuccess,
    error : onError
  });
//---------------------------------------------------------------------------------------------------


  $('#Modal_Individual_JobChart').modal({
      dismissible: false, // Modal can be dismissed by clicking outside of the modal
      opacity: .5, // Opacity of modal background
      inDuration: 300, // Transition in duration
      outDuration: 200, // Transition out duration
      startingTop: '4%', // Starting top style attribute
      endingTop: '10%', // Ending top style attribute
      ready: function(modal, trigger) { // Callback for Modal open. Modal and trigger parameters available.
       
        
      },
      complete: function() {  } // Callback for Modal close
    }
  );

  $('#ModalTrainingForm').modal({
      dismissible: false, // Modal can be dismissed by clicking outside of the modal
      opacity: .5, // Opacity of modal background
      inDuration: 300, // Transition in duration
      outDuration: 200, // Transition out duration
      startingTop: '4%', // Starting top style attribute
      endingTop: '10%', // Ending top style attribute
      ready: function(modal, trigger) { // Callback for Modal open. Modal and trigger parameters available.
       
        
      },
      complete: function() {  } // Callback for Modal close
    }
  );

  $('#ModalPositionHistoryForm').modal({
      dismissible: false, // Modal can be dismissed by clicking outside of the modal
      opacity: .5, // Opacity of modal background
      inDuration: 300, // Transition in duration
      outDuration: 200, // Transition out duration
      startingTop: '4%', // Starting top style attribute
      endingTop: '10%', // Ending top style attribute
      ready: function(modal, trigger) { // Callback for Modal open. Modal and trigger parameters available.
       
        
      },
      complete: function() {  } // Callback for Modal close
    }
  );

  $('#ModalInfraction').modal({
      dismissible: false, // Modal can be dismissed by clicking outside of the modal
      opacity: .5, // Opacity of modal background
      inDuration: 300, // Transition in duration
      outDuration: 200, // Transition out duration
      startingTop: '0%', // Starting top style attribute
      endingTop: '10%', // Ending top style attribute
      ready: function(modal, trigger) { // Callback for Modal open. Modal and trigger parameters available.
         $('select').material_select();
        
      },
      complete: function() { } // Callback for Modal close
    }
  );

  $('#Modal_Infration_Entries').modal({
      dismissible: false, // Modal can be dismissed by clicking outside of the modal
      opacity: .5, // Opacity of modal background
      inDuration: 300, // Transition in duration
      outDuration: 200, // Transition out duration
      startingTop: '0%', // Starting top style attribute
      endingTop: '10%', // Ending top style attribute
      ready: function(modal, trigger) { // Callback for Modal open. Modal and trigger parameters available.

        
      },
      complete: function() { } // Callback for Modal close
    }
  );  


// INFRACTION


  $('#TB_Infraction_EntryDate').change(function () {
      var InfractionDate = $("#TB_Infraction_EntryDate").val().split("/");
      
      var Date_Infraction = new Date(InfractionDate[2], InfractionDate[0] - 1, InfractionDate[1]);


    if (Breach == "Minor Breach" && SanctionType == "Verbal Warning"){
      Date_Infraction.setMonth(Date_Infraction.getMonth() + 6);
      var RegularizationDate = getFormattedDate(Date_Infraction);
      document.getElementById('TB_PrescriptiveDate').value = RegularizationDate;
      // alert(RegularizationDate);
    }  
    else if (Breach == "Minor Breach" && SanctionType == "Written Warning"){
      Date_Infraction.setMonth(Date_Infraction.getMonth() + 6);
      var RegularizationDate = getFormattedDate(Date_Infraction);
      document.getElementById('TB_PrescriptiveDate').value = RegularizationDate;

    }  
    else if (Breach == "Minor Breach" && SanctionType == "Final Warning"){
      Date_Infraction.setMonth(Date_Infraction.getMonth() + 6);
      var RegularizationDate = getFormattedDate(Date_Infraction);
      document.getElementById('TB_PrescriptiveDate').value = RegularizationDate;

    }  
    else if (Breach== "Minor Breach" && SanctionType == "1 Day Suspension"){
      Date_Infraction.setMonth(Date_Infraction.getMonth() + 6);
      var RegularizationDate = getFormattedDate(Date_Infraction);
      document.getElementById('TB_PrescriptiveDate').value = RegularizationDate;

    }  
    else if (Breach == "Minor Breach" && SanctionType == "3 Days Suspension"){
      Date_Infraction.setMonth(Date_Infraction.getMonth() + 6);
      var RegularizationDate = getFormattedDate(Date_Infraction);
      document.getElementById('TB_PrescriptiveDate').value = RegularizationDate;

    }  
    else if (Breach == "Minor Breach" && SanctionType == "5 Days Suspension"){
      Date_Infraction.setMonth(Date_Infraction.getMonth() + 6);
      var RegularizationDate = getFormattedDate(Date_Infraction);
      document.getElementById('TB_PrescriptiveDate').value = RegularizationDate;

    }  

//---------------->>>>>>>>>>>>>>
    else if (Breach == "Major Breach" && SanctionType == "Verbal Warning"){
      Date_Infraction.setMonth(Date_Infraction.getMonth() + 12);
      var RegularizationDate = getFormattedDate(Date_Infraction);
      document.getElementById('TB_PrescriptiveDate').value = RegularizationDate;
    } 
    else if (Breach == "Major Breach" && SanctionType == "Written Warning"){
      Date_Infraction.setMonth(Date_Infraction.getMonth() + 12);
      var RegularizationDate = getFormattedDate(Date_Infraction);
      document.getElementById('TB_PrescriptiveDate').value = RegularizationDate;
    } 
    else if (Breach == "Major Breach" && SanctionType == "Final Warning"){
      Date_Infraction.setMonth(Date_Infraction.getMonth() + 12);
      var RegularizationDate = getFormattedDate(Date_Infraction);
      document.getElementById('TB_PrescriptiveDate').value = RegularizationDate;
    } 
    else if (Breach == "Major Breach" && SanctionType == "1 Day Suspension"){
      Date_Infraction.setMonth(Date_Infraction.getMonth() + 12);
      var RegularizationDate = getFormattedDate(Date_Infraction);
      document.getElementById('TB_PrescriptiveDate').value = RegularizationDate;
    }  
    else if (Breach == "Major Breach" && SanctionType == "3 Days Suspension"){
      Date_Infraction.setMonth(Date_Infraction.getMonth() + 12);
      var RegularizationDate = getFormattedDate(Date_Infraction);
      document.getElementById('TB_PrescriptiveDate').value = RegularizationDate;
    }  
    else if (Breach == "Major Breach" && SanctionType == "5 Days Suspension"){
      Date_Infraction.setMonth(Date_Infraction.getMonth() + 12);
      var RegularizationDate = getFormattedDate(Date_Infraction);
      document.getElementById('TB_PrescriptiveDate').value = RegularizationDate;
    }  
//---------------->>>>>>>>>>>>>>------------>>>>>>>>>>>>>>>
    else if (Breach == "Serious Breach" && SanctionType == "1 Day Suspension"){
      Date_Infraction.setMonth(Date_Infraction.getMonth() + 24);
      var RegularizationDate = getFormattedDate(Date_Infraction);
      document.getElementById('TB_PrescriptiveDate').value = RegularizationDate;
    }  
    else if (Breach == "Serious Breach" && SanctionType == "3 Days Suspension"){
      Date_Infraction.setMonth(Date_Infraction.getMonth() + 24);
      var RegularizationDate = getFormattedDate(Date_Infraction);
      document.getElementById('TB_PrescriptiveDate').value = RegularizationDate;
    }  
    else if (Breach == "Serious Breach" && SanctionType == "5 Days Suspension"){
      Date_Infraction.setMonth(Date_Infraction.getMonth() + 24);
      var RegularizationDate = getFormattedDate(Date_Infraction);
      document.getElementById('TB_PrescriptiveDate').value = RegularizationDate;
    }  
    else if (Breach == "Serious Breach" && SanctionType == "Written Warning"){
      Date_Infraction.setMonth(Date_Infraction.getMonth() + 12);
      var RegularizationDate = getFormattedDate(Date_Infraction);
      document.getElementById('TB_PrescriptiveDate').value = RegularizationDate;
    }  
    else if (Breach == "Serious Breach" && SanctionType == "Final Warning"){
      Date_Infraction.setMonth(Date_Infraction.getMonth() + 12);
      var RegularizationDate = getFormattedDate(Date_Infraction);
      document.getElementById('TB_PrescriptiveDate').value = RegularizationDate;
    }  
    else if (Breach == "Serious Breach" && SanctionType == "Verbal Warning"){
      Date_Infraction.setMonth(Date_Infraction.getMonth() + 12);
      var RegularizationDate = getFormattedDate(Date_Infraction);
      document.getElementById('TB_PrescriptiveDate').value = RegularizationDate;
    }  

  });




$(document).on('change',"#DP_Infraction_TypeOfSanction", function() { 
  SanctionType = $(this).val();
  // alert(SanctionType);

    if(SanctionType == "Verbal Warning"){
      if(Breach == "Minor Breach"){
        document.getElementById("TB_Infraction_Points").value = "10";
      }
      else if(Breach == "Major Breach"){
        document.getElementById("TB_Infraction_Points").value = "20";
      }
      else if(Breach == "Serious Breach"){
        document.getElementById("TB_Infraction_Points").value = "30";
      }
      else if(Breach == "Extreme Breach"){
        document.getElementById("TB_Infraction_Points").value = "40";
      }
    }
    else if(SanctionType == "Written Warning"){
      if(Breach == "Minor Breach"){
        document.getElementById("TB_Infraction_Points").value = "20";
      }
      else if(Breach == "Major Breach"){
        document.getElementById("TB_Infraction_Points").value = "40";
      }
      else if(Breach == "Serious Breach"){
        document.getElementById("TB_Infraction_Points").value = "60";
      }
      else if(Breach == "Extreme Breach"){
        document.getElementById("TB_Infraction_Points").value = "80";
      }
    }    
    else if(SanctionType == "Final Warning"){
      if(Breach == "Minor Breach"){
        document.getElementById("TB_Infraction_Points").value = "30";
      }
      else if(Breach == "Major Breach"){
        document.getElementById("TB_Infraction_Points").value = "60";
      }
      else if(Breach == "Serious Breach"){
        document.getElementById("TB_Infraction_Points").value = "90";
      }
      else if(Breach == "Extreme Breach"){
        document.getElementById("TB_Infraction_Points").value = "120";
      }
    }  
    else if(SanctionType == "1 Day Suspension"){
      if(Breach == "Minor Breach"){
        document.getElementById("TB_Infraction_Points").value = "40";
      }
      else if(Breach == "Major Breach"){
        document.getElementById("TB_Infraction_Points").value = "80";
      }
      else if(Breach == "Serious Breach"){
        document.getElementById("TB_Infraction_Points").value = "120";
      }
      else if(Breach == "Extreme Breach"){
        document.getElementById("TB_Infraction_Points").value = "160";
      }
    }       
    else if(SanctionType == "3 Days Suspension"){
      if(Breach == "Minor Breach"){
        document.getElementById("TB_Infraction_Points").value = "50";
      }
      else if(Breach == "Major Breach"){
        document.getElementById("TB_Infraction_Points").value = "100";
      }
      else if(Breach == "Serious Breach"){
        document.getElementById("TB_Infraction_Points").value = "150";
      }
      else if(Breach == "Extreme Breach"){
        document.getElementById("TB_Infraction_Points").value = "200";
      }
    } 
    else if(SanctionType == "5 Days Suspension"){
      if(Breach == "Minor Breach"){
        document.getElementById("TB_Infraction_Points").value = "60";
      }
      else if(Breach == "Major Breach"){
        document.getElementById("TB_Infraction_Points").value = "120";
      }
      else if(Breach == "Serious Breach"){
        document.getElementById("TB_Infraction_Points").value = "180";
      }
      else if(Breach == "Extreme Breach"){
        document.getElementById("TB_Infraction_Points").value = "240";
      }
    }   

//----------------<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<

      if(SanctionType != "" && Breach == ""){
        document.getElementById("TB_Infraction_EntryDate").disabled = true;
        document.getElementById("TB_Infraction_EntryDate").value = "";
        document.getElementById("TB_PrescriptiveDate").value = "";
      }
      if(SanctionType == "" && Breach != ""){
        document.getElementById("TB_Infraction_EntryDate").disabled = true;
        document.getElementById("TB_Infraction_EntryDate").value = "";
        document.getElementById("TB_PrescriptiveDate").value = "";
      }
      if(SanctionType != "" && Breach != ""){
        document.getElementById("TB_Infraction_EntryDate").disabled = false;
        document.getElementById("TB_Infraction_EntryDate").value = "";
        document.getElementById("TB_PrescriptiveDate").value = "";
      }


});
$(document).on('change',"#DP_Infraction_Breach", function() { 
  Breach = $(this).val();
  // alert(Breach);

  if(Breach == "Minor Breach"){
    if(SanctionType == "Verbal Warning"){
      document.getElementById("TB_Infraction_Points").value = "10";
    }
    else if(SanctionType == "Written Warning"){
      document.getElementById("TB_Infraction_Points").value = "20";
    }    
    else if(SanctionType == "Final Warning"){
      document.getElementById("TB_Infraction_Points").value = "30";
    }  
    else if(SanctionType == "1 Day Suspension"){
      document.getElementById("TB_Infraction_Points").value = "40";
    }       
    else if(SanctionType == "3 Days Suspension"){
      document.getElementById("TB_Infraction_Points").value = "50";
    } 
    else if(SanctionType == "5 Days Suspension"){
      document.getElementById("TB_Infraction_Points").value = "60";
    }          
  }
  else if(Breach == "Major Breach"){
    if(SanctionType == "Verbal Warning"){
      document.getElementById("TB_Infraction_Points").value = "20";
    }
    else if(SanctionType == "Written Warning"){
      document.getElementById("TB_Infraction_Points").value = "40";
    }    
    else if(SanctionType == "Final Warning"){
      document.getElementById("TB_Infraction_Points").value = "60";
    }  
    else if(SanctionType == "1 Day Suspension"){
      document.getElementById("TB_Infraction_Points").value = "80";
    }       
    else if(SanctionType == "3 Days Suspension"){
      document.getElementById("TB_Infraction_Points").value = "100";
    } 
    else if(SanctionType == "5 Days Suspension"){
      document.getElementById("TB_Infraction_Points").value = "120";
    }          
  }
  else if(Breach == "Serious Breach"){
    if(SanctionType == "Verbal Warning"){
      document.getElementById("TB_Infraction_Points").value = "30";
    }
    else if(SanctionType == "Written Warning"){
      document.getElementById("TB_Infraction_Points").value = "60";
    }    
    else if(SanctionType == "Final Warning"){
      document.getElementById("TB_Infraction_Points").value = "90";
    }  
    else if(SanctionType == "1 Day Suspension"){
      document.getElementById("TB_Infraction_Points").value = "120";
    }       
    else if(SanctionType == "3 Days Suspension"){
      document.getElementById("TB_Infraction_Points").value = "150";
    } 
    else if(SanctionType == "5 Days Suspension"){
      document.getElementById("TB_Infraction_Points").value = "180";
    }          
  }
  else if(Breach == "Extreme Breach"){
    if(SanctionType == "Verbal Warning"){
      document.getElementById("TB_Infraction_Points").value = "40";
    }
    else if(SanctionType == "Written Warning"){
      document.getElementById("TB_Infraction_Points").value = "80";
    }    
    else if(SanctionType == "Final Warning"){
      document.getElementById("TB_Infraction_Points").value = "120";
    }  
    else if(SanctionType == "1 Day Suspension"){
      document.getElementById("TB_Infraction_Points").value = "160";
    }       
    else if(SanctionType == "3 Days Suspension"){
      document.getElementById("TB_Infraction_Points").value = "200";
    } 
    else if(SanctionType == "5 Days Suspension"){
      document.getElementById("TB_Infraction_Points").value = "240";
    }          
  }  

//----------------<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
    if(SanctionType != "" && Breach == ""){
      document.getElementById("TB_Infraction_EntryDate").disabled = true;
      document.getElementById("TB_Infraction_EntryDate").value = "";
      document.getElementById("TB_PrescriptiveDate").value = "";
    }
    if(SanctionType == "" && Breach != ""){
      document.getElementById("TB_Infraction_EntryDate").disabled = true;f
      document.getElementById("TB_Infraction_EntryDate").value = "";
      document.getElementById("TB_PrescriptiveDate").value = "";
    }
    if(SanctionType != "" && Breach != ""){
      document.getElementById("TB_Infraction_EntryDate").disabled = false;
      document.getElementById("TB_Infraction_EntryDate").value = "";
      document.getElementById("TB_PrescriptiveDate").value = "";
    }

});

  ExecuteOrDelayUntilScriptLoaded(Get_Infraction_Entries, "sp.js");


  var months = [ "January", "February", "March", "April", "May", "June",
    "July", "August", "September", "October", "November", "December" ];
  var current_date = new Date();
  var current_month = months[current_date.getMonth()];
  document.getElementById("Month_Tenure").innerText = current_month;


  ExecuteOrDelayUntilScriptLoaded(Get_Employee_Tenure_3Months, "sp.js");
  ExecuteOrDelayUntilScriptLoaded(Get_Employee_Tenure_6Months, "sp.js");
  ExecuteOrDelayUntilScriptLoaded(Get_Employee_Tenure_Anniversary, "sp.js");

// $('.ui.dropdown')
//   .dropdown()
// ;

  ExecuteOrDelayUntilScriptLoaded(Get_Departments,'sp.js');
  ExecuteOrDelayUntilScriptLoaded(Get_Sections,'sp.js');
  

  document.addEventListener('readystatechange', function() {
    if (document.readyState === 'complete') {
      TableFilter_EmployeesTable.init();
    }
  });




// swal({
//   type: 'success',
//   title: 'Employee profile has been Loaded',
//   showConfirmButton: false,
//   timer: 2000
// });

$('#Div_Department').change(function() {
Selected_Department_Name = $('#Input_E_Department').val();
ExecuteOrDelayUntilScriptLoaded(SearchByDepartment,'sp.js');
});

$('#Div_Section').change(function() {
Selected_Section_Name = $('#Input_E_Section').val();
ExecuteOrDelayUntilScriptLoaded(SearchBySection,'sp.js');
});

$('.ui.modal.large.VIEW_PROFILE')
  .modal()
;


$('#SEARCH_EMPLOYEE').keypress(function(event) {
    if (event.keyCode == 13) {
        event.preventDefault();
    }
});

}); //---------END OF DOCUMENT READY FUNCTION----------------------------------------------------------

var SanctionType;
var Breach;

var Filter_By_Switch = "Active-Employee";

var LI_Separated = "Active";
var LI_EmployeeStatus = "Employee";

//---------------------> GET CURRENT USER <---------------------------------------------------------

  function onSuccess(data, request){
    var loginName = data.d.Title;
    // alert(loginName);
    if(loginName != "Fernando Durano Singson Jr." && loginName != "Victor Surita" && loginName != "Idrian Belleza" && loginName != "Victor Surita" && loginName != "Carl James Ambowang" && loginName != "Lito Abon Jr." && loginName != "Dianna Rose Gabayan" && loginName != "Nino Rey Cresencio" && loginName != "Jeanne Mamalo"){
        document.getElementById("ShowExcel").remove();
    }

  }

  function onError(error) {
    alert("error");
  }

//-----------------------------------------------------------------------------------------------------------------------

// IF EMPTY OR WHITE SPACE ----------------------------------------------------------------------------------------------
function isEmptyOrSpaces(str){
    return str === null || str.match(/^ *$/) !== null;
}


//-----------------------------------------------------------------------------------------------------------
// function retrieveListItems() {
//     var clientContext = new SP.ClientContext('https://intranet.houseofit.com.au/');
//     var oList_Department = clientContext.get_web().get_lists().getByTitle('Employee Profile');
//     var camlQuery = new SP.CamlQuery();
//     camlQuery.set_viewXml('<View>'+
//      '<Query>'+
//      '<Where>'+
//      '<And>'+
//        '<Eq>'+
//        '<FieldRef Name=\'LI_Separated\'/>' + 
//        '<Value Type=\'Text\'>'+"Active"+'</Value>'+
//        '</Eq>'+      
//      '<Geq>'+
//      '<FieldRef Name=\'ID\'/>' + 
//         '<Value Type=\'Number\'>1</Value>'+
//         '</Geq>'+
//         '</And>'+
//         '</Where>'+
//         '</Query>'+
//         '<RowLimit>'+
//         '</RowLimit>'+
//         '</View>');
//     this.collListItem = oList_Department.getItems(camlQuery);
//     clientContext.load(collListItem);
//     clientContext.executeQueryAsync(Function.createDelegate(this, this.onQuerySucceeded), Function.createDelegate(this, this.onQueryFailed));     
// }
function retrieveListItems() {

swal({
  type: 'success',
  title: 'Employee profile has been Loaded',
  showConfirmButton: false,
  timer: 1500
});

    var clientContext = new SP.ClientContext('https://intranet.houseofit.com.au/');
    var oList_Department = clientContext.get_web().get_lists().getByTitle('Employee Profile');
    var camlQuery = new SP.CamlQuery();
    camlQuery.set_viewXml('<View>'+
      '<Query>'+
      '<Where>'+
      '<And>'+
        '<Eq>'+
        '<FieldRef Name=\'LI_Separated\'/>' + 
        '<Value Type=\'Text\'>'+LI_Separated+'</Value>'+
        '</Eq>'+      
        '<Eq>'+
        '<FieldRef Name=\'LI_EmployeeStatus\'/>' + 
        '<Value Type=\'Text\'>'+LI_EmployeeStatus+'</Value>'+
        '</Eq>'+ 
        '</And>'+
        '</Where>'+
        '<OrderBy>'+
        '<FieldRef Name=\'LI_FirstName\' Ascending=\'true\' />'+
        '</OrderBy>'+
        '</Query>'+
        '<RowLimit>'+
        '</RowLimit>'+
        '</View>');
    this.collListItem = oList_Department.getItems(camlQuery);
    clientContext.load(collListItem);
    clientContext.executeQueryAsync(Function.createDelegate(this, this.onQuerySucceeded), Function.createDelegate(this, this.onQueryFailed));     
}

function retrieveListItems_Separated() {
    var clientContext = new SP.ClientContext('https://intranet.houseofit.com.au/');
    var oList_Department = clientContext.get_web().get_lists().getByTitle('Employee Profile');
    var camlQuery = new SP.CamlQuery();
    camlQuery.set_viewXml('<View>'+
      '<Query>'+
      '<Where>'+
      '<And>'+
        '<Eq>'+
        '<FieldRef Name=\'LI_Separated\'/>' +
        '<Value Type=\'Text\'>'+"Separated"+'</Value>'+
        '</Eq>'+      
      '<Geq>'+
      '<FieldRef Name=\'ID\'/>' + 
        '<Value Type=\'Number\'>1</Value>'+
        '</Geq>'+
        '</And>'+
        '</Where>'+
        '<OrderBy>'+
        '<FieldRef Name=\'LI_LastName\' Ascending=\'true\' />'+
        '</OrderBy>'+        
        '</Query>'+
        '<RowLimit>'+
        '</RowLimit>'+
        '</View>');
    this.collListItem = oList_Department.getItems(camlQuery);
    clientContext.load(collListItem);
    clientContext.executeQueryAsync(Function.createDelegate(this, this.onQuerySucceeded), Function.createDelegate(this, this.onQueryFailed));     
}

function retrieveListItems_Trainee() {
    var clientContext = new SP.ClientContext('https://intranet.houseofit.com.au/');
    var oList_Department = clientContext.get_web().get_lists().getByTitle('Employee Profile');
    var camlQuery = new SP.CamlQuery();
    camlQuery.set_viewXml('<View>'+
      '<Query>'+
      '<Where>'+
      '<And>'+
        '<Eq>'+
        '<FieldRef Name=\'LI_Separated\'/>' + 
        '<Value Type=\'Text\'>'+"Active"+'</Value>'+
        '</Eq>'+      
        '<Eq>'+
        '<FieldRef Name=\'LI_EmployeeStatus\'/>' + 
        '<Value Type=\'Text\'>'+"Trainee"+'</Value>'+
        '</Eq>'+ 
        '</And>'+
        '</Where>'+
        '<OrderBy>'+
        '<FieldRef Name=\'LI_LastName\' Ascending=\'true\' />'+
        '</OrderBy>'+
        '</Query>'+
        '<RowLimit>'+
        '</RowLimit>'+
        '</View>');
    this.collListItem = oList_Department.getItems(camlQuery);
    clientContext.load(collListItem);
    clientContext.executeQueryAsync(Function.createDelegate(this, this.onQuerySucceeded), Function.createDelegate(this, this.onQueryFailed));     
}

function SearchByID(){
    var clientContext = new SP.ClientContext('https://intranet.houseofit.com.au/');
    var oList_Department = clientContext.get_web().get_lists().getByTitle('Employee Profile');
    var camlQuery = new SP.CamlQuery();
    camlQuery.set_viewXml(
      '<View>'+
      '<Query>'+
      '<Where>'+
      '<Eq>'+
      '<FieldRef Name=\'LI_EmployeeID\'/>' + 
      '<Value Type=\'Text\'>'+document.getElementById('TB_SearchID').value+'</Value>'+
      '</Eq>'+
      '</Where>'+
      '</Query>'+
      '<RowLimit>'+
      '</RowLimit>'+
      '</View>');
    this.collListItem = oList_Department.getItems(camlQuery);
    clientContext.load(collListItem);
    clientContext.executeQueryAsync(Function.createDelegate(this, this.onQuerySucceeded), Function.createDelegate(this, this.onQueryFailed));  
}

function SearchByDepartment(){
    var clientContext = new SP.ClientContext('https://intranet.houseofit.com.au/');
    var oList_Department = clientContext.get_web().get_lists().getByTitle('Employee Profile');
    var camlQuery = new SP.CamlQuery();
    camlQuery.set_viewXml(
      '<View>'+
      '<Query>'+
      '<Where>'+
      '<And>'+
      '<Eq>'+
        '<FieldRef Name=\'LI_Separated\'/>' + 
        '<Value Type=\'Text\'>'+"Active"+'</Value>'+
        '</Eq>'+  
      '<Eq>'+
      '<FieldRef Name=\'LI_Department\'/>' + 
      '<Value Type=\'Text\'>'+Selected_Department_Name+'</Value>'+
      '</Eq>'+
      '</And>'+
      '</Where>'+
      '</Query>'+
      '<RowLimit>'+
      '</RowLimit>'+
      '</View>');
    this.collListItem = oList_Department.getItems(camlQuery);
    clientContext.load(collListItem);
    clientContext.executeQueryAsync(Function.createDelegate(this, this.onQuerySucceeded), Function.createDelegate(this, this.onQueryFailed));  
}

function SearchBySection(){
    var clientContext = new SP.ClientContext('https://intranet.houseofit.com.au/');
    var oList_Department = clientContext.get_web().get_lists().getByTitle('Employee Profile');
    var camlQuery = new SP.CamlQuery();
    camlQuery.set_viewXml(
      '<View>'+
      '<Query>'+
      '<Where>'+
      '<And>'+
      '<Eq>'+
        '<FieldRef Name=\'LI_Separated\'/>' + 
        '<Value Type=\'Text\'>'+"Active"+'</Value>'+
        '</Eq>'+      
      '<Eq>'+
      '<FieldRef Name=\'LI_Section\'/>' + 
      '<Value Type=\'Text\'>'+Selected_Section_Name+'</Value>'+
      '</Eq>'+
      '</And>'+
      '</Where>'+
      '</Query>'+
      '<RowLimit>'+
      '</RowLimit>'+
      '</View>');
    this.collListItem = oList_Department.getItems(camlQuery);
    clientContext.load(collListItem);
    clientContext.executeQueryAsync(Function.createDelegate(this, this.onQuerySucceeded), Function.createDelegate(this, this.onQueryFailed));  
}

function SearchByImmediateHead(){
    var clientContext = new SP.ClientContext('https://intranet.houseofit.com.au/');
    var oList_Department = clientContext.get_web().get_lists().getByTitle('Employee Profile');
    var camlQuery = new SP.CamlQuery();
    camlQuery.set_viewXml(
      '<View>'+
      '<Query>'+
      '<Where>'+
      '<And>'+
      '<Eq>'+
        '<FieldRef Name=\'LI_Separated\'/>' + 
        '<Value Type=\'Text\'>'+"Active"+'</Value>'+
        '</Eq>'+
      '<Eq>'+
      '<FieldRef Name=\'LI_ImmediateHead\'/>' + 
      '<Value Type=\'Text\'>'+document.getElementById("DP_ImmediateHead").options[ document.getElementById("DP_ImmediateHead").selectedIndex ].value+'</Value>'+
      '</Eq>'+
      '</And>'+
      '</Where>'+
      '</Query>'+
      '<RowLimit>'+
      '</RowLimit>'+
      '</View>');
    this.collListItem = oList_Department.getItems(camlQuery);
    clientContext.load(collListItem);
    clientContext.executeQueryAsync(Function.createDelegate(this, this.onQuerySucceeded), Function.createDelegate(this, this.onQueryFailed));  
}

function SearchByDepartemntHead(){
    var clientContext = new SP.ClientContext('https://intranet.houseofit.com.au/');
    var oList_Department = clientContext.get_web().get_lists().getByTitle('Employee Profile');
    var camlQuery = new SP.CamlQuery();
    camlQuery.set_viewXml(
      '<View>'+
      '<Query>'+
      '<Where>'+
      '<And>'+
      '<Eq>'+
        '<FieldRef Name=\'LI_Separated\'/>' + 
        '<Value Type=\'Text\'>'+"Active"+'</Value>'+
        '</Eq>'+      
      '<Eq>'+
      '<FieldRef Name=\'LI_DepartmentHead\'/>' + 
      '<Value Type=\'Text\'>'+document.getElementById("DP_DepartmentHead").options[ document.getElementById("DP_DepartmentHead").selectedIndex ].value+'</Value>'+
      '</Eq>'+
      '</And>'+
      '</Where>'+
      '</Query>'+
      '<RowLimit>'+
      '</RowLimit>'+
      '</View>');
    this.collListItem = oList_Department.getItems(camlQuery);
    clientContext.load(collListItem);
    clientContext.executeQueryAsync(Function.createDelegate(this, this.onQuerySucceeded), Function.createDelegate(this, this.onQueryFailed));  
}

// function SearchByFirstName(){
//     var clientContext = new SP.ClientContext('https://intranet.houseofit.com.au/');
//     var oList_Department = clientContext.get_web().get_lists().getByTitle('Employee Profile');
//     var camlQuery = new SP.CamlQuery();
//     camlQuery.set_viewXml(
//       '<View>'+
//       '<Query>'+
//       '<Where>'+
//       '<Eq>'+
//       '<FieldRef Name=\'LI_FirstName\'/>' + 
//       '<Value Type=\'Text\'>'+document.getElementById('TB_SearchFirstName').value+'</Value>'+
//       '</Eq>'+
//       '</Where>'+
//       '</Query>'+
//       '<RowLimit>'+
//       '</RowLimit>'+
//       '</View>');
//     this.collListItem = oList_Department.getItems(camlQuery);
//     clientContext.load(collListItem);
//     clientContext.executeQueryAsync(Function.createDelegate(this, this.onQuerySucceeded), Function.createDelegate(this, this.onQueryFailed));  
// }

function SearchByLastName(){
    var clientContext = new SP.ClientContext('https://intranet.houseofit.com.au/');
    var oList_Department = clientContext.get_web().get_lists().getByTitle('Employee Profile');
    var camlQuery = new SP.CamlQuery();
    camlQuery.set_viewXml(
      '<View>'+
      '<Query>'+
      '<Where>'+
      '<Eq>'+
      '<FieldRef Name=\'LI_LastName\'/>' + 
      '<Value Type=\'Text\'>'+document.getElementById('TB_SearchLastName').value+'</Value>'+
      '</Eq>'+
      '</Where>'+
      '</Query>'+
      '<RowLimit>'+
      '</RowLimit>'+
      '</View>');
    this.collListItem = oList_Department.getItems(camlQuery);
    clientContext.load(collListItem);
    clientContext.executeQueryAsync(Function.createDelegate(this, this.onQuerySucceeded), Function.createDelegate(this, this.onQueryFailed));  
}

// SHOW SEPARATED 



function onQuerySucceeded(sender, args) {

   // var imgLink = "https://intranet.houseofit.com.au/SiteAssets/Test Images/male_user_icon.jpg";

                               // $("#Div_Container").append(
                               //  "<div class='col s12'>" +


                               //    "<div class='row hoverable card-panel z-depth-1'>" +
       

                               //    "<div class='col s1 ' ><H6 style='font-weight: bold;'>EMPLOYEE ID</H6></div>"+

                               //      "<div class='col s2' ><H6 style='font-weight: bold;'>NAME</H6></div>"+

                               //      "<div class='col s1 ' ><H6 style='font-weight: bold;'>DEPARTMENT</H6></div>"+

                               //      "<div class='col s2 ' ><H6 style='font-weight: bold;'>SECTION</H6></div>"+

                               //      "<div class='col s3'></div>"+

                               //    "<div class='col s1 '>" +
                               //    "<div class='col'></div>"+

                               //    "</div>"+

                               //    "<div class='col s1 '>" +
                               //    "<div class='col'></div>"+

                               //    "</div>"+

                               //    "<div class='col s1 '>"+
                               //    "<div class='col'></div>"+

                               //    "</div>"+

                               //      "</div>"+

                               // "</div>"


                               // );


    var listItemEnumerator = collListItem.getEnumerator();    

    var count = 0;

    //   for(var i=document.getElementById("table_employees").rows.length;i>1;i--) {
    // document.getElementById("table_employees").deleteRow(i-1);}
  $("#table_employees tbody").empty();


    while (listItemEnumerator.moveNext()) {
        var oListItem = listItemEnumerator.get_current();
        count++;
    var var_ItemID = oListItem.get_item('ID');
       var var_EmployeeID = oListItem.get_item('LI_EmployeeID');
       var var_FirstName = oListItem.get_item('LI_FirstName');
       var var_MiddleName = oListItem.get_item('LI_MiddleName');
       var var_LastName = oListItem.get_item('LI_LastName');
       var var_Suffix = oListItem.get_item('LI_Suffix');
       var var_Department = oListItem.get_item('LI_Department');
       var var_Section = oListItem.get_item('LI_Section');
       var var_Sex = oListItem.get_item('LI_Sex');
       var var_PositionTitle = oListItem.get_item('LI_PositionTitle');


       if(var_Suffix == null){
        var_Suffix = "";

       }
       if(var_Section == null){
        var_Section = "";
       }

       if(var_MiddleName == null){
        var_MiddleName = "";
       }


//-----------------------------------------------------------------------------------------------------------------------------------

                              $("#table_employees tbody").append("<tr >" +
                               "<td style='text-align:center !important'>"+var_EmployeeID+"</td>" +
                               "<td style='font-weight: bold;'>"+var_FirstName+" "+var_MiddleName+" "+var_LastName+" "+var_Suffix+"</td>" +
                               "<td style='text-align:center !important'>"+var_Department+"</td>"  +
                               "<td style='text-align:center !important'>"+var_Section+"</td>"  +
                               "<td style='text-align:center !important'>"+var_PositionTitle+"</td>"  +


                                     "<td class='CenterTextInSpan'>"+
                                      '<div class="ui circular icon dropdown basic button blue pointing top right">'+
                                        '<i class="icon cogs "></i>'+
                                        '<div class="menu">'+
                                          '<a class="item"  id="'+var_ItemID+'" Value="'+var_ItemID+'" onclick="InfractionButtonClicked(this)"><i class="file alternate outline icon"></i>Infraction</a>'+
                                          // '<a class="item"  id="JobChart-'+var_ItemID+'" Value="'+var_ItemID+'" onclick="JobChartButtonClicked(this)"><i class="chart bar icon"></i>Job Chart</a>'+
                                          '<a class="item"  id="View-'+var_ItemID+'" Value="'+var_ItemID+'" onclick="ViewButtonClicked(this)"><i class="id card icon"></i>View Profile</a>'+
                                          '<a class="item"  id="'+var_ItemID+'" Value="'+var_ItemID+'" onclick="EditButtonClicked(this)"><i class="edit icon"></i>Edit</a>'+
                                        '</div>'+
                                     "</td>"+

                               "</tr>"

                               );


    }

                $('.ui.circular.icon.dropdown.basic.button.blue.pointing.top.right')
                  .dropdown({
                    action: 'hide'
                  })
                ;

    // console.log(count);

}

function Open_Row_Action() {
  $('#Row_Action').dropdown('open');
}
function Close_Row_Action() {
  $('#Row_Action').dropdown('open');
}

function EditButtonClicked(objButton){
  // alert(objButton.id);
  // var a = document.getElementById(objButton.id); 
  // a.href = "https://intranet.houseofit.com.au/Lists/Employee%20Profile/EditForm.aspx?ID="+objButton.id;

   window.open("https://intranet.houseofit.com.au/Lists/Employee%20Profile/EditForm.aspx?ID="+objButton.id,"_self")

}


var Department_List_Items;
var Section_List_Items;
var PositionTitle_Items;
var ImmediateHead_Items;
var DepartmentHead_Items;

function Load_Dropdown_Items() {
  context = SP.ClientContext.get_current();

  // Department
  var Departments = context.get_web().get_lists().getByTitle("Department");
  var camlQuery_Department = SP.CamlQuery.createAllItemsQuery();
  this.Department_List_Items = Departments.getItems(camlQuery_Department);

  context.load(Department_List_Items);
  context.executeQueryAsync(Read_Department_Succeeded, ReadListItemFailed);

  // Section
  context2 = SP.ClientContext.get_current();
  var Sections = context.get_web().get_lists().getByTitle("Section");
  var camlQuery_Section = SP.CamlQuery.createAllItemsQuery();
  this.Section_List_Items = Sections.getItems(camlQuery_Section);

  context2.load(Section_List_Items);
  context2.executeQueryAsync(Read_Section_Succeeded, ReadListItemFailed);

  // Position Title
  context3 = SP.ClientContext.get_current();
  var PositionTitle = context.get_web().get_lists().getByTitle("Position");
  var camlQuery_PositionTitle = SP.CamlQuery.createAllItemsQuery();
  this.PositionTitle_Items = PositionTitle.getItems(camlQuery_PositionTitle);

  context3.load(PositionTitle_Items);
  context3.executeQueryAsync(Read_PositionTitle_Succeeded, ReadListItemFailed);

  // Immediate Head
  context4 = SP.ClientContext.get_current();
  var ImmediateHead = context.get_web().get_lists().getByTitle("Immediate Head List");
  var camlQuery_ImmediateHead = SP.CamlQuery.createAllItemsQuery();
  this.ImmediateHead_Items = ImmediateHead.getItems(camlQuery_ImmediateHead);

  context4.load(ImmediateHead_Items);
  context4.executeQueryAsync(Read_ImmediateHead_Succeeded, ReadListItemFailed);

  // Department Head
  context5 = SP.ClientContext.get_current();
  var DepartmentHead = context.get_web().get_lists().getByTitle("Department Head List");
  var camlQuery_DepartmentHead = SP.CamlQuery.createAllItemsQuery();
  this.DepartmentHead_Items = DepartmentHead.getItems(camlQuery_DepartmentHead);

  context5.load(DepartmentHead_Items);
  context5.executeQueryAsync(Read_DepartmentHead_Succeeded, ReadListItemFailed);
}

// GET DEPARTMENTS
function Read_Department_Succeeded(sender, args) {
    var listItemsCollection = Department_List_Items.getEnumerator();
    var Array_Department = [];

    while (listItemsCollection.moveNext()) {
      var listItem = listItemsCollection.get_current();
        Array_Department.push(listItem.get_item('Title'));
    }

    for (var i = 0; i<=Array_Department.length-1; i++){
        var opt = document.createElement('option');
        opt.innerHTML = Array_Department[i];
        opt.value = Array_Department[i];
      document.getElementById('DP_Department').appendChild(opt);
    }

    for (var i = 0; i<=Array_Department.length-1; i++){
        var opt = document.createElement('option');
        opt.innerHTML = Array_Department[i];
        opt.value = Array_Department[i];
      document.getElementById('DP_Department_PosHistory').appendChild(opt);
    }

    for (var i = 0; i<=Array_Department.length-1; i++){
        var opt = document.createElement('option');
        opt.innerHTML = Array_Department[i];
        opt.value = Array_Department[i];
      document.getElementById('DP_Infraction_Filter_Dept').appendChild(opt);
    }

    $('select').material_select();
}

// GET SECTIONS
function Read_Section_Succeeded(sender, args) {
  var listItemsCollection = Section_List_Items.getEnumerator();
  var Array_Section = [];

    while (listItemsCollection.moveNext()) {
      var listItem = listItemsCollection.get_current();
        Array_Section.push(listItem.get_item('Title'));
    }

    for (var i = 0; i<=Array_Section.length-1; i++){
        var opt = document.createElement('option');
        opt.innerHTML = Array_Section[i];
        opt.value = Array_Section[i];
      document.getElementById('DP_Section').appendChild(opt);
    }

  $('select').material_select();
}

// GET POSITION TITLE
function Read_PositionTitle_Succeeded(sender, args) {
  var listItemsCollection = PositionTitle_Items.getEnumerator();
  var Array_PositionTitle = [];

    while (listItemsCollection.moveNext()) {
      var listItem = listItemsCollection.get_current();
        Array_PositionTitle.push(listItem.get_item('Title'));
    }

    for (var i = 0; i<=Array_PositionTitle.length-1; i++){
        var opt = document.createElement('option');
        opt.innerHTML = Array_PositionTitle[i];
        opt.value = Array_PositionTitle[i];
      // document.getElementById('DP_PositionTitle').appendChild(opt);
      document.getElementById('DP_Position_PosHistory').appendChild(opt);
      
    }

  $('select').material_select();
}

// GET IMMEDIATE HEAD
function Read_ImmediateHead_Succeeded(sender, args) {
  var listItemsCollection = ImmediateHead_Items.getEnumerator();
  var Array_ImmediateHead = [];

    while (listItemsCollection.moveNext()) {
      var listItem = listItemsCollection.get_current();
        Array_ImmediateHead.push(listItem.get_item('Title'));
    }

    for (var i = 0; i<=Array_ImmediateHead.length-1; i++){
        var opt = document.createElement('option');
        opt.innerHTML = Array_ImmediateHead[i];
        opt.value = Array_ImmediateHead[i];
      document.getElementById('DP_ImmediateHead').appendChild(opt);
    }

  $('select').material_select();
}

// GET DEPARTMENT HEAD
function Read_DepartmentHead_Succeeded(sender, args) {
  var listItemsCollection = DepartmentHead_Items.getEnumerator();
  var Array_DepartmentteHead = [];

    while (listItemsCollection.moveNext()) {
      var listItem = listItemsCollection.get_current();
        Array_DepartmentteHead.push(listItem.get_item('Title'));
    }

    for (var i = 0; i<=Array_DepartmentteHead.length-1; i++){
        var opt = document.createElement('option');
        opt.innerHTML = Array_DepartmentteHead[i];
        opt.value = Array_DepartmentteHead[i];
      document.getElementById('DP_DepartmentHead').appendChild(opt);
    }

  $('select').material_select();
}

// IF QUERY FAILED
function ReadListItemFailed(sender, args) {
  alert('Request failed. ' + args.get_message() + '\n' + args.get_stackTrace());
}


// VIEW EMPLOYEE PROFILE ---------------------------------------------------------------------------------------------------------------------

var View_ItemID;
function ViewButtonClicked(item) {
View_ItemID = item.id;
ExecuteOrDelayUntilScriptLoaded(ExecuteViewProfile, "sp.js");


}

var targetListItem;
   function ExecuteViewProfile() {

      View_ItemID = View_ItemID.split("-").pop();

     var clientContext = new SP.ClientContext(); 
     var targetList = clientContext.get_web().get_lists().getByTitle('Employee Profile');
     targetListItem = targetList.getItemById(Number(View_ItemID));
     clientContext.load(targetListItem);
     clientContext.executeQueryAsync(Function.createDelegate(this, this.onQuerySucceeded_ViewProfile), Function.createDelegate(this, this.onQueryFailed));
   }

   function onQuerySucceeded_ViewProfile() {
   
  var var_ItemID = targetListItem.get_item('ID');
  var V_FirstName = targetListItem.get_item('LI_FirstName');
  var V_MiddleName = targetListItem.get_item('LI_MiddleName');
  var V_LastName = targetListItem.get_item('LI_LastName');
  var V_Suffix = targetListItem.get_item('LI_Suffix');
  var V_Sex = targetListItem.get_item('LI_Sex');
  var V_BirthDate = targetListItem.get_item('LI_BirthDate');
  var V_ContactNumber = targetListItem.get_item('LI_ContactNumber');
  var V_CurrentAddress = targetListItem.get_item('LI_CurrentAddress');
  var V_CivilStatus = targetListItem.get_item('LI_CivilStatus');
  var V_ProvincialAddress = targetListItem.get_item('LI_ProvincialAddress');
  var V_EmergencyContactNumber = targetListItem.get_item('LI_EmergencyContactNumber');
  var V_EmergencyContactPerson = targetListItem.get_item('LI_EmergencyContactPerson');
  var V_PersonalEmail = targetListItem.get_item('LI_PersonalEmail');
  var V_Religion = targetListItem.get_item('LI_Religion');
  var V_BirthPlace = targetListItem.get_item('LI_BirthPlace');
  var V_EmployeeID = targetListItem.get_item('LI_EmployeeID');
  var V_Company = targetListItem.get_item('LI_Company');
  var V_Department = targetListItem.get_item('LI_Department');
  var V_Section = targetListItem.get_item('LI_Section');
  var V_PositionTitle = targetListItem.get_item('LI_PositionTitle');
  var V_JobLevel = targetListItem.get_item('LI_JobLevel');
  var V_JobGrade = targetListItem.get_item('LI_JobGrade');
  var V_DateJoined = targetListItem.get_item('LI_DateJoined');
  var V_DateHired = targetListItem.get_item('LI_DateHired');
  var V_ImmediateHead = targetListItem.get_item('LI_ImmediateHead');
  var V_DepartmentHead = targetListItem.get_item('LI_DepartmentHead');
  var V_EmployeeType = targetListItem.get_item('LI_EmployeeType');
  var V_RegularizationDate = targetListItem.get_item('LI_RegularizationDate');
  var V_TIN = targetListItem.get_item('LI_TIN_Number');
  var V_SSS = targetListItem.get_item('LI_SSS_Number');
  var V_PHILHEALTH = targetListItem.get_item('LI_PHILHEALTH');
  var V_PAGIBIG = targetListItem.get_item('LI_PAGIBIG');
  var V_Separated = targetListItem.get_item('LI_Separated');
  var V_EmployeeType = targetListItem.get_item('LI_EmployeeType');
  var V_EmployeeStatus = targetListItem.get_item('LI_EmployeeStatus');
  // alert(V_FirstName+" "+V_MiddleName+" "+V_LastName);

     if(V_Suffix == null){
        V_Suffix = "";

       }
       if(V_Section == null){
        V_Section = "";
       }

        document.getElementById('VIEW_EMPOYEENAME').innerText = V_FirstName + " " + V_MiddleName + " " + V_LastName + " " + V_Suffix;
        document.getElementById('VIEW_ID').innerText = "Employee ID : "+V_EmployeeID;
        document.getElementById('TB_Company').innerHTML  = V_Company;
        document.getElementById('TB_Department').innerHTML  = V_Department;
        document.getElementById('TB_Section').innerHTML  = V_Section;
        document.getElementById('TB_JobLevel').innerHTML = V_JobLevel;
        document.getElementById('TB_PositionTitle').innerHTML = V_PositionTitle;
        document.getElementById('TB_DateJoined').innerHTML = V_DateJoined;
        document.getElementById('TB_DateHired').innerHTML = V_DateHired;
        document.getElementById('TB_JobGrade').innerHTML = V_JobGrade;
        document.getElementById('TB_ImmediateHead').innerHTML = V_ImmediateHead;
        document.getElementById('TB_DepartmentHead').innerHTML = V_DepartmentHead;
        document.getElementById('TB_TIN').value = V_TIN;
        document.getElementById('TB_SSS').value = V_SSS;
        document.getElementById('TB_PHILHEALTH').value = V_PHILHEALTH;
        document.getElementById('TB_PAGIBIG').value = V_PAGIBIG;
        document.getElementById('TB_ContactNumber').innerHTML = V_ContactNumber;
        document.getElementById('TB_CurrentAddress').innerHTML = V_CurrentAddress;
        document.getElementById('TB_Sex').innerHTML = V_Sex;
        document.getElementById('TB_BirthDate').innerHTML = V_BirthDate;
        document.getElementById('TB_CivilStatus').innerHTML = V_CivilStatus;
        document.getElementById('TB_EmgergencyContactNumber').innerHTML = V_EmergencyContactNumber;
        document.getElementById('TB_EmergencyContactPerson').innerHTML = V_EmergencyContactPerson;
        document.getElementById('TB_ProvincialAddress').innerHTML = V_ProvincialAddress;
        document.getElementById('TB_Religion').innerHTML = V_Religion;
        document.getElementById('TB_BirthPlace').innerHTML = V_BirthPlace;
        document.getElementById('TB_PersonalEmail').innerHTML = V_PersonalEmail;
        document.getElementById('TB_EmployeeType').innerHTML = V_EmployeeType;
        document.getElementById('TB_RegularizationDate').innerHTML = V_RegularizationDate;
        document.getElementById('TB_EmployeeStatus').innerHTML = V_EmployeeStatus;

    $('.ui.modal.large.VIEW_PROFILE')
      .modal({
        closable  : true,
        centered: false
      })
      .modal('show');


        document.getElementById('ViewProfileModalTrigger').click();

   }
//-----------------------------------------------------------------------------------------------------------------------------
// VIEW JOB CHART 
var JobChart_ItemID;
var JobChart_Name;
var JobChart_EmployeeID;


var TrainingButton_Func;

function JobChartButtonClicked(item) {
JobChart_ItemID = item.id;
ExecuteOrDelayUntilScriptLoaded(ExecuteViewJobChartRecord, "sp.js");

for(var i=document.getElementById("Table_Trainings").rows.length;i>1;i--) {
document.getElementById("Table_Trainings").deleteRow(i-1);}
  ExecuteOrDelayUntilScriptLoaded(GetEmployeeTrainings, "sp.js");

for(var i=document.getElementById("Table_PositionHistory").rows.length;i>1;i--) {
document.getElementById("Table_PositionHistory").deleteRow(i-1);}
  ExecuteOrDelayUntilScriptLoaded(GetPositionHistory, "sp.js");


}

function ExecuteViewJobChartRecord(){
      JobChart_ItemID = JobChart_ItemID.split("-").pop();
      // alert(JobChart_ItemID);
  
     var clientContext = new SP.ClientContext(); 
     var targetList = clientContext.get_web().get_lists().getByTitle('Employee Profile');
     targetListItem = targetList.getItemById(Number(JobChart_ItemID));
     clientContext.load(targetListItem);
     clientContext.executeQueryAsync(Function.createDelegate(this, this.onQuerySucceeded_ViewJobChart), Function.createDelegate(this, this.onQueryFailed));

  document.getElementById('ViewJobChartTrigger').click();

}

function onQuerySucceeded_ViewJobChart() {
  var V_FirstName = targetListItem.get_item('LI_FirstName');
  var V_MiddleName = targetListItem.get_item('LI_MiddleName');
  var V_LastName = targetListItem.get_item('LI_LastName');
  var V_Suffix = targetListItem.get_item('LI_Suffix');

       if(V_Suffix == null){
        V_Suffix = "";}

   JobChart_Name = V_FirstName + " " + V_MiddleName + " " + V_LastName + " " + V_Suffix;
   JobChart_EmployeeID = targetListItem.get_item('LI_EmployeeID');

}

var Trainings_Items;

function GetEmployeeTrainings(){
   var clientContext = new SP.ClientContext('https://intranet.houseofit.com.au/');
    var oList = clientContext.get_web().get_lists().getByTitle('Training List');
    var camlQuery = new SP.CamlQuery();
    camlQuery.set_viewXml(
      '<View>'+
      '<Query>'+
      '<Where>'+          
      '<Eq>'+
      '<FieldRef Name=\'LI_ItemID\'/>' + 
      '<Value Type=\'Text\'>'+JobChart_ItemID+'</Value>'+
      '</Eq>'+
      '</Where>'+
      '</Query>'+
      '</View>');
    this.Trainings_Items = oList.getItems(camlQuery);
    clientContext.load(Trainings_Items);
    clientContext.executeQueryAsync(Function.createDelegate(this, this.onQuerySucceeded_Trainings), Function.createDelegate(this, this.onQueryFailed));  

}

function onQuerySucceeded_Trainings(sender, args) {

    var listItemEnumerator = Trainings_Items.getEnumerator();    

    while (listItemEnumerator.moveNext()) {
        var oListItem = listItemEnumerator.get_current();

        var var_ItemID = oListItem.get_item('ID');
        var var_TrainingName = oListItem.get_item('LI_Training');
        var var_Duration = oListItem.get_item('LI_TrainingDuration');
        var var_Type = oListItem.get_item('LI_TrainingType');
        var var_Date = oListItem.get_item('LI_TrainingDate');

                                $("#Table_Trainings").append("<tr align='middle'>" +
                               "<td align='middle'>"+var_TrainingName+"</td>" +
                               "<td align='left'>"+var_Duration+"</td>" +
                               "<td align='left'>"+var_Type+"</td>"  +
                               "<td align='left'>"+var_Date+"</td>"  +
                               '<td><a class="btn-floating waves-effect waves-light light-blue z-depth-2 hoverable" id="'+var_ItemID+'" onclick="EditTraining_Clicked(this)" ><i class=" material-icons">mode_edit</i></a></td>' +
                               "</tr>");
                               // alert(var_TrainingName+" | "+var_Duration+" | "+var_Type+" | "+var_Date);
    }
}

var TrainingID_ToEdit = 0;

function EditTraining_Clicked(objButton){
  // alert(objButton.id);
  TrainingID_ToEdit = objButton.id;
  ExecuteOrDelayUntilScriptLoaded(GetTraining_ToEdit, "sp.js");
  TrainingButton_Func = "Edit";
  ClearTrainingForm();
}

var TrainingItem_ToEdit;
function GetTraining_ToEdit(){
     var clientContext = new SP.ClientContext(); 
     var targetList = clientContext.get_web().get_lists().getByTitle('Training List');
     TrainingItem_ToEdit = targetList.getItemById(TrainingID_ToEdit);
     clientContext.load(TrainingItem_ToEdit);
     clientContext.executeQueryAsync(Function.createDelegate(this, this.GetTraining_ToEdit_Success), Function.createDelegate(this, this.onQueryFailed));
}
function GetTraining_ToEdit_Success(){

  document.getElementById('TB_TrainingName').value = TrainingItem_ToEdit.get_item('LI_Training');
  document.getElementById('DP_TrainingType').value = TrainingItem_ToEdit.get_item('LI_TrainingType');
  $('#DP_TrainingType').material_select();
  document.getElementById('Time_StartTime').value = TrainingItem_ToEdit.get_item('LI_StartTime');
  document.getElementById('Time_EndTime').value = TrainingItem_ToEdit.get_item('LI_EndTime');
  document.getElementById('Date_TrainingDate').value = TrainingItem_ToEdit.get_item('LI_TrainingDate');

OpenTrainingForm();

  // alert(TrainingItem_ToEdit.get_item('LI_Training') + '\n' +
  //   TrainingItem_ToEdit.get_item('LI_TrainingType') + '\n' +
  //   TrainingItem_ToEdit.get_item('LI_StartTime') + '\n' +
  //   TrainingItem_ToEdit.get_item('LI_EndTime') + '\n' +
  //   TrainingItem_ToEdit.get_item('LI_TrainingDate'));
}

//-------------------------- POSITION HISTORY

var PositionHistory_Items;
function GetPositionHistory(){
   var clientContext = new SP.ClientContext('https://intranet.houseofit.com.au/');
    var oList = clientContext.get_web().get_lists().getByTitle('Position History');
    var camlQuery = new SP.CamlQuery();
    camlQuery.set_viewXml(
      '<View>'+
      '<Query>'+
      '<Where>'+          
      '<Eq>'+
      '<FieldRef Name=\'LI_ItemID\'/>' + 
      '<Value Type=\'Text\'>'+JobChart_ItemID+'</Value>'+
      '</Eq>'+
      '</Where>'+
      '</Query>'+
      '</View>');
    this.PositionHistory_Items = oList.getItems(camlQuery);
    clientContext.load(PositionHistory_Items);
    clientContext.executeQueryAsync(Function.createDelegate(this, this.onQuerySucceeded_PositionHistory), Function.createDelegate(this, this.onQueryFailed));  

}

function onQuerySucceeded_PositionHistory(sender, args) {

    var listItemEnumerator = PositionHistory_Items.getEnumerator();    

    while (listItemEnumerator.moveNext()) {
        var oListItem = listItemEnumerator.get_current();

        var var_ItemID = oListItem.get_item('ID');
        var var_PositionTitle = oListItem.get_item('LI_PositionTitle');
        var var_Department = oListItem.get_item('LI_Department');
        var var_DateFrom = oListItem.get_item('LI_DateFrom');
        var var_DateTo = oListItem.get_item('LI_DateTo');

                                $("#Table_PositionHistory").append("<tr align='middle'>" +
                               "<td align='middle'>"+var_PositionTitle+"</td>" +
                               "<td align='left'>"+var_Department+"</td>" +
                               "<td align='left'>"+var_DateFrom+"</td>"  +
                               "<td align='left'>"+var_DateTo+"</td>"  +
                               '<td><a class="btn-floating waves-effect waves-light light-blue z-depth-2 hoverable" id="'+var_ItemID+'" onclick="EditPositionHistory_Clicked(this)" ><i class=" material-icons">mode_edit</i></a></td>' +
                               "</tr>");
                               // alert(var_TrainingName+" | "+var_Duration+" | "+var_Type+" | "+var_Date);
    }
}

var PositionHistoryID_ToEdit = 0;
var PositionTitle_Func;
var PositionHistoryItem_ToEdit;

function EditPositionHistory_Clicked(objButton){
  PositionHistoryID_ToEdit = objButton.id;
  ExecuteOrDelayUntilScriptLoaded(GetPositionHistory_ToEdit, "sp.js");
  PositionTitle_Func = "Edit";
  // ClearTrainingForm();
}

function GetPositionHistory_ToEdit(){
     var clientContext = new SP.ClientContext(); 
     var targetList = clientContext.get_web().get_lists().getByTitle('Position History');
     PositionHistoryItem_ToEdit = targetList.getItemById(PositionHistoryID_ToEdit);
     clientContext.load(PositionHistoryItem_ToEdit);
     clientContext.executeQueryAsync(Function.createDelegate(this, this.GetPositionHistory_ToEdit_Success), Function.createDelegate(this, this.onQueryFailed));
}
function GetPositionHistory_ToEdit_Success(){

OpenPositionHistoryForm();

  $('#DP_Position_PosHistory').val(PositionHistoryItem_ToEdit.get_item('LI_PositionTitle'));
  $('#DP_Position_PosHistory').material_select();
  // document.getElementById('DP_Position_PosHistory').value = PositionHistoryItem_ToEdit.get_item('LI_PositionTitle');
  document.getElementById('DP_Department_PosHistory').value = PositionHistoryItem_ToEdit.get_item('LI_Department');
  $('#DP_Department_PosHistory').material_select();
  document.getElementById('Date_PH_DateFrom').value = PositionHistoryItem_ToEdit.get_item('LI_DateFrom');
  document.getElementById('Date_PH_DateTo').value = PositionHistoryItem_ToEdit.get_item('LI_DateTo');

  // alert(PositionHistoryItem_ToEdit.get_item('LI_PositionTitle') + '\n' +
  //   PositionHistoryItem_ToEdit.get_item('LI_Department') + '\n' +
  //   PositionHistoryItem_ToEdit.get_item('LI_DateFrom') + '\n' +
  //   PositionHistoryItem_ToEdit.get_item('LI_DateTo'));
}



//-----------------------------------------------------------------------------------------------------------------------------
function ClearFilter(){
  // document.getElementById('TB_SearchFirstName').value = "";
  
  // $('#Div_Container').empty();
  document.getElementById('TB_SearchLastName').value = "";
  document.getElementById('TB_SearchID').value = "";
  document.getElementById('DP_Department').selectedIndex = 0;
  document.getElementById('DP_Section').selectedIndex = 0;
  document.getElementById('DP_ImmediateHead').selectedIndex = 0;
  document.getElementById('DP_DepartmentHead').selectedIndex = 0;
  ExecuteOrDelayUntilScriptLoaded(retrieveListItems, "sp.js");

  $('select').material_select();
}

//------------------------------------------------------------------------------------------------------------------------------
// FOR REGULARIZATION

function GetForRegularization(){
    var clientContext = new SP.ClientContext('https://intranet.houseofit.com.au/');
    var oList_Department = clientContext.get_web().get_lists().getByTitle('Employee Profile');
    var camlQuery = new SP.CamlQuery();
    camlQuery.set_viewXml(
      '<View>'+
      '<Query>'+
      '<Where>'+
      '<And>'+
      '<Eq>'+
        '<FieldRef Name=\'LI_Separated\'/>' + 
        '<Value Type=\'Text\'>'+NotSeparated+'</Value>'+
        '</Eq>'+      
      '<Eq>'+
      '<FieldRef Name=\'LI_DepartmentHead\'/>' + 
      '<Value Type=\'Text\'>'+document.getElementById("DP_DepartmentHead").options[ document.getElementById("DP_DepartmentHead").selectedIndex ].value+'</Value>'+
      '</Eq>'+
      '</And>'+
      '</Where>'+
      '</Query>'+
      '<RowLimit>'+
      '</RowLimit>'+
      '</View>');
    this.collListItem = oList_Department.getItems(camlQuery);
    clientContext.load(collListItem);
    clientContext.executeQueryAsync(Function.createDelegate(this, this.onQuerySucceeded), Function.createDelegate(this, this.onQueryFailed));  
}


//--------------------------------------------------------------------------------------------------------

function Read_DepartmentHead_Succeeded(sender, args) {
  var listItemsCollection = DepartmentHead_Items.getEnumerator();
  var Array_DepartmentteHead = [];

    while (listItemsCollection.moveNext()) {
      var listItem = listItemsCollection.get_current();
        Array_DepartmentteHead.push(listItem.get_item('Title'));
    }

    for (var i = 0; i<=Array_DepartmentteHead.length-1; i++){
        var opt = document.createElement('option');
        opt.innerHTML = Array_DepartmentteHead[i];
        opt.value = Array_DepartmentteHead[i];
      document.getElementById('DP_DepartmentHead').appendChild(opt);
    }

  $('select').material_select();
}



function LoadCharts(){

ExecuteOrDelayUntilScriptLoaded(GetHiredEmployees_January, "sp.js");
ExecuteOrDelayUntilScriptLoaded(GetHiredEmployees_February, "sp.js");
ExecuteOrDelayUntilScriptLoaded(GetHiredEmployees_March, "sp.js");
ExecuteOrDelayUntilScriptLoaded(GetHiredEmployees_April, "sp.js");
ExecuteOrDelayUntilScriptLoaded(GetHiredEmployees_May, "sp.js");
ExecuteOrDelayUntilScriptLoaded(GetHiredEmployees_June, "sp.js");
ExecuteOrDelayUntilScriptLoaded(GetHiredEmployees_July, "sp.js");
ExecuteOrDelayUntilScriptLoaded(GetHiredEmployees_August, "sp.js");
ExecuteOrDelayUntilScriptLoaded(GetHiredEmployees_September, "sp.js");
ExecuteOrDelayUntilScriptLoaded(GetHiredEmployees_October, "sp.js");
ExecuteOrDelayUntilScriptLoaded(GetHiredEmployees_November, "sp.js");
ExecuteOrDelayUntilScriptLoaded(GetHiredEmployees_December, "sp.js");

 // alert(count_january);
 // alert(count_February);
 // alert(count_March);
 // alert(count_April);
 // alert(count_May);
 // alert(count_June);
 // alert(count_July);
 // alert(count_August);
 // alert(count_September);
 // alert(count_October);
 // alert(count_November);
 // alert(count_December);

var ctx = document.getElementById("myChart");
var myChart = new Chart(ctx, {
    type: 'bar',
    title:'Hired Employee Per Month',
    data: {
        labels: ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"],
        datasets: [{
            label: 'New Hires',
            data: [parseInt(count_january),parseInt(count_February),parseInt(count_March),parseInt(count_April),parseInt(count_May),parseInt(count_June),parseInt(count_July),parseInt(count_August),parseInt(count_September),parseInt(count_October),parseInt(count_November),parseInt(count_December)],
            // data: [12, 19, 3, 5, 2, 3],
            backgroundColor: [
                'rgba(255, 99, 132, 0.2)',
                'rgba(54, 162, 235, 0.2)',
                'rgba(255, 206, 86, 0.2)',
                'rgba(75, 192, 192, 0.2)',
                'rgba(153, 102, 255, 0.2)',
                'rgba(255, 159, 64, 0.2)',
                'rgba(255, 99, 132, 0.2)',
                'rgba(54, 162, 235, 0.2)',
                'rgba(255, 206, 86, 0.2)',
                'rgba(75, 192, 192, 0.2)',
                'rgba(153, 102, 255, 0.2)',
                'rgba(255, 159, 64, 0.2)'
            ],
            borderColor: [
                'rgba(255,99,132,1)',
                'rgba(54, 162, 235, 1)',
                'rgba(255, 206, 86, 1)',
                'rgba(75, 192, 192, 1)',
                'rgba(153, 102, 255, 1)',
                'rgba(255, 159, 64, 1)',
                'rgba(255,99,132,1)',
                'rgba(54, 162, 235, 1)',
                'rgba(255, 206, 86, 1)',
                'rgba(75, 192, 192, 1)',
                'rgba(153, 102, 255, 1)',
                'rgba(255, 159, 64, 1)'                
            ],
            borderWidth: 1
        }]
    },
    options: {
        scales: {
            yAxes: [{
                ticks: {
                    beginAtZero:true
                }
            }]
        },
        title: {
        display: true,
        text: 'Hired Employee(s)'
      },
      legend: { display: false }
    }

});

new Chart(document.getElementById("bar-chart"), {
    type: 'bar',
    data: {
      labels: ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"],
      datasets: [
        {
          label: "Regularized Employee(s)",
          backgroundColor: ["#3e95cd", "#8e5ea2","#3cba9f","#e8c3b9","#c45850","#3e95cd","#8e5ea2","#3cba9f","#e8c3b9","#c45850","#3e95cd", "#8e5ea2"],
          data: [2,6,13,3,7]
        }
      ]
    },
    options: {
      legend: { display: false },
      ticks: {beginAtZero:true},
      title: {
        display: true,
        text: 'Regularized Employee(s)'
      },
      scales: {
            yAxes: [{
                ticks: {
                    beginAtZero:true
                }
            }]
        },
    }
});

}



// COUNT THE NUMBER OF HIRED EMPLOYEES PER MONTH

var listItems ;

var listItems_January;
var listItems_February;
var listItems_March;
var listItems_April;
var listItems_May;
var listItems_June;
var listItems_July;
var listItems_August;
var listItems_September;
var listItems_October;
var listItems_November;
var listItems_December;

var count_january = 0;
var count_February = 0;
var count_March = 0;
var count_April = 0;
var count_May = 0;
var count_June = 0;
var count_July = 0;
var count_August = 0;
var count_September = 0;
var count_October = 0;
var count_November = 0;
var count_December = 0;


function GetHiredEmployees(){

  var CurrentYear = (new Date()).getFullYear();

    var clientContext = new SP.ClientContext('https://intranet.houseofit.com.au/');
    var oList = clientContext.get_web().get_lists().getByTitle('Employee Profile');
    var camlQuery = new SP.CamlQuery();
    camlQuery.set_viewXml(
      '<View>'+
      '<Query>'+
      '<Where>'+
      '<Eq>'+
      '<FieldRef Name=\'LI_YearHired\'/>' + 
      '<Value Type=\'Text\'>'+CurrentYear+'</Value>'+
      '</Eq>'+
      '</Where>'+
      '</Query>'+
      '</View>');
    this.listItems = oList.getItems(camlQuery);
    clientContext.load(listItems);
    clientContext.executeQueryAsync(Function.createDelegate(this, this.GetHiredSucceeded), Function.createDelegate(this, this.onQueryFailed));  
}


//---------------------------------------------------------------------------------------
// GET NUMBER OF EMPLOEES HIRED PER MONTH

function GetHiredEmployees_Monthly(){

  var CurrentYear = (new Date()).getFullYear();

    var clientContext_January = new SP.ClientContext('https://intranet.houseofit.com.au/');
    var oList_jan = clientContext_January.get_web().get_lists().getByTitle('Employee Profile');
    var camlQuery = new SP.CamlQuery();
    camlQuery.set_viewXml(
      '<View>'+
      '<Query>'+
      '<Where>'+
      '<And>'+
      '<Eq>'+
      '<FieldRef Name=\'LI_YearHired\'/>' + 
      '<Value Type=\'Text\'>'+CurrentYear+'</Value>'+
      '</Eq>'+
      '<Eq>'+
      '<FieldRef Name=\'LI_MonthHired\'/>' + 
      '<Value Type=\'Text\'>'+"January"+'</Value>'+
      '</Eq>'+      
      '</And>'+
      '</Where>'+
      '</Query>'+
      '</View>');
    this.listItems_January = oList_jan.getItems(camlQuery);
    clientContext_January.load(listItems_January);
    clientContext_January.executeQueryAsync(Function.createDelegate(this, this.GetMonthlyHiredSucceeded), Function.createDelegate(this, this.onQueryFailed));

    var clientContext_February = new SP.ClientContext('https://intranet.houseofit.com.au/');
    var oList = clientContext_February.get_web().get_lists().getByTitle('Employee Profile');
    var camlQuery = new SP.CamlQuery();
    camlQuery.set_viewXml(
      '<View>'+
      '<Query>'+
      '<Where>'+
      '<And>'+
      '<Eq>'+
      '<FieldRef Name=\'LI_YearHired\'/>' + 
      '<Value Type=\'Text\'>'+CurrentYear+'</Value>'+
      '</Eq>'+
      '<Eq>'+
      '<FieldRef Name=\'LI_MonthHired\'/>' + 
      '<Value Type=\'Text\'>'+"February"+'</Value>'+
      '</Eq>'+      
      '</And>'+
      '</Where>'+
      '</Query>'+
      '</View>');
    this.listItems_February = oList.getItems(camlQuery);
    clientContext_February.load(listItems_February);
    clientContext_February.executeQueryAsync(Function.createDelegate(this, this.GetMonthlyHiredSucceeded), Function.createDelegate(this, this.onQueryFailed));  

    var clientContext_March = new SP.ClientContext('https://intranet.houseofit.com.au/');
    var oList = clientContext_March.get_web().get_lists().getByTitle('Employee Profile');
    var camlQuery = new SP.CamlQuery();
    camlQuery.set_viewXml(
      '<View>'+
      '<Query>'+
      '<Where>'+
      '<And>'+
      '<Eq>'+
      '<FieldRef Name=\'LI_YearHired\'/>' + 
      '<Value Type=\'Text\'>'+CurrentYear+'</Value>'+
      '</Eq>'+
      '<Eq>'+
      '<FieldRef Name=\'LI_MonthHired\'/>' + 
      '<Value Type=\'Text\'>'+"March"+'</Value>'+
      '</Eq>'+      
      '</And>'+
      '</Where>'+
      '</Query>'+
      '</View>');
    this.listItems_March = oList.getItems(camlQuery);
    clientContext_March.load(listItems_March);
    clientContext_March.executeQueryAsync(Function.createDelegate(this, this.GetMonthlyHiredSucceeded), Function.createDelegate(this, this.onQueryFailed));  

    var clientContext_April = new SP.ClientContext('https://intranet.houseofit.com.au/');
    var oList = clientContext_April.get_web().get_lists().getByTitle('Employee Profile');
    var camlQuery = new SP.CamlQuery();
    camlQuery.set_viewXml(
      '<View>'+
      '<Query>'+
      '<Where>'+
      '<And>'+
      '<Eq>'+
      '<FieldRef Name=\'LI_YearHired\'/>' + 
      '<Value Type=\'Text\'>'+CurrentYear+'</Value>'+
      '</Eq>'+
      '<Eq>'+
      '<FieldRef Name=\'LI_MonthHired\'/>' + 
      '<Value Type=\'Text\'>'+"April"+'</Value>'+
      '</Eq>'+      
      '</And>'+
      '</Where>'+
      '</Query>'+
      '</View>');
    this.listItems_April = oList.getItems(camlQuery);
    clientContext_April.load(listItems_April);
    clientContext_April.executeQueryAsync(Function.createDelegate(this, this.GetMonthlyHiredSucceeded), Function.createDelegate(this, this.onQueryFailed));

    var clientContext_May = new SP.ClientContext('https://intranet.houseofit.com.au/');
    var oList = clientContext_May.get_web().get_lists().getByTitle('Employee Profile');
    var camlQuery = new SP.CamlQuery();
    camlQuery.set_viewXml(
      '<View>'+
      '<Query>'+
      '<Where>'+
      '<And>'+
      '<Eq>'+
      '<FieldRef Name=\'LI_YearHired\'/>' + 
      '<Value Type=\'Text\'>'+CurrentYear+'</Value>'+
      '</Eq>'+
      '<Eq>'+
      '<FieldRef Name=\'LI_MonthHired\'/>' + 
      '<Value Type=\'Text\'>'+"May"+'</Value>'+
      '</Eq>'+ 
      '</And>'+
      '</Where>'+
      '</Query>'+
      '</View>');
    this.listItems_May = oList.getItems(camlQuery);
    clientContext_May.load(listItems_May);
    clientContext_May.executeQueryAsync(Function.createDelegate(this, this.GetMonthlyHiredSucceeded), Function.createDelegate(this, this.onQueryFailed)); 

    var clientContext_June = new SP.ClientContext('https://intranet.houseofit.com.au/');
    var oList = clientContext_June.get_web().get_lists().getByTitle('Employee Profile');
    var camlQuery = new SP.CamlQuery();
    camlQuery.set_viewXml(
      '<View>'+
      '<Query>'+
      '<Where>'+
      '<And>'+
      '<Eq>'+
      '<FieldRef Name=\'LI_YearHired\'/>' + 
      '<Value Type=\'Text\'>'+CurrentYear+'</Value>'+
      '</Eq>'+
      '<Eq>'+
      '<FieldRef Name=\'LI_MonthHired\'/>' + 
      '<Value Type=\'Text\'>'+"June"+'</Value>'+
      '</Eq>'+      
      '</And>'+
      '</Where>'+
      '</Query>'+
      '</View>');
    this.listItems_June = oList.getItems(camlQuery);
    clientContext_June.load(listItems_June);
    clientContext_June.executeQueryAsync(Function.createDelegate(this, this.GetMonthlyHiredSucceeded), Function.createDelegate(this, this.onQueryFailed));

    var clientContext_July = new SP.ClientContext('https://intranet.houseofit.com.au/');
    var oList = clientContext_July.get_web().get_lists().getByTitle('Employee Profile');
    var camlQuery = new SP.CamlQuery();
    camlQuery.set_viewXml(
      '<View>'+
      '<Query>'+
      '<Where>'+
      '<And>'+
      '<Eq>'+
      '<FieldRef Name=\'LI_YearHired\'/>' + 
      '<Value Type=\'Text\'>'+CurrentYear+'</Value>'+
      '</Eq>'+
      '<Eq>'+
      '<FieldRef Name=\'LI_MonthHired\'/>' + 
      '<Value Type=\'Text\'>'+"July"+'</Value>'+
      '</Eq>'+      
      '</And>'+
      '</Where>'+
      '</Query>'+
      '</View>');
    this.listItems_July = oList.getItems(camlQuery);
    clientContext_July.load(listItems_July);
    clientContext_July.executeQueryAsync(Function.createDelegate(this, this.GetMonthlyHiredSucceeded), Function.createDelegate(this, this.onQueryFailed));  

    var clientContext_August = new SP.ClientContext('https://intranet.houseofit.com.au/');
    var oList = clientContext_August.get_web().get_lists().getByTitle('Employee Profile');
    var camlQuery = new SP.CamlQuery();
    camlQuery.set_viewXml(
      '<View>'+
      '<Query>'+
      '<Where>'+
      '<And>'+
      '<Eq>'+
      '<FieldRef Name=\'LI_YearHired\'/>' + 
      '<Value Type=\'Text\'>'+CurrentYear+'</Value>'+
      '</Eq>'+
      '<Eq>'+
      '<FieldRef Name=\'LI_MonthHired\'/>' + 
      '<Value Type=\'Text\'>'+"August"+'</Value>'+
      '</Eq>'+      
      '</And>'+
      '</Where>'+
      '</Query>'+
      '</View>');
    this.listItems_August = oList.getItems(camlQuery);
    clientContext_August.load(listItems_August);
    clientContext_August.executeQueryAsync(Function.createDelegate(this, this.GetMonthlyHiredSucceeded), Function.createDelegate(this, this.onQueryFailed)); 

    var clientContext_September = new SP.ClientContext('https://intranet.houseofit.com.au/');
    var oList = clientContext_September.get_web().get_lists().getByTitle('Employee Profile');
    var camlQuery = new SP.CamlQuery();
    camlQuery.set_viewXml(
      '<View>'+
      '<Query>'+
      '<Where>'+
      '<And>'+
      '<Eq>'+
      '<FieldRef Name=\'LI_YearHired\'/>' + 
      '<Value Type=\'Text\'>'+CurrentYear+'</Value>'+
      '</Eq>'+
      '<Eq>'+
      '<FieldRef Name=\'LI_MonthHired\'/>' + 
      '<Value Type=\'Text\'>'+"September"+'</Value>'+
      '</Eq>'+      
      '</And>'+
      '</Where>'+
      '</Query>'+
      '</View>');
    this.listItems_September = oList.getItems(camlQuery);
    clientContext_September.load(listItems_September);
    clientContext_September.executeQueryAsync(Function.createDelegate(this, this.GetMonthlyHiredSucceeded), Function.createDelegate(this, this.onQueryFailed)); 

    var clientContext_October = new SP.ClientContext('https://intranet.houseofit.com.au/');
    var oList = clientContext_October.get_web().get_lists().getByTitle('Employee Profile');
    var camlQuery = new SP.CamlQuery();
    camlQuery.set_viewXml(
      '<View>'+
      '<Query>'+
      '<Where>'+
      '<And>'+
      '<Eq>'+
      '<FieldRef Name=\'LI_YearHired\'/>' + 
      '<Value Type=\'Text\'>'+CurrentYear+'</Value>'+
      '</Eq>'+
      '<Eq>'+
      '<FieldRef Name=\'LI_MonthHired\'/>' + 
      '<Value Type=\'Text\'>'+"October"+'</Value>'+
      '</Eq>'+      
      '</And>'+
      '</Where>'+
      '</Query>'+
      '</View>');
    this.listItems_October = oList.getItems(camlQuery);
    clientContext_October.load(listItems_October);
    clientContext_October.executeQueryAsync(Function.createDelegate(this, this.GetMonthlyHiredSucceeded), Function.createDelegate(this, this.onQueryFailed));  

    var clientContext_November = new SP.ClientContext('https://intranet.houseofit.com.au/');
    var oList = clientContext_November.get_web().get_lists().getByTitle('Employee Profile');
    var camlQuery = new SP.CamlQuery();
    camlQuery.set_viewXml(
      '<View>'+
      '<Query>'+
      '<Where>'+
      '<And>'+
      '<Eq>'+
      '<FieldRef Name=\'LI_YearHired\'/>' + 
      '<Value Type=\'Text\'>'+CurrentYear+'</Value>'+
      '</Eq>'+
      '<Eq>'+
      '<FieldRef Name=\'LI_MonthHired\'/>' + 
      '<Value Type=\'Text\'>'+"November"+'</Value>'+
      '</Eq>'+      
      '</And>'+
      '</Where>'+
      '</Query>'+
      '</View>');
    this.listItems_November = oList.getItems(camlQuery);
    clientContext_November.load(listItems_November);
    clientContext_November.executeQueryAsync(Function.createDelegate(this, this.GetMonthlyHiredSucceeded), Function.createDelegate(this, this.onQueryFailed));

    var clientContext_December = new SP.ClientContext('https://intranet.houseofit.com.au/');
    var oList = clientContext_December.get_web().get_lists().getByTitle('Employee Profile');
    var camlQuery = new SP.CamlQuery();
    camlQuery.set_viewXml(
      '<View>'+
      '<Query>'+
      '<Where>'+
      '<And>'+
      '<Eq>'+
      '<FieldRef Name=\'LI_YearHired\'/>' + 
      '<Value Type=\'Text\'>'+CurrentYear+'</Value>'+
      '</Eq>'+
      '<Eq>'+
      '<FieldRef Name=\'LI_MonthHired\'/>' + 
      '<Value Type=\'Text\'>'+"December"+'</Value>'+
      '</Eq>'+
      '</And>'+
      '</Where>'+
      '</Query>'+
      '</View>');
    this.listItems_December = oList.getItems(camlQuery);
    clientContext_December.load(listItems_December);
    clientContext_December.executeQueryAsync(Function.createDelegate(this, this.GetMonthlyHiredSucceeded), Function.createDelegate(this, this.onQueryFailed)); 
}

function GetMonthlyHiredSucceeded(sender, args) {


count_january = listItems_January.get_count();
count_February = listItems_February.get_count();
count_March = listItems_March.get_count();
count_April = listItems_April.get_count();
count_May = listItems_May.get_count();
count_June = listItems_June.get_count();
count_July = listItems_July.get_count();
count_August = listItems_August.get_count();
count_September = listItems_September.get_count();
count_October = listItems_October.get_count();
count_November = listItems_November.get_count();
count_December = listItems_December.get_count();

// alert(count_january +","+count_February+","+count_March+","+count_April+","+count_May+","+count_June+","+count_July+","+count_August+","+count_September+","+count_October+","+count_November+","+count_December);

var ctx = document.getElementById("myChart");
var myChart = new Chart(ctx, {
    type: 'bar',
    title:'Hired Employee Per Month',
    data: {
        labels: ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"],
        datasets: [{
            label: 'New Hire',
            data: [parseInt(count_january),parseInt(count_February),parseInt(count_March),parseInt(count_April),parseInt(count_May),parseInt(count_June),parseInt(count_July),parseInt(count_August),parseInt(count_September),parseInt(count_October),parseInt(count_November),parseInt(count_December)],
            // data: [12, 19, 3, 5, 2, 3],
            backgroundColor: [
                'rgba(255, 99, 132, 0.2)',
                'rgba(54, 162, 235, 0.2)',
                'rgba(255, 206, 86, 0.2)',
                'rgba(75, 192, 192, 0.2)',
                'rgba(153, 102, 255, 0.2)',
                'rgba(255, 159, 64, 0.2)',
                'rgba(255, 99, 132, 0.2)',
                'rgba(54, 162, 235, 0.2)',
                'rgba(255, 206, 86, 0.2)',
                'rgba(75, 192, 192, 0.2)',
                'rgba(153, 102, 255, 0.2)',
                'rgba(255, 159, 64, 0.2)'
            ],
            borderColor: [
                'rgba(255,99,132,1)',
                'rgba(54, 162, 235, 1)',
                'rgba(255, 206, 86, 1)',
                'rgba(75, 192, 192, 1)',
                'rgba(153, 102, 255, 1)',
                'rgba(255, 159, 64, 1)',
                'rgba(255,99,132,1)',
                'rgba(54, 162, 235, 1)',
                'rgba(255, 206, 86, 1)',
                'rgba(75, 192, 192, 1)',
                'rgba(153, 102, 255, 1)',
                'rgba(255, 159, 64, 1)'                
            ],
            borderWidth: 1
        }]
    },
    options: {
        scales: {
            yAxes: [{
                ticks: {
                  stepSize: 1,
                    beginAtZero:true
                }
            }]
        },
        title: {
        display: true,
        text: 'Hired Employee(s)'
      },
      legend: { display: false }
    }

});


  var months = [ "January", "February", "March", "April", "May", "June",
    "July", "August", "September", "October", "November", "December" ];
  var current_date = new Date();
  var current_month = months[current_date.getMonth()];

  // var li = document.createElement("li");
  // li.className += " collection-item";

  if(current_month == "January"){
    document.getElementById("Badge_NewHires").innerHTML=count_january;
    document.getElementById("Mont_NewHires").innerHTML=current_month;
    var Arrray = [];
    var Array_DateHired = [];
  var ListItemEnumerator = listItems_January.getEnumerator();
        while(ListItemEnumerator.moveNext()) {    
        var oListItem = ListItemEnumerator.get_current();
        var suffix = oListItem.get_item('LI_Suffix')
        if(suffix == null){suffix = ""}
        var name = oListItem.get_item('LI_FirstName') + " " + oListItem.get_item('LI_MiddleName') + " " + oListItem.get_item('LI_LastName') + " " + suffix;
        Arrray.push(name);
        Array_DateHired.push(oListItem.get_item('LI_DateHired'));
        }

        for (var i = 0; i<=Arrray.length-1; i++){
          // var li = document.createElement("li");
          // li.className += " collection-item";
          // li.appendChild(document.createTextNode(Arrray[i]));
          // document.getElementById("UL_NewHires").appendChild(li);


        $("#UL_NewHires").append(
        "<li class='collection-item'>"+
        "<div class = 'row'>"+
        "<div class = 'col s10'>"+Arrray[i]+"</div>"+
        "<div class = 'col s2'>"+Array_DateHired[i]+"</div>"+
        "</div>"+
        "</li>" 
        );
      }
  }
  else if(current_month == "February"){
  document.getElementById("Badge_NewHires").innerHTML=count_February;
  document.getElementById("Mont_NewHires").innerHTML=current_month;
    var Arrray = [];
    var Array_DateHired = [];
  var ListItemEnumerator = listItems_February.getEnumerator();
        while(ListItemEnumerator.moveNext()) {    
        var oListItem = ListItemEnumerator.get_current();
        var suffix = oListItem.get_item('LI_Suffix')
        if(suffix == null){suffix = ""}
        var name = oListItem.get_item('LI_FirstName') + " " + oListItem.get_item('LI_MiddleName') + " " + oListItem.get_item('LI_LastName') + " " + suffix;
        Arrray.push(name);
         Array_DateHired.push(oListItem.get_item('LI_DateHired'));
        }

        for (var i = 0; i<=Arrray.length-1; i++){
          // var li = document.createElement("li");
          // li.className += " collection-item";
          // li.appendChild(document.createTextNode(Arrray[i]));
          // document.getElementById("UL_NewHires").appendChild(li);
        $("#UL_NewHires").append(
        "<li class='collection-item'>"+
        "<div class = 'row'>"+
        "<div class = 'col s10'>"+Arrray[i]+"</div>"+
        "<div class = 'col s2'>"+Array_DateHired[i]+"</div>"+
        "</div>"+
        "</li>" 
        );

      }
  }
  else if(current_month == "March"){
    document.getElementById("Badge_NewHires").innerHTML=count_March;  
  document.getElementById("Mont_NewHires").innerHTML=current_month;
    var Arrray = [];
    var Array_DateHired = [];
  var ListItemEnumerator = listItems_March.getEnumerator();
        while(ListItemEnumerator.moveNext()) {    
        var oListItem = ListItemEnumerator.get_current();
        var suffix = oListItem.get_item('LI_Suffix')
        if(suffix == null){suffix = ""}
        var name = oListItem.get_item('LI_FirstName') + " " + oListItem.get_item('LI_MiddleName') + " " + oListItem.get_item('LI_LastName') + " " + suffix;
        Arrray.push(name);
         Array_DateHired.push(oListItem.get_item('LI_DateHired'));
        }

        for (var i = 0; i<=Arrray.length-1; i++){
          // var li = document.createElement("li");
          // li.className += " collection-item";
          // li.appendChild(document.createTextNode(Arrray[i]));
          // document.getElementById("UL_NewHires").appendChild(li);
        $("#UL_NewHires").append(
        "<li class='collection-item'>"+
        "<div class = 'row'>"+
        "<div class = 'col s10'>"+Arrray[i]+"</div>"+
        "<div class = 'col s2'>"+Array_DateHired[i]+"</div>"+
        "</div>"+
        "</li>" 
        );

      }   
  }
  else if(current_month == "April"){
    document.getElementById("Badge_NewHires").innerHTML=count_April;  
  document.getElementById("Mont_NewHires").innerHTML=current_month;
    var Arrray = [];
    var Array_DateHired = [];
  var ListItemEnumerator = listItems_April.getEnumerator();
        while(ListItemEnumerator.moveNext()) {    
        var oListItem = ListItemEnumerator.get_current();
        var suffix = oListItem.get_item('LI_Suffix')
        if(suffix == null){suffix = ""}
        var name = oListItem.get_item('LI_FirstName') + " " + oListItem.get_item('LI_MiddleName') + " " + oListItem.get_item('LI_LastName') + " " + suffix;
        Arrray.push(name);
         Array_DateHired.push(oListItem.get_item('LI_DateHired'));
        }

        for (var i = 0; i<=Arrray.length-1; i++){
          // var li = document.createElement("li");
          // li.className += " collection-item";
          // li.appendChild(document.createTextNode(Arrray[i]));
          // document.getElementById("UL_NewHires").appendChild(li);
        $("#UL_NewHires").append(
        "<li class='collection-item'>"+
        "<div class = 'row'>"+
        "<div class = 'col s10'>"+Arrray[i]+"</div>"+
        "<div class = 'col s2'>"+Array_DateHired[i]+"</div>"+
        "</div>"+
        "</li>" 
        );

      }       
  }
  else if(current_month == "May"){
    document.getElementById("Badge_NewHires").innerHTML=count_May;  
  document.getElementById("Mont_NewHires").innerHTML=current_month;
    var Arrray = [];
    var Array_DateHired = [];
  var ListItemEnumerator = listItems_May.getEnumerator();
        while(ListItemEnumerator.moveNext()) {    
        var oListItem = ListItemEnumerator.get_current();
        var suffix = oListItem.get_item('LI_Suffix')
        if(suffix == null){suffix = ""}
        var name = oListItem.get_item('LI_FirstName') + " " + oListItem.get_item('LI_MiddleName') + " " + oListItem.get_item('LI_LastName') + " " + suffix;
        Arrray.push(name);
         Array_DateHired.push(oListItem.get_item('LI_DateHired'));
        }

        for (var i = 0; i<=Arrray.length-1; i++){
          // var li = document.createElement("li");
          // li.className += " collection-item";
          // li.appendChild(document.createTextNode(Arrray[i]));
          // document.getElementById("UL_NewHires").appendChild(li);
        $("#UL_NewHires").append(
        "<li class='collection-item'>"+
        "<div class = 'row'>"+
        "<div class = 'col s10'>"+Arrray[i]+"</div>"+
        "<div class = 'col s2'>"+Array_DateHired[i]+"</div>"+
        "</div>"+
        "</li>" 
        );

      }     
  }
  else if(current_month == "June"){
    document.getElementById("Badge_NewHires").innerHTML=count_June; 
  document.getElementById("Mont_NewHires").innerHTML=current_month;
    var Arrray = [];
    var Array_DateHired = [];
  var ListItemEnumerator = listItems_June.getEnumerator();
        while(ListItemEnumerator.moveNext()) {    
        var oListItem = ListItemEnumerator.get_current();
        var suffix = oListItem.get_item('LI_Suffix')
        if(suffix == null){suffix = ""}
        var name = oListItem.get_item('LI_FirstName') + " " + oListItem.get_item('LI_MiddleName') + " " + oListItem.get_item('LI_LastName') + " " + suffix;
        Arrray.push(name);
         Array_DateHired.push(oListItem.get_item('LI_DateHired'));
        }

        for (var i = 0; i<=Arrray.length-1; i++){
          // var li = document.createElement("li");
          // li.className += " collection-item";
          // li.appendChild(document.createTextNode(Arrray[i]));
          // document.getElementById("UL_NewHires").appendChild(li);
        $("#UL_NewHires").append(
        "<li class='collection-item'>"+
        "<div class = 'row'>"+
        "<div class = 'col s10'>"+Arrray[i]+"</div>"+
        "<div class = 'col s2'>"+Array_DateHired[i]+"</div>"+
        "</div>"+
        "</li>" 
        );

      }       
  }   
  else if(current_month == "July"){
    document.getElementById("Badge_NewHires").innerHTML=count_July; 
  document.getElementById("Mont_NewHires").innerHTML=current_month;
    var Arrray = [];
    var Array_DateHired = [];
  var ListItemEnumerator = listItems_July.getEnumerator();
        while(ListItemEnumerator.moveNext()) {    
        var oListItem = ListItemEnumerator.get_current();
        var suffix = oListItem.get_item('LI_Suffix')
        if(suffix == null){suffix = ""}
        var name = oListItem.get_item('LI_FirstName') + " " + oListItem.get_item('LI_MiddleName') + " " + oListItem.get_item('LI_LastName') + " " + suffix;
        Arrray.push(name);
         Array_DateHired.push(oListItem.get_item('LI_DateHired'));
        }

        for (var i = 0; i<=Arrray.length-1; i++){
          // var li = document.createElement("li");
          // li.className += " collection-item";
          // li.appendChild(document.createTextNode(Arrray[i]));
          // document.getElementById("UL_NewHires").appendChild(li);
        $("#UL_NewHires").append(
        "<li class='collection-item'>"+
        "<div class = 'row'>"+
        "<div class = 'col s10'>"+Arrray[i]+"</div>"+
        "<div class = 'col s2'>"+Array_DateHired[i]+"</div>"+
        "</div>"+
        "</li>" 
        );

      }       
  }
  else if(current_month == "August"){
  document.getElementById("Badge_NewHires").innerHTML=count_August;   
  document.getElementById("Mont_NewHires").innerHTML=current_month;
    var Arrray = [];
    var Array_DateHired = [];
  var ListItemEnumerator = listItems_August.getEnumerator();
        while(ListItemEnumerator.moveNext()) {    
        var oListItem = ListItemEnumerator.get_current();
        var suffix = oListItem.get_item('LI_Suffix')
        if(suffix == null){suffix = ""}
        var name = oListItem.get_item('LI_FirstName') + " " + oListItem.get_item('LI_MiddleName') + " " + oListItem.get_item('LI_LastName') + " " + suffix;
        Arrray.push(name);
         Array_DateHired.push(oListItem.get_item('LI_DateHired'));
        }

        for (var i = 0; i<=Arrray.length-1; i++){
          // var li = document.createElement("li");
          // li.className += " collection-item";
          // li.appendChild(document.createTextNode(Arrray[i]));
          // document.getElementById("UL_NewHires").appendChild(li);
        $("#UL_NewHires").append(
        "<li class='collection-item'>"+
        "<div class = 'row'>"+
        "<div class = 'col s10'>"+Arrray[i]+"</div>"+
        "<div class = 'col s2'>"+Array_DateHired[i]+"</div>"+
        "</div>"+
        "</li>" 
        );

      }     
  }
  else if(current_month == "September"){
    document.getElementById("Badge_NewHires").innerHTML=count_September;  
  document.getElementById("Mont_NewHires").innerHTML=current_month;
    var Arrray = [];
    var Array_DateHired = [];
  var ListItemEnumerator = listItems_September.getEnumerator();
        while(ListItemEnumerator.moveNext()) {    
        var oListItem = ListItemEnumerator.get_current();
        var suffix = oListItem.get_item('LI_Suffix')
        if(suffix == null){suffix = ""}
        var name = oListItem.get_item('LI_FirstName') + " " + oListItem.get_item('LI_MiddleName') + " " + oListItem.get_item('LI_LastName') + " " + suffix;
        Arrray.push(name);
         Array_DateHired.push(oListItem.get_item('LI_DateHired'));
        }

        for (var i = 0; i<=Arrray.length-1; i++){
          // var li = document.createElement("li");
          // li.className += " collection-item";
          // li.appendChild(document.createTextNode(Arrray[i]));
          // document.getElementById("UL_NewHires").appendChild(li);
        $("#UL_NewHires").append(
        "<li class='collection-item'>"+
        "<div class = 'row'>"+
        "<div class = 'col s10'>"+Arrray[i]+"</div>"+
        "<div class = 'col s2'>"+Array_DateHired[i]+"</div>"+
        "</div>"+
        "</li>" 
        );

      }     
  }
  else if(current_month == "October"){
    document.getElementById("Badge_NewHires").innerHTML=count_October;  
  document.getElementById("Mont_NewHires").innerHTML=current_month;
    var Arrray = [];
    var Array_DateHired = [];
  var ListItemEnumerator = listItems_October.getEnumerator();
        while(ListItemEnumerator.moveNext()) {    
        var oListItem = ListItemEnumerator.get_current();
        var suffix = oListItem.get_item('LI_Suffix')
        if(suffix == null){suffix = ""}
        var name = oListItem.get_item('LI_FirstName') + " " + oListItem.get_item('LI_MiddleName') + " " + oListItem.get_item('LI_LastName') + " " + suffix;
        Arrray.push(name);
         Array_DateHired.push(oListItem.get_item('LI_DateHired'));
        }

        for (var i = 0; i<=Arrray.length-1; i++){
          // var li = document.createElement("li");
          // li.className += " collection-item";
          // li.appendChild(document.createTextNode(Arrray[i]));
          // document.getElementById("UL_NewHires").appendChild(li);
        $("#UL_NewHires").append(
        "<li class='collection-item'>"+
        "<div class = 'row'>"+
        "<div class = 'col s10'>"+Arrray[i]+"</div>"+
        "<div class = 'col s2'>"+Array_DateHired[i]+"</div>"+
        "</div>"+
        "</li>" 
        );

      }     
  }
  else if(current_month == "November"){
    document.getElementById("Badge_NewHires").innerHTML=count_November; 
  document.getElementById("Mont_NewHires").innerHTML=current_month;
    var Arrray = [];
    var Array_DateHired = [];
  var ListItemEnumerator = listItems_November.getEnumerator();
        while(ListItemEnumerator.moveNext()) {    
        var oListItem = ListItemEnumerator.get_current();
        var suffix = oListItem.get_item('LI_Suffix')
        if(suffix == null){suffix = ""}
        var name = oListItem.get_item('LI_FirstName') + " " + oListItem.get_item('LI_MiddleName') + " " + oListItem.get_item('LI_LastName') + " " + suffix;
        Arrray.push(name);
         Array_DateHired.push(oListItem.get_item('LI_DateHired'));
        }

        for (var i = 0; i<=Arrray.length-1; i++){
          // var li = document.createElement("li");
          // li.className += " collection-item";
          // li.appendChild(document.createTextNode(Arrray[i]));
          // document.getElementById("UL_NewHires").appendChild(li);
        $("#UL_NewHires").append(
        "<li class='collection-item'>"+
        "<div class = 'row'>"+
        "<div class = 'col s10'>"+Arrray[i]+"</div>"+
        "<div class = 'col s2'>"+Array_DateHired[i]+"</div>"+
        "</div>"+
        "</li>" 
        );

      }       
  }
  else if(current_month == "December"){
    document.getElementById("Badge_NewHires").innerHTML=count_December; 
  document.getElementById("Mont_NewHires").innerHTML=current_month;
    var Arrray = [];
    var Array_DateHired = [];
  var ListItemEnumerator = listItems_December.getEnumerator();
        while(ListItemEnumerator.moveNext()) {    
        var oListItem = ListItemEnumerator.get_current();
        var suffix = oListItem.get_item('LI_Suffix')
        if(suffix == null){suffix = ""}
        var name = oListItem.get_item('LI_FirstName') + " " + oListItem.get_item('LI_MiddleName') + " " + oListItem.get_item('LI_LastName') + " " + suffix;
        Arrray.push(name);
         Array_DateHired.push(oListItem.get_item('LI_DateHired'));
        }

        for (var i = 0; i<=Arrray.length-1; i++){
          // var li = document.createElement("li");
          // li.className += " collection-item";
          // li.appendChild(document.createTextNode(Arrray[i]));
          // document.getElementById("UL_NewHires").appendChild(li);
        $("#UL_NewHires").append(
        "<li class='collection-item'>"+
        "<div class = 'row'>"+
        "<div class = 'col s10'>"+Arrray[i]+"</div>"+
        "<div class = 'col s2'>"+Array_DateHired[i]+"</div>"+
        "</div>"+
        "</li>" 
        );

      }     
  }  

// new Chart(document.getElementById("line-chart"), {
//   type: 'line',
//   data: {
//         labels: ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"],
//     datasets: [{ 
//         data: [86,114,106,106,107,111,133,221,783,2478],
//         borderColor: "#3e95cd",
//         fill: false
//       },

//     ]
//   },
//   options: {
//     title: {
//       display: true,
//       text: 'Separated Employees Per Month'
//     },
//     ticks: {
//       stepSize: 1,
//       beginAtZero:true
//     },
//      legend: { display: false }    
//   }
// });

}

//-------------------------------------------------------------------------------------------------------
// GET THE NUMBER OF REGULARIZED EMPLOYEE PER MONTH

var R_listItems_January;
var R_listItems_February;
var R_listItems_March;
var R_listItems_April;
var R_listItems_May;
var R_listItems_June;
var R_listItems_July;
var R_listItems_August;
var R_listItems_September;
var R_listItems_October;
var R_listItems_November;
var R_listItems_December;

var Regularized_January = 0;
var Regularized_February = 0;
var Regularized_March = 0;
var Regularized_April = 0;
var Regularized_May = 0;
var Regularized_June = 0;
var Regularized_July = 0;
var Regularized_August = 0;
var Regularized_September = 0;
var Regularized_October = 0;
var Regularized_November = 0;
var Regularized_December = 0;

var Monthly_Regularized_ListItems;
function Get_Regularized_Employee_Per_Month(){
  var CurrentYear = (new Date()).getFullYear();

    var clientContext = new SP.ClientContext('https://intranet.houseofit.com.au/');
    var oList = clientContext.get_web().get_lists().getByTitle('Employee Profile');
    var camlQuery = new SP.CamlQuery();
    camlQuery.set_viewXml(
      '<View>'+
      '<Query>'+
      '<Where>'+
      '<And>'+
      '<Eq>'+
      '<FieldRef Name=\'LI_EmployeeType\'/>' +
      '<Value Type=\'Text\'>'+"Regular"+'</Value>'+
      '</Eq>'+           
      '<Eq>'+
      '<FieldRef Name=\'LI_YearRegularized\'/>' + 
      '<Value Type=\'Text\'>'+CurrentYear+'</Value>'+
      '</Eq>'+
      '</And>'+
      '</Where>'+
      '</Query>'+
      '</View>');
    this.Monthly_Regularized_ListItems = oList.getItems(camlQuery);
    clientContext.load(Monthly_Regularized_ListItems);
    clientContext.executeQueryAsync(Function.createDelegate(this, this.Get_Regularized_Employee_Per_Month_Succeeded), Function.createDelegate(this, this.onQueryFailed));  
}
function Get_Regularized_Employee_Per_Month_Succeeded(){
      var listItemEnumerator = Monthly_Regularized_ListItems.getEnumerator();
        
    while (listItemEnumerator.moveNext()) {
        var oListItem = listItemEnumerator.get_current();
        var Month = oListItem.get_item('LI_MonthRegularized')

          if(Month == "January"){
            Regularized_January++;
          }
          else if(Month == "February"){
            Regularized_February++;
          }
          else if(Month == "March"){
            Regularized_March++;
          }
          else if(Month == "April"){
            Regularized_April++;
          }
          else if(Month == "May"){
            Regularized_May++;
          }
          else if(Month == "June"){
            Regularized_June++;
          }
          else if(Month == "July"){
            Regularized_July++;
          }
          else if(Month == "August"){
            Regularized_August++;
          }
          else if(Month == "September"){
            Regularized_September++;
          }
          else if(Month == "October"){
            Regularized_October++;
          }
          else if(Month == "November"){
            Regularized_November++;
          }
          else if(Month == "December"){
            Regularized_December++;
          }
      }

      var Array_Months = [Regularized_January,Regularized_February,Regularized_March,Regularized_April,Regularized_May,Regularized_June,Regularized_July,Regularized_August,Regularized_September,Regularized_October,Regularized_November,Regularized_December];
      new Chart(document.getElementById("bar-chart"), {
          type: 'bar',
          data: {
            labels: ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"],
            datasets: [
              {
                label: "Regularized Employee",
                backgroundColor: ["#3e95cd", "#8e5ea2","#3cba9f","#e8c3b9","#c45850","#3e95cd","#8e5ea2","#3cba9f","#e8c3b9","#c45850","#3e95cd", "#8e5ea2"],
                 data: Array_Months
              }
            ]
          },
          options: {
            legend: { display: false },
            ticks: {beginAtZero:true},
            title: {
              display: true,
              text: 'Regularized Employee(s)'
            },
            scales: {
                  yAxes: [{
                      ticks: {
                        stepSize: 1,
                          beginAtZero:true
                      }
                  }]
              },
          }
      });

}


//--------------------------------------------------------------------------------------------------------------
//          GET FOR REGULARIZATION

var listItems_ForReg;
var count_ForReg = 0;

function GetMonthly_ForRegularization() {

  var CurrentYear = (new Date()).getFullYear();


  var months = [ "January", "February", "March", "April", "May", "June",
    "July", "August", "September", "October", "November", "December" ];
  var current_date = new Date();
  var current_month = months[current_date.getMonth()];

    var clientContext = new SP.ClientContext('https://intranet.houseofit.com.au/');
    var oList = clientContext.get_web().get_lists().getByTitle('Employee Profile');
    var camlQuery = new SP.CamlQuery();
    camlQuery.set_viewXml(
      '<View>'+
      '<Query>'+
      '<Where>'+
      '<And>'+
      '<Eq>'+
      '<FieldRef Name=\'LI_YearRegularized\'/>' + 
      '<Value Type=\'Text\'>'+CurrentYear+'</Value>'+
      '</Eq>'+
      '<Eq>'+
      '<FieldRef Name=\'LI_MonthRegularized\'/>' + 
      '<Value Type=\'Text\'>'+current_month+'</Value>'+
      '</Eq>'+  
      '</And>'+
      '</Where>'+
      '</Query>'+
      '</View>');
    this.listItems_ForReg = oList.getItems(camlQuery);
    clientContext.load(listItems_ForReg);
    clientContext.executeQueryAsync(Function.createDelegate(this, this.GetMonthly_ForRegularization_Succeeded), Function.createDelegate(this, this.onQueryFailed));  
}


function GetMonthly_ForRegularization_Succeeded(sender, args) {
count_ForReg = listItems_ForReg.get_count();
document.getElementById("Badge_ForRegularization").innerHTML=count_ForReg;

    var Arrray = [];
    var Array_RegDate = [];
  var ListItemEnumerator = listItems_ForReg.getEnumerator();
        while(ListItemEnumerator.moveNext()) {    
        var oListItem = ListItemEnumerator.get_current();
        var suffix = oListItem.get_item('LI_Suffix')
        if(suffix == null){suffix = ""}
        var name = oListItem.get_item('LI_FirstName') + " " + oListItem.get_item('LI_MiddleName') + " " + oListItem.get_item('LI_LastName') + " " + suffix;
        Arrray.push(name);
        Array_RegDate.push(oListItem.get_item('LI_RegularizationDate'));
        }

        for (var i = 0; i<=Arrray.length-1; i++){
          // var li = document.createElement("li");
          // li.className += " collection-item";
          // li.appendChild(document.createTextNode(Arrray[i]));
          // document.getElementById("UL_ForRegularization").appendChild(li);


      $("#UL_ForRegularization").append(
        "<li class='collection-item'>"+
        "<div class = 'row'>"+
        "<div class = 'col s10'>"+Arrray[i]+"</div>"+
        "<div class = 'col s2'>"+Array_RegDate[i]+"</div>"+
        "</div>"+
        "</li>" 
      );

      }  
}

//-----------------------------------------------------------------------------------------------------------------------------
//          GET MONTHLY BIRTHDAY CELEBRANTS
// -----------------------------------------------------------------------------------------------------------------------------

var listItems_BirtthdayCelebrants;
var count_BirtthdayCelebrants = 0;

function GetMonthly_BirtthdayCelebrants() {

  var CurrentYear = (new Date()).getFullYear();

  var months = [ "January", "February", "March", "April", "May", "June",
    "July", "August", "September", "October", "November", "December" ];
  var current_date = new Date();
  var current_month = months[current_date.getMonth()];

    var clientContext = new SP.ClientContext('https://intranet.houseofit.com.au/');
    var oList = clientContext.get_web().get_lists().getByTitle('Employee Profile');
    var camlQuery = new SP.CamlQuery();
    camlQuery.set_viewXml(
      '<View>'+
      '<Query>'+
      '<Where>'+
      '<Eq>'+
      '<FieldRef Name=\'LI_MonthBirthdate\'/>' + 
      '<Value Type=\'Text\'>'+current_month+'</Value>'+
      '</Eq>'+  
      '</Where>'+
      '</Query>'+
      '</View>');
    this.listItems_BirtthdayCelebrants = oList.getItems(camlQuery);
    clientContext.load(listItems_BirtthdayCelebrants);
    clientContext.executeQueryAsync(Function.createDelegate(this, this.GetMonthly_BirtthdayCelebrants_Succeeded), Function.createDelegate(this, this.onQueryFailed));  
}

function GetMonthly_BirtthdayCelebrants_Succeeded(sender, args) {
// count_BirtthdayCelebrants = listItems_BirtthdayCelebrants.get_count();
// document.getElementById("Badge_BirthdayCelebrants").innerHTML=count_BirtthdayCelebrants;

    var Arrray = [];
    var Array_Bdate = [];
  var ListItemEnumerator = listItems_BirtthdayCelebrants.getEnumerator();
        while(ListItemEnumerator.moveNext()) {    
        var oListItem = ListItemEnumerator.get_current();
        var suffix = oListItem.get_item('LI_Suffix')
        if(suffix == null){suffix = ""}
        var name = oListItem.get_item('LI_FirstName') + " " + oListItem.get_item('LI_MiddleName') + " " + oListItem.get_item('LI_LastName') + " " + suffix;
        Arrray.push(name);
        Array_Bdate.push(oListItem.get_item('LI_BirthDate'));

        }

        for (var i = 0; i<=Arrray.length-1; i++){
          // var li = document.createElement("li");
          // li.className += " collection-item";
          // li.appendChild(document.createTextNode(Arrray[i]));
          // document.getElementById("UL_BirthdayCelebrants").appendChild(li);

        $("#UL_BirthdayCelebrants").append(
          "<li class='collection-item'>"+
          "<div class = 'row'>"+
          "<div class = 'col s10'>"+Arrray[i]+"</div>"+
          "<div class = 'col s2'>"+Array_Bdate[i]+"</div>"+
          "</div>"+
          "</li>" 
        );
      }  
      document.getElementById("Badge_BirthdayCelebrants").innerHTML=Arrray.length;
}

// -----------------------------------------------------------------------------------------------------------------------------
// FILTER DATA TO BE CONVERTED TO EXCEL
// -----------------------------------------------------------------------------------------------------------------------------

function GetItemsToExtract(){
    var clientContext = new SP.ClientContext('https://intranet.houseofit.com.au/');
    var oList_Department = clientContext.get_web().get_lists().getByTitle('Employee Profile');
    var camlQuery = new SP.CamlQuery();
    camlQuery.set_viewXml('<View><Query><Where><Geq><FieldRef Name=\'ID\'/>' + 
        '<Value Type=\'Number\'>1</Value></Geq></Where></Query><RowLimit></RowLimit></View>');
    this.collListItem = oList_Department.getItems(camlQuery);
    clientContext.load(collListItem);
    clientContext.executeQueryAsync(Function.createDelegate(this, this.onQuerySucceeded_ExtractData), Function.createDelegate(this, this.onQueryFailed));  
}

function onQuerySucceeded_ExtractData(sender, args) {

    var listItemInfo = '';

    var listItemEnumerator = collListItem.getEnumerator();
        listItemInfo += '<tr>'
        +'<th>Employee ID</th>'
        +'<th>Name</th>'
        +'<th>Date Joined</th>'
        +'<th>Date Hired</th>'
        +'<th>Company</th>'
        +'<th>Department</th>'
        +'<th>Section</th>'
        +'<th>Position Title</th>'
        +'<th>Job Level</th>'
        +'<th>Immediate Head</th>'
        +'<th>Department Head</th>'
        +'<th>Regularization Date</th>'
        +'<th>Birth Date</th>'
        +'<th>TIN Number</th>'
        +'<th>SSS Number</th>'
        +'<th>PHILHEALTH</th>'
        +'<th>PAG-IBIG</th>'
        +'<th>Current Address</th>'
        +'<th>Contact Number</th>'
        +'<th>Emergency Contact Number</th>'
        +'<th>Emokioyee Status</th>'
        +'<th>Employee Type</th>'
        +'</tr>'
    while (listItemEnumerator.moveNext()) {
        var oListItem = listItemEnumerator.get_current();

    var Suffix = oListItem.get_item('LI_Suffix');
    if(Suffix == null){
      Suffix = "";
    }

        listItemInfo += 
          '</td><td>' + oListItem.get_item('LI_EmployeeID') +
            '</td><td>' + oListItem.get_item('LI_FirstName') + " " + oListItem.get_item('LI_MiddleName') + " " + oListItem.get_item('LI_LastName') + " " + Suffix + 
            '</td><td>' + oListItem.get_item('LI_DateJoined') + 
            '</td><td>' + oListItem.get_item('LI_DateHired') + 
            '</td><td>' + oListItem.get_item('LI_Company') + 
            '</td><td>' + oListItem.get_item('LI_Department') + 
            '</td><td>' + oListItem.get_item('LI_Section') + 
            '</td><td>' + oListItem.get_item('LI_PositionTitle') + 
            '</td><td>' + oListItem.get_item('LI_JobLevel') + 
            '</td><td>' + oListItem.get_item('LI_ImmediateHead') + 
            '</td><td>' + oListItem.get_item('LI_DepartmentHead') + 
            '</td><td>' + oListItem.get_item('LI_RegularizationDate') + 
            '</td><td>' + oListItem.get_item('LI_BirthDate') +
            '</td><td>' + oListItem.get_item('LI_TIN_Number') +
            '</td><td>' + oListItem.get_item('LI_SSS_Number') +
            '</td><td>' + oListItem.get_item('LI_PHILHEALTH') +
            '</td><td>' + oListItem.get_item('LI_PAGIBIG') +
            '</td><td>' + oListItem.get_item('LI_CurrentAddress') +
            '</td><td>' + oListItem.get_item('LI_ContactNumber') +
            '</td><td>' + oListItem.get_item('LI_EmergencyContactNumber') +
            '</td><td>' + oListItem.get_item('LI_EmployeeStatus') + 
            '</td><td>' + oListItem.get_item('LI_EmployeeType')+'</td></tr>';
    }
//listItemInfo +='</table>';
var tbl_obj=document.createElement("TABLE");
tbl_obj.innerHTML=listItemInfo;
tbl_obj.setAttribute("id","headerTable");

    //console.log(listItemInfo.toString());
fnExcelReport(tbl_obj);
}

function fnExcelReport(tbl)
{
    var tab_text="<table border='2px'><tr>";
    var textRange; var j=0;
    tab = tbl;//document.getElementById('headerTable'); // id of table

    for(j = 0 ; j < tab.rows.length ; j++) 
    {     
        tab_text=tab_text+tab.rows[j].innerHTML+"</tr>";
        //tab_text=tab_text+"</tr>";
    }

    tab_text=tab_text+"</table>";
    tab_text= tab_text.replace(/<A[^>]*>|<\/A>/g, "");//remove if u want links in your table
    tab_text= tab_text.replace(/<img[^>]*>/gi,""); // remove if u want images in your table
    tab_text= tab_text.replace(/<input[^>]*>|<\/input>/gi, ""); // reomves input params

    var ua = window.navigator.userAgent;
    var msie = ua.indexOf("MSIE"); 

    if (msie > 0 || !!navigator.userAgent.match(/Trident.*rv\:11\./))      // If Internet Explorer
    {
/*var _iframe=document.createElement("iframe");
_iframe.setAttribute("id","txtArea1");
_iframe.document.open("txt/html","replace");
        _iframe.document.write(tab_text);
        _iframe.document.close();
        _iframe.focus(); 
        sa=_iframe.document.execCommand("SaveAs",true,"Say Thanks to Sumit.xls");*/
document.body.innerHTML = '<iframe id="txtArea1" style="display:none"></iframe>';

        txtArea1.document.open("txt/html","replace");
        txtArea1.document.write(tab_text);
        txtArea1.document.close();
        txtArea1.focus(); 
        sa=txtArea1.document.execCommand("SaveAs",true,"Say Thanks to Sumit.xls");
    }  
    else                 //other browser not tested on IE 11
        sa = window.open('data:application/vnd.ms-excel,' + encodeURIComponent(tab_text));  

    return (sa);
}

function ClickShowExcel(){
ExecuteOrDelayUntilScriptLoaded(GetItemsToExtract, "sp.js");
}

//--------------------------------------------------------------------------------------------------------
// FOR REGULARIZATION


//-----> Get ID
var GetID_ListItems;
var GetID_ListItems_ten_days;
var Update_ID = [];
var Date10DaysFromNow;
var ForRegularization_ID = [];

function GetItemID(){

var CurrentYear = (new Date()).getFullYear(); 

  var months = [ "January", "February", "March", "April", "May", "June",
    "July", "August", "September", "October", "November", "December" ];
  var current_date = new Date();
  var current_month = months[current_date.getMonth()];
  // alert(CurrentYear+" "+current_date+" "+current_month);

  var clientContext_March = new SP.ClientContext('https://intranet.houseofit.com.au/');
    var oList = clientContext_March.get_web().get_lists().getByTitle('Employee Profile');
    var camlQuery = new SP.CamlQuery();
    camlQuery.set_viewXml(
      '<View>'+
      '<Query>'+
      '<Where>'+
      '<And>'+
      '<Eq>'+
      '<FieldRef Name=\'LI_RegularizationDate\'/>' +
      '<Value Type=\'Text\'>'+getFormattedDate(current_date)+'</Value>'+
      '</Eq>'+
      '<Eq>'+
      '<FieldRef Name=\'LI_EmployeeType\'/>' +
      '<Value Type=\'Text\'>'+"Probationary"+'</Value>'+
      '</Eq>'+
      '</And>'+
      '</Where>'+
      '</Query>'+
      '</View>');
    this.GetID_ListItems = oList.getItems(camlQuery);
    clientContext_March.load(GetID_ListItems);
    clientContext_March.executeQueryAsync(Function.createDelegate(this, this.GetRegularizedID_Succeeded), Function.createDelegate(this, this.onQueryFailed));
}

function GetRegularizedID_Succeeded(sender, args) {
    var listItemsCollection = GetID_ListItems.getEnumerator();

    while (listItemsCollection.moveNext()) {
      var listItem = listItemsCollection.get_current();
        Update_ID.push(listItem.get_item('ID'));
    }

    for (var i = 0; i<=Update_ID.length-1; i++){
      UpdateToRegular(Update_ID[i]);
    }

}

    function getFormattedDate(date) {
            var year = date.getFullYear();
            /// Add 1 because JavaScript months start at 0
            var month = (1 + date.getMonth()).toString();
            month = month.length > 1 ? month : '0' + month;
            var day = date.getDate().toString();
            day = day.length > 1 ? day : '0' + day;
            return month + '/' + day + '/' + year;
    }


//------> Update 

function UpdateToRegular(ID){
    var clientContext = new SP.ClientContext('https://intranet.houseofit.com.au/');
    var oList = clientContext.get_web().get_lists().getByTitle('Employee Profile');
    this.oListItem = oList.getItemById(ID);
    oListItem.set_item('LI_EmployeeType', "Regular");
    oListItem.update();
    clientContext.executeQueryAsync(Function.createDelegate(this, this.UpdateToRegular_Success), Function.createDelegate(this, this.onQueryFailed));

}
function UpdateToRegular_Success() {

}

// -------------> NOTIFY HR 10 DAYS BEFORE REGULARIZATION <------------------------------------------------------------

function ForRegularizationWithin10Days() {
    var tt = new Date();

    var date = new Date(tt);
    var newdate = new Date(date);
    newdate.setDate(newdate.getDate() + 10);

    var dd = newdate.getDate();
    var mm = newdate.getMonth() + 1;
    var y = newdate.getFullYear();

    var Day = dd.toString();
    var Month = mm.toString();

    if(Day.length == 1){
      dd = ("0" + newdate.getDate()).slice(-2);
    }
    if(Month.length == 1){
      mm = ("0" + (newdate.getMonth() + 1)).slice(-2);
    }

    var someFormattedDate = mm + '/' + dd + '/' + y;
    return someFormattedDate;
}

function Get_Employees_Regularized_Within_10Days(){
  var CurrentYear = (new Date()).getFullYear(); 

  var months = [ "January", "February", "March", "April", "May", "June",
    "July", "August", "September", "October", "November", "December" ];
  var current_date = new Date();
  var current_month = months[current_date.getMonth()];
  // alert(CurrentYear+" "+current_date+" "+current_month);

  var clientContext = new SP.ClientContext('https://intranet.houseofit.com.au/');
    var oList = clientContext.get_web().get_lists().getByTitle('Employee Profile');
    var camlQuery = new SP.CamlQuery();
    camlQuery.set_viewXml(
      '<View>'+
      '<Query>'+
      '<Where>'+
      '<And>'+
      '<Eq>'+
      '<FieldRef Name=\'LI_RegularizationDate\'/>' +
      '<Value Type=\'Text\'>'+ForRegularizationWithin10Days()+'</Value>'+
      '</Eq>'+
      '<Eq>'+
      '<FieldRef Name=\'LI_EmployeeType\'/>' +
      '<Value Type=\'Text\'>'+"Probationary"+'</Value>'+
      '</Eq>'+
      '</And>'+
      '</Where>'+
      '</Query>'+
      '</View>');
    this.GetID_ListItems_ten_days = oList.getItems(camlQuery);
    clientContext.load(GetID_ListItems_ten_days);
    clientContext.executeQueryAsync(Function.createDelegate(this, this.Get_RegularWithinTenDays_Success), Function.createDelegate(this, this.onQueryFailed));
}

function Get_RegularWithinTenDays_Success(){
  var listItemsCollection = GetID_ListItems_ten_days.getEnumerator();

    while (listItemsCollection.moveNext()) {
      var listItem = listItemsCollection.get_current();
        ForRegularization_ID.push(listItem.get_item('ID'));
    }

    for (var i = 0; i<=ForRegularization_ID.length-1; i++){
      TriggerRegularizationWorkflow(ForRegularization_ID[i]);
      // Start_10Days_Regularization(ForRegularization_ID[i], "Notify 10 Days Before Regularization");
    }
}
function TriggerRegularizationWorkflow(ID){
    if(GetID_ListItems_ten_days.get_count() >= 1){
      var clientContext = new SP.ClientContext('https://intranet.houseofit.com.au/');
        var oList = clientContext.get_web().get_lists().getByTitle('Employee Profile');
        this.oListItem = oList.getItemById(ID);
        oListItem.set_item('LI_RegularizationNotification', "Triggered");
        oListItem.update();
        clientContext.executeQueryAsync(Function.createDelegate(this, this.RegularizationNotification_Success), Function.createDelegate(this, this.onQueryFailed));
    }
}
function RegularizationNotification_Success() {}

// function Start_10Days_Regularization(itemID, wfName) {
//     function __startWorkflow() {
//         var ctx = new SP.ClientContext.get_current(),
//             wfsManager = SP.WorkflowServices.WorkflowServicesManager.newObject(ctx,ctx.get_web()),
//             wfSubscriptions = wfsManager.getWorkflowSubscriptionService().enumerateSubscriptionsByList(_spPageContextInfo.pageListId);
//         ctx.load(wfSubscriptions);
//         ctx.executeQueryAsync(function () {
//             var wfsEnum = wfSubscriptions.getEnumerator();
//             while (wfsEnum.moveNext()) {
//                 var wfSubscription = wfsEnum.get_current();
//                 if (wfSubscription.get_name() === wfName) {
//                     wfsManager.getWorkflowInstanceService().startWorkflowOnListItem(wfSubscription,itemID,new Object());
//                     var note=SP.UI.Notify.addNotification('Init Workflow: '+wfName+' on item: '+itemID, false);
//                 }
//             }
//         });
//     }
//     if (SP.WorkflowServices) {
//         __startWorkflow();
//     } else {
//         var script = document.createElement("script");
//         script.src = "/_layouts/15/sp.workflowservices.js";
//         script.onload = __startWorkflow;
//         document.head.appendChild(script);
//     }
// }

//-------------------------------------------------------------------------------------------------
// https://intranet.houseofit.com.au/_layouts/ListEnableTargeting.aspx?List={9cd0203a-d6b7-4a14-bc45-f626aec7e7f7}
var Infraction_ItemID;
function InfractionButtonClicked(objButton){
  // alert(objButton.id);
  Infraction_ItemID = objButton.id;
  ExecuteOrDelayUntilScriptLoaded(Infraction_Get_Name_And_ID, "sp.js");
  Infraction_Function = "Add";
  // OpenEntryInfraction_Modal();
}

function OpenEntryInfraction_Modal(){
  $('#ModalInfraction').modal('open');
  if(document.getElementById("TB_Infraction_EntryDate").value != ""){
      document.getElementById("TB_Infraction_EntryDate").disabled = false;
  }
  else{
      document.getElementById("TB_Infraction_EntryDate").disabled = true;
  }
}
function CloseInfraction_Modal(){
  $('#ModalInfraction').modal('close');
}

function OpenEntryInfraction_Modal_Entries(){
  $('#Modal_Infration_Entries').modal('open');

}

function CloseInfraction_Modal_Clicked(){
  CloseInfraction_Modal();
  Clear_InfractionEntry_Form();
}

function CloseInfraction_Modal_Entries(){
  $('#Modal_Infration_Entries').modal('close');

  document.getElementById("TB_Infraction_Filter_ID").value = "";
  document.getElementById('DP_Infraction_Filter_Dept').selectedIndex = 0;
  document.getElementById('DP_Infraction_Month_Filter').selectedIndex = 0;

}


function CloseModalJobChart(){
  $('#Modal_Individual_JobChart').modal('close');
}

// TRAINING
function OpenTrainingForm_Clicked(){
    TrainingButton_Func = "Add";
    OpenTrainingForm();
}

function OpenTrainingForm(){
  $('#Modal_Individual_JobChart').modal('close');
  $('#ModalTrainingForm').modal('open');
}

function CloseTrainingForm(){
  $('#ModalTrainingForm').modal('close');
  $('#Modal_Individual_JobChart').modal('open');
  ClearTrainingForm();
}

// POSITION HISTORY

function OpenPositionHistoryForm_Clicked(){
  OpenPositionHistoryForm();
  PositionTitle_Func = "Add";
}
function OpenPositionHistoryForm(){
  $('#Modal_Individual_JobChart').modal('close');
  $('#ModalPositionHistoryForm').modal('open');
}

function ClosePositionHistoryForm(){
  $('#ModalPositionHistoryForm').modal('close');
  $('#Modal_Individual_JobChart').modal('open');
}

function OpenEmployeeTenureModal(){
  $('#ModalEmployeeTenure').modal('open');
}
function CloseEmployeeTenureModal(){
  $('#ModalEmployeeTenure').modal('close');
}


//------------------------------------------------------------------------------------------------------------------------->


function AddTraininng(){
var siteUrl = 'https://intranet.houseofit.com.au/';

 var V_TrainingName = document.getElementById('TB_TrainingName').value;
 var V_TrainingType = document.getElementById("DP_TrainingType").options[ document.getElementById("DP_TrainingType").selectedIndex ].value;
 var V_StartTime = document.getElementById('Time_StartTime').value;
 var V_EndTime = document.getElementById('Time_EndTime').value;
 var V_TrainingDate = document.getElementById('Date_TrainingDate').value;

V_StartTime  = V_StartTime.slice(0,5)+":00"+" "+V_StartTime.slice(5,7);
V_EndTime = V_EndTime.slice(0,5)+":00"+" "+V_EndTime.slice(5,7);

var startTime=moment(V_StartTime, "HH:mm:ss a");
var endTime=moment(V_EndTime, "HH:mm:ss a");
var duration = moment.duration(endTime.diff(startTime));
var hours = parseInt(duration.asHours());
var minutes = parseInt(duration.asMinutes())-hours*60;
// alert (hours + ' hour(s) and '+ minutes+' minutes.')
       
       // var result = endTime.diff(startTime, 'hours') + " Hrs and " +     
                        endTime.diff(startTime, 'minutes') + " Mns";

var V_TrainingDuration = hours+" Hour(s)"+ ' and '+ minutes+" Minute(s)";

var clientContext = new SP.ClientContext(siteUrl);
var oList = clientContext.get_web().get_lists().getByTitle('Training List');
      
var itemCreateInfo = new SP.ListItemCreationInformation();
this.oListItem = oList.addItem(itemCreateInfo);

oListItem.set_item('LI_Training', V_TrainingName);
oListItem.set_item('LI_TrainingType', V_TrainingType);
oListItem.set_item('LI_StartTime', document.getElementById('Time_StartTime').value);
oListItem.set_item('LI_EndTime', document.getElementById('Time_EndTime').value);
oListItem.set_item('LI_TrainingDuration', V_TrainingDuration);
oListItem.set_item('LI_TrainingDate', V_TrainingDate);
oListItem.set_item('LI_EmployeeName', JobChart_Name);
oListItem.set_item('LI_EmployeeID', JobChart_EmployeeID);
oListItem.set_item('LI_ItemID', JobChart_ItemID);

oListItem.update();

clientContext.load(oListItem);
    
clientContext.executeQueryAsync(Function.createDelegate(this, this.AddTraining_Succeeded), Function.createDelegate(this, this.onQueryFailed));

}
function AddTraining_Succeeded(){

for(var i=document.getElementById("Table_Trainings").rows.length;i>1;i--) {
document.getElementById("Table_Trainings").deleteRow(i-1);}
  ExecuteOrDelayUntilScriptLoaded(GetEmployeeTrainings, "sp.js");

CloseTrainingForm();
ClearTrainingForm();

swal({
  type: 'success',
  title: 'Training has been saved',
  showConfirmButton: false,
  timer: 900
});

}

function ValidatSaveTraining(){
  if(isEmptyOrSpaces(document.getElementById('TB_TrainingName').value) ||
    isEmptyOrSpaces(document.getElementById("DP_TrainingType").options[ document.getElementById("DP_TrainingType").selectedIndex ].value) ||
    isEmptyOrSpaces(document.getElementById('Time_StartTime').value) ||
    isEmptyOrSpaces(document.getElementById('Time_EndTime').value) ||
    isEmptyOrSpaces(document.getElementById('Date_TrainingDate').value)){

      swal(
      'Oops...',
      'Please fill all the fields!',
      'error')    
    
  }
  else{
    ;
      if(TrainingButton_Func == "Add"){
        AddTraininng();
      }
      else if(TrainingButton_Func == "Edit"){
        EditTraining();
      }
  }
}

var oListItem_Edit;
function EditTraining(){

 var clientContext = new SP.ClientContext('https://intranet.houseofit.com.au/');
var oList = clientContext.get_web().get_lists().getByTitle('Training List');
this.oListItem_Edit = oList.getItemById(TrainingID_ToEdit);

 var V_TrainingName = document.getElementById('TB_TrainingName').value;
 var V_TrainingType = document.getElementById("DP_TrainingType").options[ document.getElementById("DP_TrainingType").selectedIndex ].value;
 var V_StartTime = document.getElementById('Time_StartTime').value;
 var V_EndTime = document.getElementById('Time_EndTime').value;
 var V_TrainingDate = document.getElementById('Date_TrainingDate').value;

V_StartTime  = V_StartTime.slice(0,5)+":00"+" "+V_StartTime.slice(5,7);
V_EndTime = V_EndTime.slice(0,5)+":00"+" "+V_EndTime.slice(5,7);

var startTime=moment(V_StartTime, "HH:mm:ss a");
var endTime=moment(V_EndTime, "HH:mm:ss a");
var duration = moment.duration(endTime.diff(startTime));
var hours = parseInt(duration.asHours());
var minutes = parseInt(duration.asMinutes())-hours*60;
// alert (hours + ' hour(s) and '+ minutes+' minutes.')
       
       // var result = endTime.diff(startTime, 'hours') + " Hrs and " +     
                        endTime.diff(startTime, 'minutes') + " Mns";

var V_TrainingDuration = hours+" Hour(s)"+ ' and '+ minutes+" Minute(s)";

var oList = clientContext.get_web().get_lists().getByTitle('Training List');     

this.oListItem_Edit = oList.getItemById(TrainingID_ToEdit);

oListItem_Edit.set_item('LI_Training', V_TrainingName);
oListItem_Edit.set_item('LI_TrainingType', V_TrainingType);
oListItem_Edit.set_item('LI_StartTime', document.getElementById('Time_StartTime').value);
oListItem_Edit.set_item('LI_EndTime', document.getElementById('Time_EndTime').value);
oListItem_Edit.set_item('LI_TrainingDuration', V_TrainingDuration);
oListItem_Edit.set_item('LI_TrainingDate', V_TrainingDate);
oListItem_Edit.set_item('LI_EmployeeName', JobChart_Name);
oListItem_Edit.set_item('LI_EmployeeID', JobChart_EmployeeID);
oListItem_Edit.set_item('LI_ItemID', JobChart_ItemID);

oListItem_Edit.update();
clientContext.executeQueryAsync(Function.createDelegate(this, this.AddTraining_Succeeded), Function.createDelegate(this, this.onQueryFailed));
}

function ClearTrainingForm(){
  document.getElementById("TB_TrainingName").value = "";
  document.getElementById('DP_TrainingType').selectedIndex = 0;
  document.getElementById("Time_StartTime").value = "";
  document.getElementById("Time_EndTime").value = "";
  document.getElementById("Date_TrainingDate").value = "";

}

// POSITION HISTORY

var oListItem_PosiionHistory;
function AddPosition(){
var siteUrl = 'https://intranet.houseofit.com.au/';
var clientContext = new SP.ClientContext(siteUrl);
var oList = clientContext.get_web().get_lists().getByTitle('Position History');

var itemCreateInfo = new SP.ListItemCreationInformation();
this.oListItem_PosiionHistory = oList.addItem(itemCreateInfo);

oListItem_PosiionHistory.set_item('LI_PositionTitle', document.getElementById('DP_Position_PosHistory').value);
oListItem_PosiionHistory.set_item('LI_Department', document.getElementById('DP_Department_PosHistory').value);
oListItem_PosiionHistory.set_item('LI_DateFrom', document.getElementById('Date_PH_DateFrom').value);
oListItem_PosiionHistory.set_item('LI_DateTo', document.getElementById('Date_PH_DateTo').value);
oListItem_PosiionHistory.set_item('LI_EmployeeName', JobChart_Name);
oListItem_PosiionHistory.set_item('LI_EmployeeID', JobChart_EmployeeID);
oListItem_PosiionHistory.set_item('LI_ItemID', JobChart_ItemID);

oListItem_PosiionHistory.update();
clientContext.load(oListItem_PosiionHistory);
clientContext.executeQueryAsync(Function.createDelegate(this, this.AddPosition_Succeeded), Function.createDelegate(this, this.onQueryFailed));

}

function EditPosition(){
var siteUrl = 'https://intranet.houseofit.com.au/';
var clientContext = new SP.ClientContext(siteUrl);
var oList = clientContext.get_web().get_lists().getByTitle('Position History');

this.oListItem_PosiionHistory = oList.getItemById(PositionHistoryID_ToEdit);

oListItem_PosiionHistory.set_item('LI_PositionTitle', document.getElementById('DP_Position_PosHistory').value);
oListItem_PosiionHistory.set_item('LI_Department', document.getElementById('DP_Department_PosHistory').value);
oListItem_PosiionHistory.set_item('LI_DateFrom', document.getElementById('Date_PH_DateFrom').value);
oListItem_PosiionHistory.set_item('LI_DateTo', document.getElementById('Date_PH_DateTo').value);
oListItem_PosiionHistory.set_item('LI_EmployeeName', JobChart_Name);
oListItem_PosiionHistory.set_item('LI_EmployeeID', JobChart_EmployeeID);
oListItem_PosiionHistory.set_item('LI_ItemID', JobChart_ItemID);

oListItem_PosiionHistory.update();
clientContext.executeQueryAsync(Function.createDelegate(this, this.AddPosition_Succeeded), Function.createDelegate(this, this.onQueryFailed));

}

function AddPosition_Succeeded(){
for(var i=document.getElementById("Table_PositionHistory").rows.length;i>1;i--) {
document.getElementById("Table_PositionHistory").deleteRow(i-1);}
  ExecuteOrDelayUntilScriptLoaded(GetPositionHistory, "sp.js");

ClosePositionHistoryForm();
// ClearTrainingForm();

swal({
  type: 'success',
  title: 'Position has been saved',
  showConfirmButton: false,
  timer: 900
});
}

function ValidatePositionHistoryForm(){
  if(isEmptyOrSpaces(document.getElementById('DP_Position_PosHistory').value) ||
    isEmptyOrSpaces(document.getElementById('DP_Department_PosHistory').value) ||
    isEmptyOrSpaces(document.getElementById('Date_PH_DateFrom').value) ||
    isEmptyOrSpaces(document.getElementById('Date_PH_DateTo').value)){

      swal(
      'Oops...',
      'Please fill all the fields!',
      'error')  

  }
  else{
    
    if(PositionTitle_Func == "Add"){
      AddPosition();
    }
    else if(PositionTitle_Func == "Edit"){
      EditPosition();
    }
  }



}

//-----------------------------------------------------------
var Infraction_Function;

var Infraction_targetListItem;
var Infraction_Name;
var Infraction_EmployeeID;
var Infraction_EmployeeItemID;
var Infraction_Department;
var Infraction_Section;

function Infraction_Get_Name_And_ID(){

      // alert(Infraction_ItemID);
  
     var clientContext = new SP.ClientContext(); 
     var targetList = clientContext.get_web().get_lists().getByTitle('Employee Profile');
     Infraction_targetListItem = targetList.getItemById(Number(Infraction_ItemID));
     clientContext.load(Infraction_targetListItem);
     clientContext.executeQueryAsync(Function.createDelegate(this, this.Infraction_Get_Name_And_ID_Succeeded), Function.createDelegate(this, this.onQueryFailed));

}
function Infraction_Get_Name_And_ID_Succeeded(){
  var V_FirstName = Infraction_targetListItem.get_item('LI_FirstName');
  var V_MiddleName = Infraction_targetListItem.get_item('LI_MiddleName');
  var V_LastName = Infraction_targetListItem.get_item('LI_LastName');
  var V_Suffix = Infraction_targetListItem.get_item('LI_Suffix');

       if(V_Suffix == null){
        V_Suffix = "";}

   Infraction_Name = V_FirstName + " " + V_MiddleName + " " + V_LastName + " " + V_Suffix;
   Infraction_EmployeeID = Infraction_targetListItem.get_item('LI_EmployeeID');
   Infraction_EmployeeItemID = Infraction_targetListItem.get_item('ID');
   Infraction_Department = Infraction_targetListItem.get_item('LI_Department');
   Infraction_Section = Infraction_targetListItem.get_item('LI_Section');

   document.getElementById("TB_Infraction_Employee").value = Infraction_Name;
   document.getElementById("TB_Infractions_EmpID").value = Infraction_EmployeeID;
   document.getElementById("TB_Infraction_Department").value = Infraction_Department;
   document.getElementById("TB_Infraction_Section").value = Infraction_Section;

  // var today = new Date();
  // var dd = today.getDate();
  // var mm = today.getMonth()+1; //January is 0!

  // var yyyy = today.getFullYear();
  // if(dd<10){
  //     dd='0'+dd;
  // } 
  // if(mm<10){
  //     mm='0'+mm;
  // } 
  // var today = mm+'/'+dd+'/'+yyyy;     

  // document.getElementById("TB_Infraction_EntryDate").value = today;

Open_Infraction_Form();

   // OpenEntryInfraction_Modal();



}

var Infraction_Entry_ID;
var Infraction_Entry_Name;
var Infraction_Entry_Department;
var Infraction_Entry_Date;
var Infraction_Entry_Month;
var Infraction_Entry_Year;
var Infraction_Entry_SanctionType;
var Infraction_Entry_BreachType;
var Infraction_Entry_Points;
var Infraction_IncidentReportNumber;
var Infraction_Entry_Section;
var Infraction_Entry_Violation;
var Infraction_PrescriptiveDate;

function Validate_InfractionEntry_Form(){
  if(isEmptyOrSpaces(document.getElementById("TB_Infractions_EmpID").value) ||
      isEmptyOrSpaces(document.getElementById("TB_Infraction_Employee").value) ||
    isEmptyOrSpaces(document.getElementById("TB_Infraction_Department").value) ||
    isEmptyOrSpaces(document.getElementById("DP_Infraction_TypeOfSanction").value) ||
    isEmptyOrSpaces(document.getElementById("TB_Infraction_EntryDate").value) ||
    isEmptyOrSpaces(document.getElementById("TB_IncidentReportNumber").value) ||
    isEmptyOrSpaces(document.getElementById("DP_Infraction_Breach").value) ||
    isEmptyOrSpaces(document.getElementById("TB_Infraction_Points").value)){
      swal(
      'Oops...',
      'Please fill all the fields',
      'error'
      )        
  }
  else{
    if(Infraction_Function == "Add"){
      Add_Infraction_Entry();
    }
    else if(Infraction_Function == "Edit"){
      Edit_Infraction_Entry();
    }
  }
}

  function toDate(dateStr) {
      const [month, day, year] = dateStr.split("/")
      return new Date(year, month - 1, day)
  }

    function getFormattedDate(date) {
            var year = date.getFullYear();
            /// Add 1 because JavaScript months start at 0
            var month = (1 + date.getMonth()).toString();
            month = month.length > 1 ? month : '0' + month;
            var day = date.getDate().toString();
            day = day.length > 1 ? day : '0' + day;
            return month + '/' + day + '/' + year;
    }

  function monthDiff(d1, d2) {
      var months;
      months = (d2.getFullYear() - d1.getFullYear()) * 12;
      months -= d1.getMonth() + 1;
      months += d2.getMonth();
      return months <= 0 ? 0 : months;
  }



var oListItem_InfractionPoints;
function Add_Infraction_Entry(){

var months = [ "January", "February", "March", "April", "May", "June",
      "July", "August", "September", "October", "November", "December" ];   

    var EntryDate = new Date(document.getElementById("TB_Infraction_EntryDate").value); 
    var Moth_EntryDate = EntryDate.getMonth()+1; 

    Infraction_Entry_Month = months[parseInt(Moth_EntryDate)-1];
    Infraction_Entry_Year = EntryDate.getFullYear();  

    Infraction_Entry_Date = document.getElementById("TB_Infraction_EntryDate").value;
    Infraction_Entry_ID = document.getElementById("TB_Infractions_EmpID").value;
    Infraction_Entry_Name = document.getElementById("TB_Infraction_Employee").value;
    Infraction_Entry_Department = document.getElementById("TB_Infraction_Department").value;
    Infraction_Entry_SanctionType = document.getElementById("DP_Infraction_TypeOfSanction").value;
    Infraction_Entry_BreachType = document.getElementById("DP_Infraction_Breach").value;
    Infraction_Entry_Points = document.getElementById("TB_Infraction_Points").value;
    Infraction_IncidentReportNumber = document.getElementById("TB_IncidentReportNumber").value;
    Infraction_Entry_Section = document.getElementById("TB_Infraction_Section").value;
    Infraction_Entry_Violation = document.getElementById("DP_Infraction_Violation").value;
    Infraction_PrescriptiveDate = document.getElementById("TB_PrescriptiveDate").value;

  var siteUrl = 'https://intranet.houseofit.com.au/';
  var clientContext = new SP.ClientContext(siteUrl);
  var oList = clientContext.get_web().get_lists().getByTitle('Infraction Point System');

  var itemCreateInfo = new SP.ListItemCreationInformation();
  this.oListItem_InfractionPoints = oList.addItem(itemCreateInfo);

    oListItem_InfractionPoints.set_item('LI_EmployeeID', Infraction_Entry_ID);
    oListItem_InfractionPoints.set_item('LI_EmployeeName', Infraction_Entry_Name);
    oListItem_InfractionPoints.set_item('LI_EmployeeDepartment', Infraction_Entry_Department);
    oListItem_InfractionPoints.set_item('LI_EntryDate', Infraction_Entry_Date);
    oListItem_InfractionPoints.set_item('LI_EntryMonth', Infraction_Entry_Month);
    oListItem_InfractionPoints.set_item('LI_EntryYear', Infraction_Entry_Year);
    oListItem_InfractionPoints.set_item('LI_SanctionType', Infraction_Entry_SanctionType);
    oListItem_InfractionPoints.set_item('LI_BreachType', Infraction_Entry_BreachType);
    oListItem_InfractionPoints.set_item('LI_InfractionPoints', Infraction_Entry_Points);
    oListItem_InfractionPoints.set_item('LI_IncidentReportNumber', Infraction_IncidentReportNumber);
    oListItem_InfractionPoints.set_item('LI_Section', Infraction_Entry_Section);
    oListItem_InfractionPoints.set_item('LI_Violation', Infraction_Entry_Violation); 
    oListItem_InfractionPoints.set_item('LI_Count', "1"); 
    oListItem_InfractionPoints.set_item('LI_PrescriptiveDate', Infraction_PrescriptiveDate); 

    oListItem_InfractionPoints.update();
    clientContext.load(oListItem_InfractionPoints);
    clientContext.executeQueryAsync(Function.createDelegate(this, this.Add_Infraction_Entry_Succeeded), Function.createDelegate(this, this.onQueryFailed));

}

function Edit_Infraction_Entry(){

var months = [ "January", "February", "March", "April", "May", "June",
      "July", "August", "September", "October", "November", "December" ];   

    var EntryDate = new Date(document.getElementById("TB_Infraction_EntryDate").value); 
    var Moth_EntryDate = EntryDate.getMonth()+1; 

    Infraction_Entry_Month = months[parseInt(Moth_EntryDate)-1];
    Infraction_Entry_Year = EntryDate.getFullYear();  

    Infraction_Entry_Date = document.getElementById("TB_Infraction_EntryDate").value;
    Infraction_Entry_ID = document.getElementById("TB_Infractions_EmpID").value;
    Infraction_Entry_Name = document.getElementById("TB_Infraction_Employee").value;
    Infraction_Entry_Department = document.getElementById("TB_Infraction_Department").value;
    Infraction_Entry_SanctionType = document.getElementById("DP_Infraction_TypeOfSanction").value;
    Infraction_Entry_BreachType = document.getElementById("DP_Infraction_Breach").value;
    Infraction_Entry_Points = document.getElementById("TB_Infraction_Points").value;
    Infraction_IncidentReportNumber = document.getElementById("TB_IncidentReportNumber").value;
    Infraction_Entry_Section = document.getElementById("TB_Infraction_Section").value;
    Infraction_Entry_Violation = document.getElementById("DP_Infraction_Violation").value;
    Infraction_PrescriptiveDate = document.getElementById("TB_PrescriptiveDate").value;

  var siteUrl = 'https://intranet.houseofit.com.au/';
  var clientContext = new SP.ClientContext(siteUrl);
  var oList = clientContext.get_web().get_lists().getByTitle('Infraction Point System');

  this.oListItem_InfractionPoints = oList.getItemById(InfractionEntry_ID_ToEdit);

    oListItem_InfractionPoints.set_item('LI_EmployeeID', Infraction_Entry_ID);
    oListItem_InfractionPoints.set_item('LI_EmployeeName', Infraction_Entry_Name);
    oListItem_InfractionPoints.set_item('LI_EmployeeDepartment', Infraction_Entry_Department);
    oListItem_InfractionPoints.set_item('LI_EntryDate', Infraction_Entry_Date);
    oListItem_InfractionPoints.set_item('LI_EntryMonth', Infraction_Entry_Month);
    oListItem_InfractionPoints.set_item('LI_EntryYear', Infraction_Entry_Year);
    oListItem_InfractionPoints.set_item('LI_SanctionType', Infraction_Entry_SanctionType);
    oListItem_InfractionPoints.set_item('LI_BreachType', Infraction_Entry_BreachType);
    oListItem_InfractionPoints.set_item('LI_InfractionPoints', Infraction_Entry_Points);
    oListItem_InfractionPoints.set_item('LI_IncidentReportNumber', Infraction_IncidentReportNumber);
    oListItem_InfractionPoints.set_item('LI_Section', Infraction_Entry_Section);
    oListItem_InfractionPoints.set_item('LI_Violation', Infraction_Entry_Violation); 
    oListItem_InfractionPoints.set_item('LI_Count', "1"); 
    oListItem_InfractionPoints.set_item('LI_PrescriptiveDate', Infraction_PrescriptiveDate); 

    oListItem_InfractionPoints.update();
    clientContext.load(oListItem_InfractionPoints);
    clientContext.executeQueryAsync(Function.createDelegate(this, this.Add_Infraction_Entry_Succeeded), Function.createDelegate(this, this.onQueryFailed));

}


function Add_Infraction_Entry_Succeeded(){

    for(var i=document.getElementById("Table_Infraction_Entries").rows.length;i>1;i--) {
  document.getElementById("Table_Infraction_Entries").deleteRow(i-1);}
    ExecuteOrDelayUntilScriptLoaded(Get_Infraction_Entries, "sp.js");


  Close_Infraction_Form();

  CloseInfraction_Modal();
  Clear_InfractionEntry_Form();

  swal({
  type: 'success',
  title: 'Entry has been saved',
  showConfirmButton: false,
  timer: 1000
})

}

var Infraction_Entry_Items;
function Get_Infraction_Entries(){
  var siteUrl = 'https://intranet.houseofit.com.au/';
  var clientContext = new SP.ClientContext(siteUrl);
  var Entries = clientContext.get_web().get_lists().getByTitle("Infraction Point System");
  var camlQuery = SP.CamlQuery.createAllItemsQuery();
  this.Infraction_Entry_Items = Entries.getItems(camlQuery);

  clientContext.load(Infraction_Entry_Items);
  clientContext.executeQueryAsync(Get_InfractionEntries_Succeeded, onQueryFailed);
}

function onQueryFailed(sender, args) {

    alert('Request failed. ' + args.get_message() + '\n' + args.get_stackTrace());
}

function Get_InfractionEntries_Succeeded(sender, args) {

    var listItemsCollection = Infraction_Entry_Items.getEnumerator();

    while (listItemsCollection.moveNext()) {
      var listItem = listItemsCollection.get_current();

      var var_ItemID = listItem.get_item('ID');

                              $("#Table_Infraction_Entries").append("<tr align='middle'>" +
                               "<td align='left'>"+listItem.get_item('LI_EmployeeID')+"</td>" +
                               "<td align='left'>"+listItem.get_item('LI_EmployeeName')+"</td>" +
                               "<td align='left'>"+listItem.get_item('LI_EmployeeDepartment')+"</td>"  +
                               "<td align='left'>"+listItem.get_item('LI_EntryDate')+"</td>"  +
                               "<td align='left'>"+listItem.get_item('LI_IncidentReportNumber')+"</td>"  +
                               "<td align='left'>"+listItem.get_item('LI_SanctionType')+"</td>"  +
                               "<td align='left'>"+listItem.get_item('LI_BreachType')+"</td>"  +
                               "<td align='left'>"+listItem.get_item('LI_InfractionPoints')+"</td>"  +

                               '<td><a class="btn-floating waves-effect waves-light light-blue z-depth-2 hoverable" id="'+var_ItemID+'"     onclick="Edit_InfractionEntry_Clicked(this)" ><i class=" material-icons">mode_edit</i></a></td>' +

                               '<td><a class="btn-floating waves-effect waves-light light-blue z-depth-2 hoverable" id="'+var_ItemID+'" onclick="Delete_InfractionEntry_Clicked(this)" ><i class=" material-icons">delete_forever</i></a></td>' +                               
                               "</tr>");


    }
}

var InfractionEntry_ID_ToEdit;
function Edit_InfractionEntry_Clicked(objButton){
  InfractionEntry_ID_ToEdit = objButton.id;
  ExecuteOrDelayUntilScriptLoaded(Get_InfractionEntry_ToEdit,'sp.js');
  Infraction_Function = "Edit";
}
var InfractionEntry_ToEdit;
function Get_InfractionEntry_ToEdit(){
   var clientContext = new SP.ClientContext(); 
     var targetList = clientContext.get_web().get_lists().getByTitle('Infraction Point System');
     InfractionEntry_ToEdit = targetList.getItemById(InfractionEntry_ID_ToEdit);
     clientContext.load(InfractionEntry_ToEdit);
     clientContext.executeQueryAsync(Function.createDelegate(this, this.Get_InfractionEntry_ToEdit_Success), Function.createDelegate(this, this.onQueryFailed));
} 
function Get_InfractionEntry_ToEdit_Success(){

  document.getElementById("TB_Infractions_EmpID").value = InfractionEntry_ToEdit.get_item('LI_EmployeeID');
  document.getElementById("TB_Infraction_Employee").value = InfractionEntry_ToEdit.get_item('LI_EmployeeName');
  document.getElementById("TB_Infraction_Department").value = InfractionEntry_ToEdit.get_item('LI_EmployeeDepartment');
  document.getElementById("TB_Infraction_EntryDate").value = InfractionEntry_ToEdit.get_item('LI_EntryDate');
  document.getElementById("TB_IncidentReportNumber").value = InfractionEntry_ToEdit.get_item('LI_IncidentReportNumber');
  document.getElementById("TB_Infraction_Section").value = InfractionEntry_ToEdit.get_item('LI_Section');
  // document.getElementById("DP_Infraction_Violation").value = InfractionEntry_ToEdit.get_item('LI_Violation');
	$('.ui.selection.dropdown.DP_VIOLATION.col.s12').dropdown('set selected', InfractionEntry_ToEdit.get_item('LI_Violation'));

  // document.getElementById("DP_Infraction_TypeOfSanction").value = InfractionEntry_ToEdit.get_item('LI_SanctionType');

  $('.ui.selection.dropdown.DP_SANCTION.col.s12').dropdown('set selected', InfractionEntry_ToEdit.get_item('LI_SanctionType'));

  document.getElementById("DP_Infraction_Breach").value = InfractionEntry_ToEdit.get_item('LI_BreachType');

  $('.ui.selection.dropdown.DP_BREACH.col.s12').dropdown('set selected', InfractionEntry_ToEdit.get_item('LI_BreachType'));

  document.getElementById("TB_Infraction_Points").value = InfractionEntry_ToEdit.get_item('LI_InfractionPoints');
  // document.getElementById("TB_PrescriptiveDate").value = InfractionEntry_ToEdit.get_item('LI_PrescriptiveDate');

Breach = InfractionEntry_ToEdit.get_item('LI_BreachType');
SanctionType = InfractionEntry_ToEdit.get_item('LI_SanctionType');

  document.getElementById("TB_Infraction_EntryDate").value = InfractionEntry_ToEdit.get_item('LI_EntryDate');

      var InfractionDate = $("#TB_Infraction_EntryDate").val().split("/");
      
      var Date_Infraction = new Date(InfractionDate[2], InfractionDate[0] - 1, InfractionDate[1]);

    if (InfractionEntry_ToEdit.get_item('LI_BreachType') == "Minor Breach" && InfractionEntry_ToEdit.get_item('LI_SanctionType') == "Verbal Warning"){
      Date_Infraction.setMonth(Date_Infraction.getMonth() + 6);
      var RegularizationDate = getFormattedDate(Date_Infraction);
      document.getElementById('TB_PrescriptiveDate').value = RegularizationDate;
      // alert(RegularizationDate);
    }  
    else if (InfractionEntry_ToEdit.get_item('LI_BreachType') == "Minor Breach" && InfractionEntry_ToEdit.get_item('LI_SanctionType') == "Written Warning"){
      Date_Infraction.setMonth(Date_Infraction.getMonth() + 6);
      var RegularizationDate = getFormattedDate(Date_Infraction);
      document.getElementById('TB_PrescriptiveDate').value = RegularizationDate;

    }  
    else if (InfractionEntry_ToEdit.get_item('LI_BreachType') == "Minor Breach" && InfractionEntry_ToEdit.get_item('LI_SanctionType') == "Final Warning"){
      Date_Infraction.setMonth(Date_Infraction.getMonth() + 6);
      var RegularizationDate = getFormattedDate(Date_Infraction);
      document.getElementById('TB_PrescriptiveDate').value = RegularizationDate;

    }  
    else if (InfractionEntry_ToEdit.get_item('LI_BreachType')== "Minor Breach" && InfractionEntry_ToEdit.get_item('LI_SanctionType') == "1 Day Suspension"){
      Date_Infraction.setMonth(Date_Infraction.getMonth() + 6);
      var RegularizationDate = getFormattedDate(Date_Infraction);
      document.getElementById('TB_PrescriptiveDate').value = RegularizationDate;

    }  
    else if (InfractionEntry_ToEdit.get_item('LI_BreachType') == "Minor Breach" && InfractionEntry_ToEdit.get_item('LI_SanctionType') == "3 Days Suspension"){
      Date_Infraction.setMonth(Date_Infraction.getMonth() + 6);
      var RegularizationDate = getFormattedDate(Date_Infraction);
      document.getElementById('TB_PrescriptiveDate').value = RegularizationDate;

    }  
    else if (InfractionEntry_ToEdit.get_item('LI_BreachType') == "Minor Breach" && InfractionEntry_ToEdit.get_item('LI_SanctionType') == "5 Days Suspension"){
      Date_Infraction.setMonth(Date_Infraction.getMonth() + 6);
      var RegularizationDate = getFormattedDate(Date_Infraction);
      document.getElementById('TB_PrescriptiveDate').value = RegularizationDate;

    }  

//---------------->>>>>>>>>>>>>>
    else if (InfractionEntry_ToEdit.get_item('LI_BreachType') == "Major Breach" && InfractionEntry_ToEdit.get_item('LI_SanctionType') == "Written Warning"){
      Date_Infraction.setMonth(Date_Infraction.getMonth() + 12);
      var RegularizationDate = getFormattedDate(Date_Infraction);
      document.getElementById('TB_PrescriptiveDate').value = RegularizationDate;
    } 
    else if (InfractionEntry_ToEdit.get_item('LI_BreachType') == "Major Breach" && InfractionEntry_ToEdit.get_item('LI_SanctionType') == "Final Warning"){
      Date_Infraction.setMonth(Date_Infraction.getMonth() + 12);
      var RegularizationDate = getFormattedDate(Date_Infraction);
      document.getElementById('TB_PrescriptiveDate').value = RegularizationDate;
    } 
    else if (InfractionEntry_ToEdit.get_item('LI_BreachType') == "Major Breach" && InfractionEntry_ToEdit.get_item('LI_SanctionType') == "1 Day Suspension"){
      Date_Infraction.setMonth(Date_Infraction.getMonth() + 12);
      var RegularizationDate = getFormattedDate(Date_Infraction);
      document.getElementById('TB_PrescriptiveDate').value = RegularizationDate;
    }  
    else if (InfractionEntry_ToEdit.get_item('LI_BreachType') == "Major Breach" && InfractionEntry_ToEdit.get_item('LI_SanctionType') == "3 Days Suspension"){
      Date_Infraction.setMonth(Date_Infraction.getMonth() + 12);
      var RegularizationDate = getFormattedDate(Date_Infraction);
      document.getElementById('TB_PrescriptiveDate').value = RegularizationDate;
    }  
    else if (InfractionEntry_ToEdit.get_item('LI_BreachType') == "Major Breach" && InfractionEntry_ToEdit.get_item('LI_SanctionType') == "5 Days Suspension"){
      Date_Infraction.setMonth(Date_Infraction.getMonth() + 12);
      var RegularizationDate = getFormattedDate(Date_Infraction);
      document.getElementById('TB_PrescriptiveDate').value = RegularizationDate;
    }  
//---------------->>>>>>>>>>>>>>------------>>>>>>>>>>>>>>>
    else if (InfractionEntry_ToEdit.get_item('LI_BreachType') == "Serious Breach" && InfractionEntry_ToEdit.get_item('LI_SanctionType') == "1 Day Suspension"){
      Date_Infraction.setMonth(Date_Infraction.getMonth() + 24);
      var RegularizationDate = getFormattedDate(Date_Infraction);
      document.getElementById('TB_PrescriptiveDate').value = RegularizationDate;
    }  
    else if (InfractionEntry_ToEdit.get_item('LI_BreachType') == "Serious Breach" && InfractionEntry_ToEdit.get_item('LI_SanctionType') == "3 Days Suspension"){
      Date_Infraction.setMonth(Date_Infraction.getMonth() + 24);
      var RegularizationDate = getFormattedDate(Date_Infraction);
      document.getElementById('TB_PrescriptiveDate').value = RegularizationDate;
    }  
    else if (InfractionEntry_ToEdit.get_item('LI_BreachType') == "Serious Breach" && InfractionEntry_ToEdit.get_item('LI_SanctionType') == "5 Days Suspension"){
      Date_Infraction.setMonth(Date_Infraction.getMonth() + 24);
      var RegularizationDate = getFormattedDate(Date_Infraction);
      document.getElementById('TB_PrescriptiveDate').value = RegularizationDate;
    }  
    else if (InfractionEntry_ToEdit.get_item('LI_BreachType') == "Serious Breach" && InfractionEntry_ToEdit.get_item('LI_SanctionType') == "Written Warning"){
      Date_Infraction.setMonth(Date_Infraction.getMonth() + 12);
      var RegularizationDate = getFormattedDate(Date_Infraction);
      document.getElementById('TB_PrescriptiveDate').value = RegularizationDate;
    }  
    else if (InfractionEntry_ToEdit.get_item('LI_BreachType') == "Serious Breach" && InfractionEntry_ToEdit.get_item('LI_SanctionType') == "Final Warning"){
      Date_Infraction.setMonth(Date_Infraction.getMonth() + 12);
      var RegularizationDate = getFormattedDate(Date_Infraction);
      document.getElementById('TB_PrescriptiveDate').value = RegularizationDate;
    }  
    else if (InfractionEntry_ToEdit.get_item('LI_BreachType') == "Serious Breach" && InfractionEntry_ToEdit.get_item('LI_SanctionType') == "Verbal Warning"){
      Date_Infraction.setMonth(Date_Infraction.getMonth() + 12);
      var RegularizationDate = getFormattedDate(Date_Infraction);
      document.getElementById('TB_PrescriptiveDate').value = RegularizationDate;
    }  


Open_Infraction_Form();

  // CloseInfraction_Modal_Entries();
  // OpenEntryInfraction_Modal();
}

function Delete_InfractionEntry_Clicked(objButton){
  // alert(objButton.id);
  var siteUrl = 'https://intranet.houseofit.com.au/';
  var clientContext = new SP.ClientContext(siteUrl);
  var oList = clientContext.get_web().get_lists().getByTitle('Infraction Point System');
  this.oListItem_Points = oList.getItemById(objButton.id);
  oListItem_Points.deleteObject();
  clientContext.executeQueryAsync(Function.createDelegate(this, this.Delete_InfractionEntry_Succeeded), Function.createDelegate(this, this.onQueryFailed));
}
function Delete_InfractionEntry_Succeeded(){

  swal({
  type: 'success',
  title: 'Entry has been Deleted',
  showConfirmButton: false,
  timer: 1000
})

    for(var i=document.getElementById("Table_Infraction_Entries").rows.length;i>1;i--) {
    document.getElementById("Table_Infraction_Entries").deleteRow(i-1);}
    ExecuteOrDelayUntilScriptLoaded(Get_Infraction_Entries, "sp.js");

}

function Clear_InfractionEntry_Form(){
  document.getElementById("TB_Infractions_EmpID").value = "";
  document.getElementById("TB_Infraction_Employee").value = "";
  document.getElementById("TB_Infraction_Department").value = "";
  document.getElementById("TB_Infraction_EntryDate").value = "";
  document.getElementById("TB_IncidentReportNumber").value = "";
  document.getElementById("DP_Infraction_Breach").selectedIndex = 0;
  document.getElementById("DP_Infraction_TypeOfSanction").selectedIndex = 0;
  document.getElementById("TB_Infraction_Points").value = "";
  document.getElementById("TB_PrescriptiveDate").value = "";
  document.getElementById("DP_Infraction_Violation").selectedIndex = 0;
}

function Refresh_InfractionEntries(){
      for(var i=document.getElementById("Table_Infraction_Entries").rows.length;i>1;i--) {
    document.getElementById("Table_Infraction_Entries").deleteRow(i-1);}
    ExecuteOrDelayUntilScriptLoaded(Get_Infraction_Entries, "sp.js");
}

function Validate_Filter_Infractions(){

  if (document.getElementById("DP_Infraction_Filter_Dept").value != "" && document.getElementById("TB_Infraction_Filter_ID").value != "" && document.getElementById("DP_Infraction_Month_Filter").value){

      for(var i=document.getElementById("Table_Infraction_Entries").rows.length;i>1;i--) {
    document.getElementById("Table_Infraction_Entries").deleteRow(i-1);}
    ExecuteOrDelayUntilScriptLoaded(Filter_Infraction_Entries_Dept_LastName_Month, "sp.js");

  }
  else if (document.getElementById("DP_Infraction_Filter_Dept").value != "" && document.getElementById("TB_Infraction_Filter_ID").value != ""){
      for(var i=document.getElementById("Table_Infraction_Entries").rows.length;i>1;i--) {
    document.getElementById("Table_Infraction_Entries").deleteRow(i-1);}
    ExecuteOrDelayUntilScriptLoaded(Filter_Infraction_Entries_Dept_EmpID, "sp.js");

  }
  else if (document.getElementById("TB_Infraction_Filter_ID").value != "" && document.getElementById("DP_Infraction_Month_Filter").value){
      for(var i=document.getElementById("Table_Infraction_Entries").rows.length;i>1;i--) {
    document.getElementById("Table_Infraction_Entries").deleteRow(i-1);}
    ExecuteOrDelayUntilScriptLoaded(Filter_Infraction_Entries_Month_EmpID, "sp.js");
   
  }
  else if (document.getElementById("DP_Infraction_Filter_Dept").value != "" && document.getElementById("DP_Infraction_Month_Filter").value){
      for(var i=document.getElementById("Table_Infraction_Entries").rows.length;i>1;i--) {
    document.getElementById("Table_Infraction_Entries").deleteRow(i-1);}
    ExecuteOrDelayUntilScriptLoaded(Filter_Infraction_Entries_Month_Dept, "sp.js");
    
  }

}

var Filter_Infraction_Entries_Dept_LastName_Month_Items;
function Filter_Infraction_Entries_Dept_LastName_Month(){

        var Dept = document.getElementById("DP_Infraction_Filter_Dept").value;      
        var Emp_ID = document.getElementById("TB_Infraction_Filter_ID").value;
        var Month = document.getElementById("DP_Infraction_Month_Filter").value;

        // alert(Dept +"\n"+Emp_ID+"\n"+Month);

        var clientContext = new SP.ClientContext('https://intranet.houseofit.com.au/');
        var oList = clientContext.get_web().get_lists().getByTitle('Infraction Point System');
        var camlQuery = new SP.CamlQuery();
        camlQuery.set_viewXml(      
        '<View>'+
          '<Query>'+
          '<Where>'+
          '<And>'+

        '<Eq>'+
          '<FieldRef Name=\'LI_EmployeeDepartment\'/>' + 
          '<Value Type=\'Text\'>'+Dept+'</Value>'+
        '</Eq>'+

          '<And>'+
          '<Eq>'+
          '<FieldRef Name=\'LI_EmployeeID\'/>' + 
          '<Value Type=\'Text\'>'+Emp_ID+'</Value>'+
          '</Eq>'+
          '<Eq>'+
          '<FieldRef Name=\'LI_EntryMonth\'/>' + 
          '<Value Type=\'Text\'>'+Month+'</Value>'+
          '</Eq>'+
          '</And>'+
          '</And>'+
          '</Where>'+
          '<RowLimit>'+
          '</RowLimit>'+
          '</Query>'+
          '</View>');


        this.Filter_Infraction_Entries_Dept_LastName_Month_Items = oList.getItems(camlQuery);
        clientContext.load(Filter_Infraction_Entries_Dept_LastName_Month_Items);
        clientContext.executeQueryAsync(Function.createDelegate(this, this.Filter_Infraction_Entries_Dept_LastName_Month_Succeeded), Function.createDelegate(this, this.onQueryFailed));
}
function Filter_Infraction_Entries_Dept_LastName_Month_Succeeded(sender, args) {

    var listItemsCollection = Filter_Infraction_Entries_Dept_LastName_Month_Items.getEnumerator();

    while (listItemsCollection.moveNext()) {
      var listItem = listItemsCollection.get_current();

      var var_ItemID = listItem.get_item('ID');

                              $("#Table_Infraction_Entries").append("<tr align='middle'>" +
                               "<td align='left'>"+listItem.get_item('LI_EmployeeID')+"</td>" +
                               "<td align='left'>"+listItem.get_item('LI_EmployeeName')+"</td>" +
                               "<td align='left'>"+listItem.get_item('LI_EmployeeDepartment')+"</td>"  +
                               "<td align='left'>"+listItem.get_item('LI_EntryDate')+"</td>"  +
                               "<td align='left'>"+listItem.get_item('LI_IncidentReportNumber')+"</td>"  +
                               "<td align='left'>"+listItem.get_item('LI_SanctionType')+"</td>"  +
                               "<td align='left'>"+listItem.get_item('LI_BreachType')+"</td>"  +
                               "<td align='left'>"+listItem.get_item('LI_InfractionPoints')+"</td>"  +

                               '<td><a class="btn-floating waves-effect waves-light light-blue z-depth-2 hoverable" id="'+var_ItemID+'"     onclick="Edit_InfractionEntry_Clicked(this)" ><i class=" material-icons">mode_edit</i></a></td>' +

                               '<td><a class="btn-floating waves-effect waves-light light-blue z-depth-2 hoverable" id="'+var_ItemID+'" onclick="Delete_InfractionEntry_Clicked(this)" ><i class=" material-icons">delete_forever</i></a></td>' +                               
                               "</tr>");


    }
}


var Filter_Infraction_Entries_Dept_EmpID_Items;
function Filter_Infraction_Entries_Dept_EmpID(){

        var Dept = document.getElementById("DP_Infraction_Filter_Dept").value;      
        var Emp_ID = document.getElementById("TB_Infraction_Filter_ID").value;
        var Month = document.getElementById("DP_Infraction_Month_Filter").value;

        // alert(Dept +"\n"+Emp_ID+"\n"+Month);

        var clientContext = new SP.ClientContext('https://intranet.houseofit.com.au/');
        var oList = clientContext.get_web().get_lists().getByTitle('Infraction Point System');
        var camlQuery = new SP.CamlQuery();
        camlQuery.set_viewXml(      
        '<View>'+
          '<Query>'+
          '<Where>'+
          '<And>'+
          '<Eq>'+
          '<FieldRef Name=\'LI_EmployeeID\'/>' + 
          '<Value Type=\'Text\'>'+Emp_ID+'</Value>'+
          '</Eq>'+
          '<Eq>'+
          '<FieldRef Name=\'LI_EmployeeDepartment\'/>' + 
          '<Value Type=\'Text\'>'+Dept+'</Value>'+
          '</Eq>'+
          '</And>'+
          '</Where>'+
          '<RowLimit>'+
          '</RowLimit>'+
          '</Query>'+
          '</View>');

        this.Filter_Infraction_Entries_Dept_EmpID_Items = oList.getItems(camlQuery);
        clientContext.load(Filter_Infraction_Entries_Dept_EmpID_Items);
        clientContext.executeQueryAsync(Function.createDelegate(this, this.Filter_Infraction_Entries_Dept_EmpID_Succeeded), Function.createDelegate(this, this.onQueryFailed));
}
function Filter_Infraction_Entries_Dept_EmpID_Succeeded(sender, args) {

    var listItemsCollection = Filter_Infraction_Entries_Dept_EmpID_Items.getEnumerator();

    while (listItemsCollection.moveNext()) {
      var listItem = listItemsCollection.get_current();

      var var_ItemID = listItem.get_item('ID');

                              $("#Table_Infraction_Entries").append("<tr align='middle'>" +
                               "<td align='left'>"+listItem.get_item('LI_EmployeeID')+"</td>" +
                               "<td align='left'>"+listItem.get_item('LI_EmployeeName')+"</td>" +
                               "<td align='left'>"+listItem.get_item('LI_EmployeeDepartment')+"</td>"  +
                               "<td align='left'>"+listItem.get_item('LI_EntryDate')+"</td>"  +
                               "<td align='left'>"+listItem.get_item('LI_IncidentReportNumber')+"</td>"  +
                               "<td align='left'>"+listItem.get_item('LI_SanctionType')+"</td>"  +
                               "<td align='left'>"+listItem.get_item('LI_BreachType')+"</td>"  +
                               "<td align='left'>"+listItem.get_item('LI_InfractionPoints')+"</td>"  +

                               '<td><a class="btn-floating waves-effect waves-light light-blue z-depth-2 hoverable" id="'+var_ItemID+'"     onclick="Edit_InfractionEntry_Clicked(this)" ><i class=" material-icons">mode_edit</i></a></td>' +

                               '<td><a class="btn-floating waves-effect waves-light light-blue z-depth-2 hoverable" id="'+var_ItemID+'" onclick="Delete_InfractionEntry_Clicked(this)" ><i class=" material-icons">delete_forever</i></a></td>' +                               
                               "</tr>");


    }
}


var Filter_Infraction_Entries_Month_EmpID_Items;
function Filter_Infraction_Entries_Month_EmpID(){

        var Dept = document.getElementById("DP_Infraction_Filter_Dept").value;      
        var Emp_ID = document.getElementById("TB_Infraction_Filter_ID").value;
        var Month = document.getElementById("DP_Infraction_Month_Filter").value;

        // alert(Dept +"\n"+Emp_ID+"\n"+Month);

        var clientContext = new SP.ClientContext('https://intranet.houseofit.com.au/');
        var oList = clientContext.get_web().get_lists().getByTitle('Infraction Point System');
        var camlQuery = new SP.CamlQuery();
        camlQuery.set_viewXml(      
        '<View>'+
          '<Query>'+
          '<Where>'+
          '<And>'+
          '<Eq>'+
          '<FieldRef Name=\'LI_EmployeeID\'/>' + 
          '<Value Type=\'Text\'>'+Emp_ID+'</Value>'+
          '</Eq>'+
          '<Eq>'+
          '<FieldRef Name=\'LI_EntryMonth\'/>' + 
          '<Value Type=\'Text\'>'+Month+'</Value>'+
          '</Eq>'+
          '</And>'+
          '</Where>'+
          '<RowLimit>'+
          '</RowLimit>'+
          '</Query>'+
          '</View>');

        this.Filter_Infraction_Entries_Month_EmpID_Items = oList.getItems(camlQuery);
        clientContext.load(Filter_Infraction_Entries_Month_EmpID_Items);
        clientContext.executeQueryAsync(Function.createDelegate(this, this.Filter_Infraction_Entries_Month_EmpID_Succeeded), Function.createDelegate(this, this.onQueryFailed));
}
function Filter_Infraction_Entries_Month_EmpID_Succeeded(sender, args) {

    var listItemsCollection = Filter_Infraction_Entries_Month_EmpID_Items.getEnumerator();

    while (listItemsCollection.moveNext()) {
      var listItem = listItemsCollection.get_current();

      var var_ItemID = listItem.get_item('ID');

                              $("#Table_Infraction_Entries").append("<tr align='middle'>" +
                               "<td align='left'>"+listItem.get_item('LI_EmployeeID')+"</td>" +
                               "<td align='left'>"+listItem.get_item('LI_EmployeeName')+"</td>" +
                               "<td align='left'>"+listItem.get_item('LI_EmployeeDepartment')+"</td>"  +
                               "<td align='left'>"+listItem.get_item('LI_EntryDate')+"</td>"  +
                               "<td align='left'>"+listItem.get_item('LI_IncidentReportNumber')+"</td>"  +
                               "<td align='left'>"+listItem.get_item('LI_SanctionType')+"</td>"  +
                               "<td align='left'>"+listItem.get_item('LI_BreachType')+"</td>"  +
                               "<td align='left'>"+listItem.get_item('LI_InfractionPoints')+"</td>"  +

                               '<td><a class="btn-floating waves-effect waves-light light-blue z-depth-2 hoverable" id="'+var_ItemID+'"     onclick="Edit_InfractionEntry_Clicked(this)" ><i class=" material-icons">mode_edit</i></a></td>' +

                               '<td><a class="btn-floating waves-effect waves-light light-blue z-depth-2 hoverable" id="'+var_ItemID+'" onclick="Delete_InfractionEntry_Clicked(this)" ><i class=" material-icons">delete_forever</i></a></td>' +                               
                               "</tr>");


    }
}

var Filter_Infraction_Entries_Month_Items;
function Filter_Infraction_Entries_Month_Dept(){

        var Dept = document.getElementById("DP_Infraction_Filter_Dept").value;      
        var Emp_ID = document.getElementById("TB_Infraction_Filter_ID").value;
        var Month = document.getElementById("DP_Infraction_Month_Filter").value;

        // alert(Dept +"\n"+Emp_ID+"\n"+Month);

        var clientContext = new SP.ClientContext('https://intranet.houseofit.com.au/');
        var oList = clientContext.get_web().get_lists().getByTitle('Infraction Point System');
        var camlQuery = new SP.CamlQuery();
        camlQuery.set_viewXml(      
        '<View>'+
          '<Query>'+
          '<Where>'+
          '<And>'+
          '<Eq>'+
          '<FieldRef Name=\'LI_EmployeeDepartment\'/>' + 
          '<Value Type=\'Text\'>'+Dept+'</Value>'+
          '</Eq>'+
          '<Eq>'+
          '<FieldRef Name=\'LI_EntryMonth\'/>' + 
          '<Value Type=\'Text\'>'+Month+'</Value>'+
          '</Eq>'+
          '</And>'+
          '</Where>'+
          '<RowLimit>'+
          '</RowLimit>'+
          '</Query>'+
          '</View>');

        this.Filter_Infraction_Entries_Month_Items = oList.getItems(camlQuery);
        clientContext.load(Filter_Infraction_Entries_Month_Items);
        clientContext.executeQueryAsync(Function.createDelegate(this, this.Filter_Infraction_Entries_Month_Dept_Succeeded), Function.createDelegate(this, this.onQueryFailed));
}
function Filter_Infraction_Entries_Month_Dept_Succeeded(sender, args) {

    var listItemsCollection = Filter_Infraction_Entries_Month_Items.getEnumerator();

    while (listItemsCollection.moveNext()) {
      var listItem = listItemsCollection.get_current();

      var var_ItemID = listItem.get_item('ID');

                              $("#Table_Infraction_Entries").append("<tr align='middle'>" +
                               "<td align='left'>"+listItem.get_item('LI_EmployeeID')+"</td>" +
                               "<td align='left'>"+listItem.get_item('LI_EmployeeName')+"</td>" +
                               "<td align='left'>"+listItem.get_item('LI_EmployeeDepartment')+"</td>"  +
                               "<td align='left'>"+listItem.get_item('LI_EntryDate')+"</td>"  +
                               "<td align='left'>"+listItem.get_item('LI_IncidentReportNumber')+"</td>"  +
                               "<td align='left'>"+listItem.get_item('LI_SanctionType')+"</td>"  +
                               "<td align='left'>"+listItem.get_item('LI_BreachType')+"</td>"  +
                               "<td align='left'>"+listItem.get_item('LI_InfractionPoints')+"</td>"  +

                               '<td><a class="btn-floating waves-effect waves-light light-blue z-depth-2 hoverable" id="'+var_ItemID+'"     onclick="Edit_InfractionEntry_Clicked(this)" ><i class=" material-icons">mode_edit</i></a></td>' +

                               '<td><a class="btn-floating waves-effect waves-light light-blue z-depth-2 hoverable" id="'+var_ItemID+'" onclick="Delete_InfractionEntry_Clicked(this)" ><i class=" material-icons">delete_forever</i></a></td>' +                               
                               "</tr>");


    }
}

//-----------------------------------------------------------------------------------------------------
// GET EMPLOYEE TENURE MONTHS

var Get_Employee_Tenure_Items_3Months;

var Tenure_3Months = 0;
var Tenure_6Months = 0;
var Tenure_Anniversary = 0;

function Get_Employee_Tenure_3Months() {

    var months = [ "January", "February", "March", "April", "May", "June",
    "July", "August", "September", "October", "November", "December" ];

    var CurrentMonth = (new Date()).getMonth()+1;

    var today = new Date();
    var dd = 1;
    var mm = today.getMonth()+1; //January is 0!

    var yyyy = today.getFullYear();
    if(dd<10){
        dd='0'+dd;
    } 
    if(mm<10){
        mm='0'+mm;
    } 
    var today = yyyy+'/'+mm+'/'+dd; 

    Date_Today_Minus3Months = new Date(today);
    Date_Today_Minus3Months.setMonth(Date_Today_Minus3Months.getMonth() -3);

    var Month_3Months = Date_Today_Minus3Months.getMonth();
    Month_3Months = months[Month_3Months]
    // console.log(Month_3Months);

//-----------------------------------------------------------------------------------
    var clientContext = new SP.ClientContext('https://intranet.houseofit.com.au/');
    var oList_Department = clientContext.get_web().get_lists().getByTitle('Employee Profile');
    var camlQuery = new SP.CamlQuery();
    camlQuery.set_viewXml('<View>'+
      '<Query>'+
      '<Where>'+
      '<And>'+
      '<Eq>'+
      '<FieldRef Name=\'LI_MonthHired\'/>' + 
      '<Value Type=\'Text\'>'+Month_3Months+'</Value>'+
      '</Eq>'+ 
      '<And>'+
        '<Eq>'+
        '<FieldRef Name=\'LI_Separated\'/>' + 
        '<Value Type=\'Text\'>'+"Active"+'</Value>'+
        '</Eq>'+      
        '<Eq>'+
        '<FieldRef Name=\'LI_EmployeeStatus\'/>' + 
        '<Value Type=\'Text\'>'+"Employee"+'</Value>'+
        '</Eq>'+ 
        '</And>'+
        '</And>'+
        '</Where>'+
        '</Query>'+
        '<RowLimit>'+
        '</RowLimit>'+
        '</View>');
    this.Get_Employee_Tenure_Items_3Months = oList_Department.getItems(camlQuery);
    clientContext.load(Get_Employee_Tenure_Items_3Months);
    clientContext.executeQueryAsync(Function.createDelegate(this, this.Get_Employee_Tenure_3Months_Succeeded), Function.createDelegate(this, this.onQueryFailed));    
}
function Get_Employee_Tenure_3Months_Succeeded() {
    var listItemsCollection = Get_Employee_Tenure_Items_3Months.getEnumerator();

    var months = [ "January", "February", "March", "April", "May", "June",
    "July", "August", "September", "October", "November", "December" ];

    var CurrentYear = (new Date()).getFullYear();

    var today = new Date();
    var dd = today.getDate();
    var mm = today.getMonth()+1; //January is 0!

    var yyyy = today.getFullYear();
    if(dd<10){
        dd='0'+dd;
    } 
    if(mm<10){
        mm='0'+mm;
    } 
    var today = mm+'/'+dd+'/'+yyyy; 

    var Months3_Array_EmpID = [];
    var Months3_Array_Name = [];
    var Months3_Array_Department = [];
    var Months3_Arrray_DateHired = [];

    while (listItemsCollection.moveNext()) {
      var listItem = listItemsCollection.get_current();

        var suffix = listItem.get_item('LI_Suffix')
        if(suffix == null){suffix = ""}

      var EmpID = listItem.get_item('LI_EmployeeID');
      var name = listItem.get_item('LI_FirstName') + " " + listItem.get_item('LI_MiddleName') + " " + listItem.get_item('LI_LastName') + " " + suffix;
      var Dept =  listItem.get_item('LI_Department');
      var Date_ActualDateHired = listItem.get_item('LI_DateHired');
      //----------------------------------------------------------------------------------------------------------

      var Month = months.indexOf(listItem.get_item('LI_MonthHired'));
      var Month_DateHired = Month + 1;
      var Day_DateHired = "1";
      var Year_Hired = listItem.get_item('LI_YearHired');
      var DateHired = Month_DateHired+"/"+Day_DateHired+"/"+Year_Hired;

      var Array_Date_Today = DateHired.split("/");

      var DateFormat_DateToday_3Months = new Date(Array_Date_Today[2], Array_Date_Today[0] - 1, Array_Date_Today[1]);
      DateFormat_DateToday_3Months.setMonth(DateFormat_DateToday_3Months.getMonth() + 3);

      // console.log("DateFormat_DateToday_3Months : " +DateFormat_DateToday_3Months);
      // console.log("DateFormat_DateToday_6Months : " +DateFormat_DateToday_6Months);

      var date_today = mm+'/'+"01"+'/'+yyyy;
      // console.log("DateFormat_DateToday_3Months :"+ getFormattedDate(DateFormat_DateToday_3Months) +" -- "+ date_today);
      // console.log("DateFormat_DateToday_6Months :"+ getFormattedDate(DateFormat_DateToday_6Months) +" -- "+ date_today);
      //----------------------------------------------------------------------------------------------------------
      // console.log("---------------------------------------------------------------");

      if(getFormattedDate(DateFormat_DateToday_3Months) == date_today){
        Months3_Array_EmpID.push(EmpID);
        Months3_Array_Name.push(name);
        Months3_Array_Department.push(Dept);
        Months3_Arrray_DateHired.push(Date_ActualDateHired);
      }

    }


        for (var i = 0; i<=Months3_Array_EmpID.length-1; i++){
        $("#UL_Tenure_3Months").append(
          "<li class='collection-item'>"+
          "<div class = 'row'>"+
          "<div class = 'col s1'>"+Months3_Array_EmpID[i]+"</div>"+
          "<div class = 'col s5'>"+Months3_Array_Name[i]+"</div>"+
          "<div class = 'col s3'>"+Months3_Array_Department[i]+"</div>"+
                    "<div class = 'col s3'><span class='blue-text'>Date Hired : </span>"+"<span style='font-weight: bold'>"+Months3_Arrray_DateHired[i]+"</span>"+"</div>"+
          "</div>"+
          "</li>" 
        );
      }  

      document.getElementById("Badge_Tenure_3Months").innerHTML = Months3_Array_EmpID.length;

}

var Get_Employee_Tenure_Items_6Months;

function Get_Employee_Tenure_6Months() {

    var months = [ "January", "February", "March", "April", "May", "June",
    "July", "August", "September", "October", "November", "December" ];

    var CurrentMonth = (new Date()).getMonth()+1;

    var today = new Date();
    var dd = 1;
    var mm = today.getMonth()+1; //January is 0!

    var yyyy = today.getFullYear();
    if(dd<10){
        dd='0'+dd;
    } 
    if(mm<10){
        mm='0'+mm;
    } 
    var today = yyyy+'/'+mm+'/'+dd; 

    Date_Today_Minus6Months = new Date(today);
    Date_Today_Minus6Months.setMonth(Date_Today_Minus6Months.getMonth() -5);
    var Month_6Months = Date_Today_Minus6Months.getMonth();
    Month_6Months = months[Month_6Months]
    // console.log(Month_6Months);

//-----------------------------------------------------------------------------------
    var clientContext = new SP.ClientContext('https://intranet.houseofit.com.au/');
    var oList_Department = clientContext.get_web().get_lists().getByTitle('Employee Profile');
    var camlQuery = new SP.CamlQuery();
    camlQuery.set_viewXml('<View>'+
      '<Query>'+
      '<Where>'+
      '<And>'+
      '<Eq>'+
      '<FieldRef Name=\'LI_MonthHired\'/>' + 
      '<Value Type=\'Text\'>'+Month_6Months+'</Value>'+
      '</Eq>'+ 
      '<And>'+
        '<Eq>'+
        '<FieldRef Name=\'LI_Separated\'/>' + 
        '<Value Type=\'Text\'>'+"Active"+'</Value>'+
        '</Eq>'+      
        '<Eq>'+
        '<FieldRef Name=\'LI_EmployeeStatus\'/>' + 
        '<Value Type=\'Text\'>'+"Employee"+'</Value>'+
        '</Eq>'+ 
        '</And>'+
        '</And>'+
        '</Where>'+
        '</Query>'+
        '<RowLimit>'+
        '</RowLimit>'+
        '</View>');
    this.Get_Employee_Tenure_Items_6Months = oList_Department.getItems(camlQuery);
    clientContext.load(Get_Employee_Tenure_Items_6Months);
    clientContext.executeQueryAsync(Function.createDelegate(this, this.Get_Employee_Tenure_6Months_Succeeded), Function.createDelegate(this, this.onQueryFailed));    
}
function Get_Employee_Tenure_6Months_Succeeded() {
    var listItemsCollection = Get_Employee_Tenure_Items_6Months.getEnumerator();

    var months = [ "January", "February", "March", "April", "May", "June",
    "July", "August", "September", "October", "November", "December" ];


    var CurrentYear = (new Date()).getFullYear();

    var today = new Date();
    var dd = today.getDate();
    var mm = today.getMonth()+1; //January is 0!

    var yyyy = today.getFullYear();
    if(dd<10){
        dd='0'+dd;
    } 
    if(mm<10){
        mm='0'+mm;
    } 
    var today = mm+'/'+dd+'/'+yyyy; 

    var Months6_Array_EmpID = [];
    var Months6_Array_Name = [];
    var Months6_Array_Department = [];
    var Months6_Arrray_DateHired = [];

    while (listItemsCollection.moveNext()) {
      var listItem = listItemsCollection.get_current();

        var suffix = listItem.get_item('LI_Suffix')
        if(suffix == null){suffix = ""}

      var EmpID = listItem.get_item('LI_EmployeeID');
      var name = listItem.get_item('LI_FirstName') + " " + listItem.get_item('LI_MiddleName') + " " + listItem.get_item('LI_LastName') + " " + suffix;
      var Dept =  listItem.get_item('LI_Department');
      var Date_ActualDateHired = listItem.get_item('LI_DateHired');
      //----------------------------------------------------------------------------------------------------------

      var Month = months.indexOf(listItem.get_item('LI_MonthHired'));
      var Month_DateHired = Month + 1;
      var Day_DateHired = "1";
      var Year_Hired = listItem.get_item('LI_YearHired');
      var DateHired = Month_DateHired+"/"+Day_DateHired+"/"+Year_Hired;

      var Array_Date_Today = DateHired.split("/");
      var Date_Regularization

      var DateFormat_DateToday_6Months = new Date(Array_Date_Today[2], Array_Date_Today[0] - 1, Array_Date_Today[1]);
      DateFormat_DateToday_6Months.setMonth(DateFormat_DateToday_6Months.getMonth() + 5);


      // console.log("DateFormat_DateToday_3Months : " +DateFormat_DateToday_3Months);
      // console.log("DateFormat_DateToday_6Months : " +DateFormat_DateToday_6Months);

      var date_today = mm+'/'+"01"+'/'+yyyy;
      // console.log("DateFormat_DateToday_3Months :"+ getFormattedDate(DateFormat_DateToday_3Months) +" -- "+ date_today);
      // console.log("DateFormat_DateToday_6Months :"+ getFormattedDate(DateFormat_DateToday_6Months) +" -- "+ date_today);
      //----------------------------------------------------------------------------------------------------------
      // console.log("---------------------------------------------------------------");

      if(getFormattedDate(DateFormat_DateToday_6Months) == date_today){
        Months6_Array_EmpID.push(EmpID);
        Months6_Array_Name.push(name);
        Months6_Array_Department.push(Dept);
        Months6_Arrray_DateHired.push(Date_ActualDateHired);
      }

    }

        for (var i = 0; i<=Months6_Array_EmpID.length-1; i++){
        $("#UL_Tenure_6Months").append(
          "<li class='collection-item'>"+
          "<div class = 'row'>"+
          "<div class = 'col s1'>"+Months6_Array_EmpID[i]+"</div>"+
          "<div class = 'col s5'>"+Months6_Array_Name[i]+"</div>"+
          "<div class = 'col s3'>"+Months6_Array_Department[i]+"</div>"+
          "<div class = 'col s3'><span class='blue-text'>Date Hired : </span>"+"<span style='font-weight: bold'>"+Months6_Arrray_DateHired[i]+"</span>"+"</div>"+
          "</div>"+
          "</li>" 
        );
      }  

      document.getElementById("Badge_Tenure_6Months").innerHTML = Months6_Array_EmpID.length;

}

var Get_Employee_Tenure_Items_Anniversary;

function Get_Employee_Tenure_Anniversary() {


    var months = [ "January", "February", "March", "April", "May", "June",
    "July", "August", "September", "October", "November", "December" ];
    var today = new Date();
    var current_month = today.getMonth();
    current_month = months[current_month];
//------------------------------------------------------------------------

    var clientContext = new SP.ClientContext('https://intranet.houseofit.com.au/');
    var oList_Department = clientContext.get_web().get_lists().getByTitle('Employee Profile');
    var camlQuery = new SP.CamlQuery();
    camlQuery.set_viewXml('<View>'+
      '<Query>'+
      '<Where>'+
      '<And>'+
      '<Eq>'+
      '<FieldRef Name=\'LI_MonthHired\'/>' + 
      '<Value Type=\'Text\'>'+current_month+'</Value>'+
      '</Eq>'+ 
      '<And>'+
        '<Eq>'+
        '<FieldRef Name=\'LI_Separated\'/>' + 
        '<Value Type=\'Text\'>'+"Active"+'</Value>'+
        '</Eq>'+      
        '<Eq>'+
        '<FieldRef Name=\'LI_EmployeeStatus\'/>' + 
        '<Value Type=\'Text\'>'+"Employee"+'</Value>'+
        '</Eq>'+ 
        '</And>'+
        '</And>'+
        '</Where>'+
        '</Query>'+
        '<RowLimit>'+
        '</RowLimit>'+
        '</View>');
    this.Get_Employee_Tenure_Items_Anniversary = oList_Department.getItems(camlQuery);
    clientContext.load(Get_Employee_Tenure_Items_Anniversary);
    clientContext.executeQueryAsync(Function.createDelegate(this, this.Get_Employee_Tenure_Anniversary_Succeeded), Function.createDelegate(this, this.onQueryFailed));    
}
function Get_Employee_Tenure_Anniversary_Succeeded() {
    var listItemsCollection = Get_Employee_Tenure_Items_Anniversary.getEnumerator();

    var months = [ "January", "February", "March", "April", "May", "June",
    "July", "August", "September", "October", "November", "December" ];

    var CurrentYear = (new Date()).getFullYear();

    var today = new Date();
    var dd = today.getDate();
    var mm = today.getMonth()+1; //January is 0!

    var yyyy = today.getFullYear();
    if(dd<10){
        dd='0'+dd;
    } 
    if(mm<10){
        mm='0'+mm;
    } 
    var today = mm+'/'+dd+'/'+yyyy; 

    var Anniversary_Array_EmpID = [];
    var Anniversary_Array_Name = [];
    var Anniversary_Array_Department = [];
    var Anniversary_Arrray_DateHired = [];
    var Anniversary_Arrray_Years = [];

    while (listItemsCollection.moveNext()) {
      var listItem = listItemsCollection.get_current();

        var suffix = listItem.get_item('LI_Suffix')
        if(suffix == null){suffix = ""}

      var EmpID = listItem.get_item('LI_EmployeeID');
      var name = listItem.get_item('LI_FirstName') + " " + listItem.get_item('LI_MiddleName') + " " + listItem.get_item('LI_LastName') + " " + suffix;
      var Dept =  listItem.get_item('LI_Department');
      var Date_ActualDateHired = listItem.get_item('LI_DateHired');
      var YearHired = listItem.get_item('LI_YearHired');
      //----------------------------------------------------------------------------------------------------------
        if(YearHired != yyyy){
          Anniversary_Array_EmpID.push(EmpID);
          Anniversary_Array_Name.push(name);
          Anniversary_Array_Department.push(Dept);
          Anniversary_Arrray_DateHired.push(Date_ActualDateHired);

          var years = parseInt(yyyy) - parseInt(YearHired);

          Anniversary_Arrray_Years.push(years);
        }
    }

        for (var i = 0; i<=Anniversary_Array_EmpID.length-1; i++){
        $("#UL_Tenure_Anniversary").append(
          "<li class='collection-item'>"+
          "<div class = 'row'>"+
          "<div class = 'col s1'>"+Anniversary_Array_EmpID[i]+"</div>"+
          "<div class = 'col s4'>"+Anniversary_Array_Name[i]+"</div>"+
          "<div class = 'col s3'>"+Anniversary_Array_Department[i]+"</div>"+
          "<div class = 'col s3'><span class='blue-text'>Date Hired : </span>"+"<span style='font-weight: bold'>"+Anniversary_Arrray_DateHired[i]+"</span>"+"</div>"+
          "<div class = 'col s1'><span class='green-text'>Year(s) : </span>"+Anniversary_Arrray_Years[i]+"</div>"+
          "</div>"+
          "</li>" 
        );
      }  

      document.getElementById("Badge_Tenure_Anniversary").innerHTML = Anniversary_Array_EmpID.length;

}


  // FILTER ACTIVITIES TABLE
  var TableFilter_EmployeesTable = (function(Arr) {

    var _input;

    function _onInputEvent(e) {
      _input = e.target;
      var tables = document.getElementsByClassName(_input.getAttribute('data-table'));
      Arr.forEach.call(tables, function(table) {
        Arr.forEach.call(table.tBodies, function(tbody) {
          Arr.forEach.call(tbody.rows, _filter);
        });
      });
    }

    function _filter(row) {
      var text = row.textContent.toLowerCase(), val = _input.value.toLowerCase();
      row.style.display = text.indexOf(val) === -1 ? 'none' : 'table-row';
    }

    return {
      init: function() {
        var inputs = document.getElementsByClassName('employees-table-filter');
        Arr.forEach.call(inputs, function(input) {
          input.oninput = _onInputEvent;
        });
      }
    };
  })(Array.prototype);
//-----------------------------------------------------------------------------------------------------------------------------------


var Department_List_Items;
var Selected_Department_Name = "";
function Get_Departments(){
  context = SP.ClientContext.get_current();
  var Departments = context.get_web().get_lists().getByTitle("Department");
  var camlQuery_Department = SP.CamlQuery.createAllItemsQuery();
  this.Department_List_Items = Departments.getItems(camlQuery_Department);

  context.load(Department_List_Items);
  context.executeQueryAsync(Get_Departments_Succeeded, onQueryFailed);
}
function Get_Departments_Succeeded(){

    var listItemsCollection = Department_List_Items.getEnumerator();

    while (listItemsCollection.moveNext()) {
      var listItem = listItemsCollection.get_current();

      $("#Menu_Departments").append(
        "<div class='item' data-value='"+listItem.get_item('Title')+"'>"+listItem.get_item('Title')+"</div>"
      );

      $("#Menu_Departments_InfractionEntries").append(
        "<div class='item' data-value='"+listItem.get_item('Title')+"'>"+listItem.get_item('Title')+"</div>"
      );

    }

}

var Section_List_Items;
var Selected_Section_Name = "";
function Get_Sections(){
  context = SP.ClientContext.get_current();
  var Section = context.get_web().get_lists().getByTitle("Section");
  var camlQuery_Department = SP.CamlQuery.createAllItemsQuery();
  this.Section_List_Items = Section.getItems(camlQuery_Department);

  context.load(Section_List_Items);
  context.executeQueryAsync(Get_Sections_Succeeded, onQueryFailed);
}
function Get_Sections_Succeeded(){

    var listItemsCollection = Section_List_Items.getEnumerator();

    while (listItemsCollection.moveNext()) {
      var listItem = listItemsCollection.get_current();

      $("#Menu_Section").append(
        "<div class='item' data-value='"+listItem.get_item('Title')+"'>"+listItem.get_item('Title')+"</div>"
      );
    }

}

function Reload_All_Employees(){

  $('.ui.fluid.search.selection.dropdown.DEPARTMENT_FILTER.col.s9').dropdown('restore defaults');
  $('.ui.fluid.search.selection.dropdown.SECTION_FILTER.col.s12').dropdown('restore defaults');
  ExecuteOrDelayUntilScriptLoaded(retrieveListItems, "sp.js");
    swal({
    type: 'success',
    title: 'Employee profile has been Loaded',
    showConfirmButton: false,
    timer: 2000
  });

}

//-----------------------------------------------------------------------------------------------------------------------------------

function Open_Infraction_Form() {
    $('.ui.modal.tiny.INFRACTION_FORM')
      .modal({
        closable  : false,
        centered: false
      })
      .modal('show');
}

function Close_Infraction_Form() {
  $('.ui.modal.tiny.INFRACTION_FORM').modal('hide');

  $('.ui.selection.dropdown.DP_VIOLATION.col.s12').dropdown('restore defaults');
  $('.ui.selection.dropdown.DP_BREACH.col.s12').dropdown('restore defaults');
  $('.ui.selection.dropdown.DP_SANCTION.col.s12').dropdown('restore defaults');
  document.getElementById("TB_Infraction_Points").value = "";
  document.getElementById("TB_IncidentReportNumber").value = "";

}


//-----------------------------------------------------------------------------------------------------------------------------------
// OPEN MODAL TENURE
function Open_EmployeeTenure_Modal() {

    $('.ui.modal.large.TENURE_LIST')
      .modal({
        closable  : true,
        centered: false
      })
      .modal('show');
}
//-----------------------------------------------------------------------------------------------------------------------------------
// OPEN MODAL CHARTS
function Open_Charts_Modal() {
    $('.ui.modal.large.CHARTS')
      .modal({
        closable  : true,
        centered: false
      })
      .modal('show');
}
//-----------------------------------------------------------------------------------------------------------------------------------
// OPEN MODAL NOTIFICATIONS
function Open_Charts_Notifications() {
    $('.ui.modal.large.NOTIFICATIONS')
      .modal({
        closable  : true,
        centered: false
      })
      .modal('show');
}
//-----------------------------------------------------------------------------------------------------------------------------------

// OPEN MODAL INFRACTION ENTRIES
function Open_InfractionEntries_Modal() {
    $('.ui.modal.fullscreen.INFRACTION_ENTRIES')
      .modal({
        closable  : false,
        centered: false
      })
      .modal('show');
}

function Close_InfractionEntries_Modal() {
    $('.ui.modal.fullscreen.INFRACTION_ENTRIES').modal('hide');
}

//-----------------------------------------------------------------------------------------------------------------------------------



//-----------------------------------------------------------------------------------------------------------------------------------



//-----------------------------------------------------------------------------------------------------------------------------------


//-----------------------------------------------------------------------------------------------------------------------------------
 </script>

<body>

<main>



<!--   <div class="row card-panel z-depth-2">
      <div class="input-field col s2">
        <select id="DP_Department">
          <option value="" disabled selected>Department</option>
          <option value="Select Allt">Select All</option>
        </select>
      </div>
      <div class="input-field col s2">
        <select id="DP_Section">
          <option value="" disabled selected>Section</option>
          <option value="Select All">Select All</option>
        </select>
      </div>
      <div class="input-field col s2">
        <select id="DP_ImmediateHead">
          <option value="" disabled selected>Immediate Head</option>
          <option value="Select All">Select All</option>
        </select>
      </div> 
      <div class="input-field col s2">
        <select id="DP_DepartmentHead">
          <option value="None" disabled selected>Department Head</option>
          <option value="Select All">Select All</option>
        </select>
      </div> 
      <div class="input-field col s2">
          <input id="TB_SearchID" type="text">
          <label for="TB_SearchID">Employee ID</label>
      </div> 
      <div class="col s1">
        <a class="waves-effect waves-light btn-flat btn-large"><i class="large material-icons">clear</i></a>
      </div> 
  </div> -->

<div class="row">
    <div class="col s12">

        <div class=" col s2">


        <div class="switch">
          <label class="blue-text-text">
            Separated
            <input id="Switch_Filter" type="checkbox">
            <span class="lever blue-text-text"></span>
            Active
          </label>
        </div>   
        </div>


        <div class=" col s2">
        <div class="switch">
          <label class="blue-text-text">
            Employee
            <input id="Switch_FilterEmployeeTrainee" type="checkbox">
            <span class="lever blue-text-text"></span>
            Trainee
          </label>
        </div>   
        </div>



<!--       <div class=" col s1">
        <a class='dropdown-button btn-large btn-floating btn-flat light-blue lighten-5 AlignButtonRight' href='#' data-activates='DropdownChoices'><i class="large material-icons icon-blue">settings</i></a>

      </div>

      <div class="col s1">
         <a class="dropdown-button btn-large btn-floating btn-flat light-blue lighten-5 AlignButtonRight tooltipped" onclick="OpenEmployeeTenureModal()" id="ViewInfractions" data-position="bottom" data-delay="40" data-tooltip="Show Employee Tenure List" id="ViewInfractionsTrigger"><i class="large material-icons icon-blue">date_range</i></a>
      </div>

      <div class="col s1">
         <a class="dropdown-button btn-large btn-floating btn-flat light-blue lighten-5 AlignButtonRight tooltipped" onclick="OpenEntryInfraction_Modal_Entries()" id="ViewInfractions" data-position="bottom" data-delay="40" data-tooltip="Show Infraction Entries" id="ViewInfractionsTrigger"><i class="large material-icons icon-blue">assignment_late</i></a>
      </div>

      <div class="col s1">
         <a class="dropdown-button btn-large btn-floating btn-flat light-blue lighten-5 AlignButtonRight tooltipped modal-trigger" id="ViewNotifications" data-position="bottom" data-delay="40" data-tooltip="Show Notification" id="ViewNotificationsTrigger" href="#ModalNotifications"><i class="large material-icons icon-blue">notifications</i></a>
      </div>

      <div class="col s1">
         <a class="btn-large btn btn-floating btn-flat light-blue lighten-5 AlignButtonRight light-blue hoverable tooltipped" data-position="bottom" data-delay="40" data-tooltip="Download Excel" id="ShowExcel" onclick="ClickShowExcel()"><i class="large material-icons icon-blue">file_download</i></a>
      </div>      

      <div class="col s1">
         <a class="btn-large btn btn-floating btn-flat light-blue lighten-5 light-blue hoverable AlignButtonRight tooltipped modal-trigger" data-position="bottom" data-delay="40" data-tooltip="Show Charts" id="ViewChartsModalTrigger" href="#ModalCharts"><i class="large material-icons icon-blue">equalizer</i></a>
      </div> -->

      <div class="col s8">

      <div class="ui labeled icon top right pointing dropdown primary button left AlignButtonRight">
        <i class="bars icon"></i>
        <span>Menu</span>
          <div class="menu">

            <div class="item">
              <i class="dropdown icon"></i>
              <span class="text">Manage Lists</span>
              <div class="menu">
                <div class="item">
                  <i class="cog icon"></i>
                  <a href="https://intranet.houseofit.com.au/Lists/Department/AllItems.aspx">Manage Departments</a>
                </div>
                <div class="item">
                  <i class="cog icon"></i>
                  <a href="https://intranet.houseofit.com.au/Lists/Section/AllItems.aspx">Manage Sections</a>
                </div>
                <div class="item">
                  <i class="cog icon"></i>
                  <a href="https://intranet.houseofit.com.au/Lists/Position/AllItems.aspx">Manage  Position Titles</a>
                </div>
                <div class="item">
                  <i class="cog icon"></i>
                  <a href="https://intranet.houseofit.com.au/Lists/Immediate%20Head%20List/AllItems.aspx">Manage Immediate Heads</a>
                </div>
                <div class="item">
                  <i class="cog icon"></i>
                  <a href="https://intranet.houseofit.com.au/Lists/Department%20Head%20List/AllItems.aspx">Manage Department Heads</a>
                </div>
              </div>
            </div>
            <div class="item" onclick="Open_EmployeeTenure_Modal()">
              <i class="calendar alternate icon"></i>
              Employee Tenure List
            </div>
            <div class="item" onclick="Open_InfractionEntries_Modal()">
              <i class="file alternate icon"></i>
              Infraction Entries
            </div>
            <div class="item" onclick="Open_Charts_Notifications()">
              <i class="bell icon"></i>
              Notifications
            </div>
            <div class="item" onclick="ClickShowExcel()">
              <i class="download icon"></i>
              Export as Excel File
            </div>
            <div class="item" onclick="Open_Charts_Modal()">
              <i class="chart bar outline icon"></i>
              Charts
            </div>
          </div>

      </div>


      </div>


    </div>
 </div> 


<div class="row"></div><div class="row"></div><div class="row"></div><div class="row"></div>

 <div class="card-panel z-depth-4 " id="Div_EmployeeContainer" >

<div class="row">
  <div class="col s8">
    <table>
                <tr >
                  <td width="100px">
                    <label class="grey-text text-darken-2" style="font-weight: 700">DEPARTMENT :</label>
                  </td>
                  <td style="padding-right: 45px !important"> 
                    <div class="ui fluid search selection dropdown DEPARTMENT_FILTER col s9" id="Div_Department" style="margin-left: 10px !important;">
                      <input type="hidden" id="Input_E_Department" >
                        <i class="dropdown icon"></i>
                        <div class="default text">Department</div>
                        <div class="menu" id="Menu_Departments"></div>
                     </div>
                  </td>
                  <td width="110px">
                    <label class="grey-text text-darken-2" style="font-weight: 700">SECTION / TEAM :</label>
                  </td>
                  <td style="padding-right: 45px !important"> 
                    <div class="ui fluid search selection dropdown SECTION_FILTER col s12" id="Div_Section" style="margin-left: 10px !important;">
                      <input type="hidden" id="Input_E_Section" >
                        <i class="dropdown icon"></i>
                        <div class="default text">Section or Team</div>
                        <div class="menu" id="Menu_Section"></div>
                     </div>
                  </td>
                  <td>
              <a class="ui compact primary labeled icon button  " name="btn_Edit_Turnover" id="BTN_LoadAll" onclick="Reload_All_Employees()">
                <i class="sync alternate icon"></i>
                Load All
              </a>
                  </td>
                </tr>
    </table>
  </div>
  <div class="col s4">
    <table>
      <tr>
        <td>
            <div class="ui search right col s12">
                <div class="ui icon input spancenter col s12">
                    <input class="prompt grey-text text-darken-2 employees-table-filter"   type="search2" placeholder="Search Here..." data-table="order-table-Employees" id="SEARCH_EMPLOYEE" >
                    <i class="search icon" style="margin-right: 10px !important"></i>
                </div>
            </div>
        </td>
      </tr>
    </table>
  </div>

</div>

    <div class="row" id="Div_Container" >
        <table id="table_employees" class="ui table order-table-Employees  striped celled">
        <thead align="middle">
              <th>EMPLOYEE ID</th>
              <th>NAME</th>
              <th>DEPARTMENT</th>
              <th>SECTION</th>
              <th>POSITION TITLE</th>
              <th></th>
        </thead>

        <tbody id="Tbody_Employees"></tbody>

      </table>
    </div>
       
      <div class="row">
 <div class="fixed-action-btn horizontal">
<!--     <a class="btn-floating btn-large waves-effect waves-light orange z-depth-1 btn-large hoverable" href="https://intranet.houseofit.com.au/Lists/Employee%20Profile/NewForm.aspx?Source=https%3A%2F%2Fintranet%2Ehouseofit%2Ecom%2Eau%2FLists%2FEmployee%2520Profile%2FAllItems%2Easpx%3FPageView%3DShared%26InitialTabId%3DRibbon%2EWebPartPage%26VisibilityContext%3DWSSWebPartPage&RootFolder=">
      <i class="large material-icons">person_add</i>
    </a> -->
    <a class="btn-floating btn-large waves-effect waves-light orange z-depth-1 btn-large hoverable" href="https://intranet.houseofit.com.au/SitePages/Employee%20Information.aspx">
      <i class="large material-icons">person_add</i>
    </a>
<!--     <a class="btn-floating btn-large waves-effect waves-light orange z-depth-1 btn-large hoverable">
      <i class="large material-icons">person_add</i>
    </a>   
    <ul>
      <li><a class="btn-floating green darken-1 tooltipped" data-position="top" data-delay="20" data-tooltip="New Employee" href="https://intranet.houseofit.com.au/SitePages/Employee%20Information.aspx"><i class="material-icons">person_add</i></a></li>
      <li><a class="btn-floating deep-orange darken-1 tooltipped" data-position="top" data-delay="20" data-tooltip="Existing Empployee"><i class="material-icons">person</i></a></li>
    </ul>   --> 
  </div>
  </div>

  </div>

</main>

  <!-- Modal Trigger -->
  <a id="ViewProfileModalTrigger" class="modal-trigger" href="#modal1"></a>



    </div>

  </div>

  <!-- Dropdown Structure -->
  <ul id='DropdownChoices' class='dropdown-content'>
    <li><a href="https://intranet.houseofit.com.au/Lists/Department/AllItems.aspx"><i class="material-icons">group</i>Manage Departments</a></li>
    <li><a href="https://intranet.houseofit.com.au/Lists/Section/AllItems.aspx"><i class="material-icons">group</i>Manage Sections</a></li>
    <li><a href="https://intranet.houseofit.com.au/Lists/Position/AllItems.aspx"><i class="material-icons">description</i>Manage  Position Titles</a></li>
    <li><a href="https://intranet.houseofit.com.au/Lists/Immediate%20Head%20List/AllItems.aspx"><i class="material-icons">person</i>Manage Immediate Heads</a></li>
    <li><a href="https://intranet.houseofit.com.au/Lists/Department%20Head%20List/AllItems.aspx"><i class="material-icons">person</i>Manage Department Heads</a></li>
  </ul>


  <ul id="Notification_Items" class="dropdown-content">
    <li disabled><a href="#!">one<span class="badge">1</span></a></li>
    <li><a href="#!">two<span class="new badge">1</span></a></li>
    <li><a href="#!">three</a></li>
  </ul>
            
       
<!-- -------------------------------------------------------------------------------------------------------------------- -->
<!-- MODAL TO SHOW INDIVIDUAL JOB CHART -->

 <a id="ViewJobChartTrigger" class="modal-trigger" href="#Modal_Individual_JobChart"></a>

<div id="Modal_Individual_JobChart" class="modal ModalTopDistance">
    <div id="ModalNotificationContent" class="modal-content">
      <div class="row">
    <a class="btn-floating red AlignButtonRight" onclick="CloseModalJobChart()"><i class=" material-icons">close</i></a>
    </div>
    <div class="row">
      <ul class="collection ">
        <li class="collection-item">
          <h5>Tranings</h5>
            <a id="Button_OpenTrainingForm" href="#" class="AlignButtonRight tooltipped" onclick="OpenTrainingForm_Clicked()" data-position="bottom" data-delay="40" data-tooltip="Add Training"><i class="medium material-icons icon-blue">note_add</i></a>       
          <table class="bordered responsive-table card-panel z-depth-2" id="Table_Trainings">
                  <thead>
                    <tr>
                        <th>Training</th>
                        <th>Duration</th>
                        <th>Type</th>
                        <th>Date</th>
                    </tr>
                  </thead>
                  <tbody id="TB_Trainings">
                </tbody>
              </table>  

        </li>

      <li class="collection-item">
        <h5>Position History</h5>
            <!-- <a href="#" data-activates="SideNav_PositionHistory" class="button-collapse AlignButtonRight"><i class="medium material-icons icon-blue">note_add</i></a> -->
            <a id="Button_OpenPoistionHistoryForm" href="#" class="AlignButtonRight tooltipped" onclick="OpenPositionHistoryForm_Clicked()" data-position="bottom" data-delay="40" data-tooltip="Add Position" ><i class="medium material-icons icon-blue">note_add</i></a>       
            <table class="bordered responsive-table card-panel z-depth-2" id="Table_PositionHistory">
              <thead>
                <tr >
                    <th>Position Title</th>
                    <th>Department</th>
                    <th>Date From</th>
                    <th>Date To</th>
                </tr>
              </thead>
              <tbody>       
              </tbody>
            </table>  
      </li>    
      </ul>
      </div>
    </div>
</div>

<!-- --------------------------------------------------------------------------------------------------------------------- -->
<!-- MODAL ADD/EDIT TRAINING -->
<div id="ModalTrainingForm" class="modal ModalTopDistance">
    <div id="ModalNotificationContent" class="modal-content">
      <div class="row">
        <a class="btn-floating red fix" onclick="CloseTrainingForm()"><i class=" material-icons">chevron_right</i></a>         
            <div class="row">
              <div class="col s4"></div>
            <div class="col s4">

                  <div class="card-panel z-depth-2">
                    <div class="input-field row ">
                        <input id="TB_TrainingName" type="text"  placeholder="">
                        <label for="TB_TrainingName">Training Name</label>
                    </div>   
                  <div class="input-field">
                      <select id="DP_TrainingType">
                        <option value="" disabled selected>Choose a Training Type</option>
                          <option value="Soft Skills">Soft Skills</option>
                          <option value="Technical Skills">Technical Skills</option>
                      </select>
                      <label>Training Type</label>
                  </div>                
                 <div>
                    <label for="Time_StartTime">Start Time</label>
                    <input id="Time_StartTime" type="text" class="timepicker">
                </div>
                <div>
                    <label for="Time_EndTime">End Time</label>
                    <input id="Time_EndTime" type="text" class="timepicker">
                </div>  
                    <div class="input-field">
                        <label>Date of Training</label>              
                        <input type = "text" class = "datepicker" id="Date_TrainingDate" placeholder="">    
                    </div>                  
                <div class="row">
                  <a id="Btn_SaveTraining" class="waves-effect waves-light btn light-blue darken-1  AlignButtonRight hoverable" onclick="ValidatSaveTraining()">Save</a>
                </div>                                                                              
                  </div>                
                </div>                
            </div>
      </div>
    </div>
</div>
<!-- --------------------------------------------------------------------------------------------------------------------- -->
<!-- MODAL ADD/EDIT POSITION HI -->
<div id="ModalPositionHistoryForm" class="modal ModalTopDistance">
    <div id="ModalNotificationContent" class="modal-content">
            <div class="row">

            <a class="btn-floating red" onclick="ClosePositionHistoryForm()"><i class=" material-icons">chevron_right</i></a>

            <div class="row">
            <div class="col s4"></div>          
            <div class="col s4">

                  <div class="card-panel z-depth-2">
                  <div class="input-field">
                      <select id="DP_Position_PosHistory" required>
                        <option value="" disabled selected>Choose a Position Title</option>
                      </select>
                      <label>Department <span>*</span></label>
                  </div>                      
                  <div class="input-field">
                      <select id="DP_Department_PosHistory" required>
                        <option value="" disabled selected>Choose a Department</option>
                      </select>
                      <label>Department <span>*</span></label>
                  </div>                  
                    <div class="input-field">
                        <label>Date of From</label>
                        <input type = "text" class = "datepicker" id="Date_PH_DateFrom" placeholder="">    
                    </div>    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
                <div class="row">
                  <a class="waves-effect waves-light btn light-blue darken-1 AlignButtonRight hoverable" onclick="ValidatePositionHistoryForm()">Save</a>
                </div>
                  </div>              
                </div>            
            </div>
            </div>
    </div>
</div>


<!-- --------------------------------------------------------------------------------------------------------------------- -->


<!-- ------------------------------------------------------------------------------------------------------------------- -->
  <!-- ROW ACTIONS CONTAINER -->

<div id="Div_Row_Action_Container">
  
</div>

<!-- ------------------------------------------------------------------------------------------------------------------- -->
<!-- MODAL VIEW PROFILE VIEW-SEMTANTIC-UI -->
<div class="ui modal large VIEW_PROFILE">
    
    <div class="header">
      <h2 class="ui header">
        <i class="user circle icon"></i>
        <div class="content">
          <span id="VIEW_EMPOYEENAME">
            
          </span>
          <div class="sub header" id="VIEW_ID">268</div>
        </div>
      </h2>
    </div>
<div class="content">

<ul class="collection with-header ">

        <li class="collection-item">

<div class="ui raised segment">
<span class="ui blue ribbon label">EMPLOYMENT</span>
  <div class="row"></div><div class="row"></div><div class="row"></div>
        <div class='row'>
      <div class="col s6">

          <div class="row">
            <div class="col s4">
                <label class="grey-text text-darken-3">COMPANY :</label>
              </div>
              <div class="col s4">
                  <label class="grey-text text-darken-3" id="TB_Company" ></label>
                </div>
              </div>
              <div class="row">
                <div class="col s4">
                <label class="grey-text text-darken-3">DEPARTMENT :</label>
              </div>
              <div class="col s4">
                  <label class="grey-text text-darken-3" id="TB_Department" ></label>
                </div>
              </div>
        <div class="row">
          <div class="col s4">
                  <label class="grey-text text-darken-3">SECTION :</label>
                </div>
                <div class="col s4">
                  <label class="grey-text text-darken-3" id="TB_Section" ></label>
                </div>
              </div>
              <div class="row">
          <div class="col s4">
                  <label class="grey-text text-darken-3">JOB LEVEL :</label>
                </div>
                <div class="col s4">
                  <label class="grey-text text-darken-3" id="TB_JobLevel" ></label>
                </div>
              </div>
            <div class="row">
          <div class="col s4">
                  <label class="grey-text text-darken-3">POSITION TITLE :</label>
                </div>
                <div class="col s4">
                  <label class="grey-text text-darken-3" id="TB_PositionTitle" ></label>
                </div>
              </div>
              <div class="row">
          <div class="col s4">
                  <label class="grey-text text-darken-3">EMPLOYEE TYPE :</label>
                </div>
                <div class="col s4">
                  <label class="grey-text text-darken-3" id="TB_EmployeeType" ></label>
                </div>
              </div>
              <div class="row">
          <div class="col s4">
                  <label class="grey-text text-darken-3">EMPLOYEE STATUS :</label>
                </div>
                <div class="col s4">
                  <label class="grey-text text-darken-3" id="TB_EmployeeStatus" ></label>
                </div>
              </div>
    </div>
    <div class="col s6">
            <div class="row">
          <div class="col s4">
                  <label class="grey-text text-darken-3">DATE JOINED :</label>
                </div>
                <div class="col s4">
                  <label class="grey-text text-darken-3" id="TB_DateJoined" ></label>
                </div>
              </div>        
            <div class="row">
          <div class="col s4">
                  <label class="grey-text text-darken-3">DATE HIRED :</label>
                </div>
                <div class="col s4">
                  <label class="grey-text text-darken-3" id="TB_DateHired" ></label>
                </div>
              </div>
            <div class="row">
          <div class="col s4">
                  <label class="grey-text text-darken-3">JOB GRADE :</label>
                </div>
                <div class="col s4">
                  <label class="grey-text text-darken-3" id="TB_JobGrade" ></label>
                </div>
              </div>
            <div class="row">
          <div class="col s4">
                  <label class="grey-text text-darken-3">IMMEDIATE HEAD :</label>
                </div>
                <div class="col s4">
                  <label class="grey-text text-darken-3" id="TB_ImmediateHead" ></label>
                </div>
              </div>
            <div class="row">
          <div class="col s4">
                  <label class="grey-text text-darken-3">DEPARTMENT HEAD :</label>
                </div>
                <div class="col s4">
                  <label class="grey-text text-darken-3" id="TB_DepartmentHead" ></label>
                </div>
              </div>    
              <div class="row">
          <div class="col s4">
                  <label class="grey-text text-darken-3">REGULARIZATION DATE : :</label>
                </div>
                <div class="col s4">
                  <label class="grey-text text-darken-3" id="TB_RegularizationDate" ></label>
                </div>
              </div>                      
      </div>
      </div>

</div>

      </li>

      <li class="collection-item">

<div class="ui raised segment">
<span class="ui orange ribbon label">GOVERNMENT NUMBERS</span>
<div class="row"></div>
      <div class="row">                       
          <div class="input-field col s3">
              <input id="TB_TIN" disabled type="text" placeholder="">
              <label for="TB_TIN">TIN</label>
          </div>
          <div class="input-field col s3">
              <input id="TB_SSS" disabled type="text" placeholder="">
              <label for="TB_SSS">SSS</label>
          </div>
          <div class="input-field col s3">
              <input id="TB_PHILHEALTH" disabled type="text" placeholder="">
              <label for="TB_PHILHEALTH">PHIL-HEALTH</label>
          </div>
          <div class="input-field col s3">
              <input id="TB_PAGIBIG" disabled type="text" placeholder="">
              <label for="TB_PAGIBIG">PAG-IBIG</label>
          </div>
      </div>
</div>

      </li>

<li class="collection-item">

<div class="ui raised segment">
<span class="ui teal ribbon label">PERSONAL</span>
        <div class='row'>
      <div class="col s6">
        <div class="row">
          <div class="col s4">
                  <label class="grey-text text-darken-3">CONTACT NUMBER :</label>
                </div>
                <div class="col s4">
                  <label class="grey-text text-darken-3" id="TB_ContactNumber" ></label>
                </div>
              </div>
        <div class="row">
          <div class="col s4">
                  <label class="grey-text text-darken-3">CURRENT ADDRESS :</label>
                </div>
                <div class="col s5">
                  <label class="grey-text text-darken-3" id="TB_CurrentAddress" ></label>
                </div>
              </div>
        <div class="row">
          <div class="col s4">
                  <label class="grey-text text-darken-3">SEX :</label>
                </div>
                <div class="col s4">
                  <label class="grey-text text-darken-3" id="TB_Sex" ></label>
                </div>
              </div>   
        <div class="row">
          <div class="col s4">
                  <label class="grey-text text-darken-3">BIRTH DATE :</label>
                </div>
                <div class="col s4">
                  <label class="grey-text text-darken-3" id="TB_BirthDate" ></label>
                </div>
              </div>  
        <div class="row">
          <div class="col s4">
                  <label class="grey-text text-darken-3">CIVIL STATUS :</label>
                </div>
                <div class="col s4">
                  <label class="grey-text text-darken-3" id="TB_CivilStatus" ></label>
                </div>
              </div>     
        <div class="row">
          <div class="col s4">
                  <label class="grey-text text-darken-3">EMGCY CONT NUMBER :</label>
                </div>
                <div class="col s4">
                  <label class="grey-text text-darken-3" id="TB_EmgergencyContactNumber" ></label>
                </div>
              </div>   
        </div>  
        <div class="col s6">  
        <div class="row">
          <div class="col s4">
                  <label class="grey-text text-darken-3">EMGCY CONT PERSON :</label>
                </div>
                <div class="col s4">
                  <label class="grey-text text-darken-3" id="TB_EmergencyContactPerson" ></label>
                </div>
              </div>  
        <div class="row">
          <div class="col s4">
                  <label class="grey-text text-darken-3">PROVINCIAL ADDRESS :</label>
                </div>
                <div class="col s4">
                  <label class="grey-text text-darken-3" id="TB_ProvincialAddress" ></label>
                </div>
              </div>  

        <div class="row">
          <div class="col s4">
                  <label class="grey-text text-darken-3">RELIGION :</label>
                </div>
                <div class="col s4">
                  <label class="grey-text text-darken-3" id="TB_Religion" ></label>
                </div>
              </div>   
        <div class="row">
          <div class="col s4">
                  <label class="grey-text text-darken-3">BIRTH PLACE :</label>
                </div>
                <div class="col s4">
                  <label class="grey-text text-darken-3" id="TB_BirthPlace" ></label>
                </div>
              </div>  
        <div class="row">
          <div class="col s4">
                  <label class="grey-text text-darken-3">PERSONAL EMAIL :</label>
                </div>
                <div class="col s4">
                  <label class="grey-text text-darken-3" id="TB_PersonalEmail" ></label>
                </div>
              </div>  
      </div>
      </div>
</div>

</li>

    </ul>

</div>

</div>


<!-- ------------------------------------------------------------------------------------------------------------------- -->
<!-- INFRACTION FORM SEMANTIC-UI -->
<div class="ui modal tiny INFRACTION_FORM">
    
    <div class="header">
      INFRACTION
    </div>
    <div class="content">
      <div class="row">
        
              <table class="celled">
                <tr >
                  <td width="110px">
                    <label class="grey-text text-darken-2" style="font-weight: 700">EMPLOYEE ID :</label>
                  </td>
                  <td>
                    <div class="ui input col s12" >
                      <input type="text2" placeholder="Enter Description or Task" id="TB_Infractions_EmpID" readonly class="grey lighten-3">
                    </div>
                  </td>
                </tr>
                <tr >
                  <td width="110px">
                    <label class="grey-text text-darken-2" style="font-weight: 700">NAME :</label>
                  </td>
                  <td>
                    <div class="ui input col s12" >
                      <input type="text2" placeholder="Enter File Location/Path/URL" id="TB_Infraction_Employee" readonly class="grey lighten-3">
                    </div>
                  </td>
                </tr>
                <tr >
                  <td width="110px">
                    <label class="grey-text text-darken-2" style="font-weight: 700">DEPARTMENT :</label>
                  </td>
                  <td>
                    <div class="ui input col s12" >
                      <input type="text2" placeholder="Enter Description or Task" id="TB_Infraction_Department" readonly class="grey lighten-3">
                    </div>
                  </td>
                </tr>
                <tr >
                  <td width="110px">
                    <label class="grey-text text-darken-2" style="font-weight: 700">SECTION :</label>
                  </td>
                  <td>
                    <div class="ui input col s12" >
                      <input type="text2" placeholder="Section/Team" id="TB_Infraction_Section" readonly class="grey lighten-3">
                    </div>
                  </td>
                </tr>
                <tr >
                  <td width="110px">
                    <label class="grey-text text-darken-2" style="font-weight: 700">MEMO NUMBER :</label>
                  </td>
                  <td>
                    <div class="ui input col s12" >
                      <input type="text2" placeholder="Memo Number" id="TB_IncidentReportNumber">
                    </div>
                  </td>
                </tr>
                <tr >
                  <td width="100px">
                    <label class="grey-text text-darken-2" style="font-weight: 700">VIOLATION :</label>
                  </td>
                  <td>
                    <div class="ui input col s12">
                      <div class="ui selection dropdown DP_VIOLATION col s12" id="Div_DP_Infraction_Violation">
                        <input type="hidden" name="Status" id="DP_Infraction_Violation">
                        <i class="dropdown icon"></i>
                        <div class="default text">Select Violation</div>
                        <div class="menu">
                          <div class="item" data-value="Against Maintenance of Health and Safety and Sanitation">Against Maintenance of Health and Safety and Sanitation</div>
                          <div class="item" data-value="Against Company Property, Equipment, Facilities and Security">Against Company Property, Equipment, Facilities and Security</div>
                          <div class="item" data-value="Against Proper Conduct, Decorum, Persons and Public Morals">Against Proper Conduct, Decorum, Persons and Public Morals</div>
                          <div class="item" data-value="Against Enhancement of Company Productivity">Against Enhancement of Company Productivity</div>
                          <div class="item" data-value="Against Practice of Customer Excellence">Against Practice of Customer Excellence</div>
                          <div class="item" data-value="Attendance and Punctuality Policy">Attendance and Punctuality Policy</div>
                        </div>
                      </div>
                    </div>
                  </td>
                </tr>
                <tr >
                  <td width="100px">
                    <label class="grey-text text-darken-2" style="font-weight: 700">BREACH :</label>
                  </td>
                  <td>
                    <div class="ui input col s12">
                      <div class="ui selection dropdown DP_BREACH col s12" id="Div_DP_Infraction_Breach">
                        <input type="hidden" name="Status" id="DP_Infraction_Breach">
                        <i class="dropdown icon"></i>
                        <div class="default text">Select Breach</div>
                        <div class="menu">
                          <div class="item" data-value="Minor Breach">Minor Breach</div>
                          <div class="item" data-value="Major Breach">Major Breach</div>
                          <div class="item" data-value="Serious Breach">Serious Breach</div>
                          <div class="item" data-value="Extreme Breach">Extreme Breach</div>
                        </div>
                      </div>
                    </div>
                  </td>
                </tr>
                <tr >
                  <td width="100px">
                    <label class="grey-text text-darken-2" style="font-weight: 700">SANCTION TYPE :</label>
                  </td>
                  <td>
                    <div class="ui input col s12">
                      <div class="ui selection dropdown DP_SANCTION col s12" id="Div_DP_Infraction_TypeOfSanction">
                        <input type="hidden" name="Status" id="DP_Infraction_TypeOfSanction">
                        <i class="dropdown icon"></i>
                        <div class="default text">Select Type of Sanction</div>
                        <div class="menu">
                          <div class="item" data-value="Verbal Warning">Verbal Warning</div>
                          <div class="item" data-value="Written Warning">Written Warning</div>
                          <div class="item" data-value="Final Warning">Final Warning</div>
                          <div class="item" data-value="1 Day Suspension">1 Day Suspension</div>
                          <div class="item" data-value="3 Days Suspension">3 Days Suspension</div>
                          <div class="item" data-value="5 Days Suspension">5 Days Suspension</div>
                        </div>
                      </div>
                    </div>
                  </td>
                </tr>
                <tr >
                  <td width="100px">
                    <label class="grey-text text-darken-2" style="font-weight: 700">DATE :</label>
                  </td>
                  <td>
                    <div class="ui input col s12" >             
                      <input type = "text2" class = "datepicker" placeholder="Select Date" id="TB_Infraction_EntryDate">  
                    </div>
                  </td>
                </tr>
                <tr >
                  <td width="120px">
                    <label class="grey-text text-darken-2" style="font-weight: 700">PRESCIPTIVE DATE :</label>
                  </td>
                  <td>
                    <div class="ui input col s12" >
                      <input type="text2" placeholder="Prescriptive Date" id="TB_PrescriptiveDate" readonly class="grey lighten-3">
                    </div>
                  </td>
                </tr>
                <tr >
                  <td width="110px">
                    <label class="grey-text text-darken-2" style="font-weight: 700">INFRACTION POINTS :</label>
                  </td>
                  <td>
                    <div class="ui input col s12" >
                      <input type="text2" placeholder="Infraction Points" id="TB_Infraction_Points" readonly class="grey lighten-3">
                    </div>
                  </td>
                </tr>
              </table>

      </div>
    </div>
    <div class="actions">
<!--     <div class="ui buttons">
      <a class="ui button" onclick="Cancel_Add_Documents_Clicked()">Cancel</a>
      <div class="or"></div>
      <a class="ui positive button" onclick="Append_To_Table_KeyDocuments()">OK</a>
    </div> -->

    <a class="ui button" onclick="Close_Infraction_Form()">
      Cancel
    </a>

    <a class="ui primary button" onclick="Validate_InfractionEntry_Form()">
      OK
    </a>

    </div>
</div>


<!-- ------------------------------------------------------------------------------------------------------------------- -->
 <!-- MODAL TENURE LIST SEMANTIC-UI -->
<div class="ui modal large TENURE_LIST">
    
    <div class="header">
      EMPLOYEE TENURE LIST
    </div>
    <div class="content">
      <div class="row">

    <h5 id="Month_Tenure" class="light-blue-text" style="font-weight: 800 !important;"></h5>

      <div class="card-panel row z-depth-2">
      <h6 class="light-blue-text" style="font-weight: bold;">3 MONTHS</h6>
      <div class="row">
        <span id="Badge_Tenure_3Months" class="new badge" style="font-size: 16px" ></span>
      </div>  
         <ul class="collection" id="UL_Tenure_3Months"></ul>
    </div>  

      <div class="card-panel row z-depth-2">
      <h6 class="light-blue-text" style="font-weight: bold;">5 MONTHS</h6>
      <div class="row">   
        <span id="Badge_Tenure_6Months" class="new badge" style="font-size: 16px" ></span>
      </div>
         <ul class="collection" id="UL_Tenure_6Months"></ul>
    </div>

      <div class="card-panel row z-depth-2">
      <h6 class="light-blue-text" style="font-weight: bold;">ANNIVERSARY</h6>
      <div class="row">
        <span id="Badge_Tenure_Anniversary" class="new badge" style="font-size: 16px" ></span>
      </div>  
         <ul class="collection" id="UL_Tenure_Anniversary"></ul>
    </div>


    </div>
    </div>

</div>

<!-- ------------------------------------------------------------------------------------------------------------------- -->

 <!--MODAL CHARTS SEMANTIC-UI -->
<div class="ui modal large CHARTS">
    
    <div class="header">
      CHARTS
    </div>
    <div class="content">
      <div class="row">

<!--      <div class="card-panel row ">
      <a class="waves-effect waves-light btn" onclick="GetHiredSucceeded_January()">button</a>
    </div> -->

      <div class="card-panel row z-depth-2">
      <canvas id="myChart" height="80"></canvas>
    </div>

      <div class="card-panel row z-depth-2">
      <canvas id="bar-chart" height="80"></canvas>
    </div>

<!--      <div class="card-panel row z-depth-2">
      <canvas id="line-chart" height="80"></canvas>
    </div> -->

    </div>
    </div>

</div>

<!-- ------------------------------------------------------------------------------------------------------------------- -->

 <!--MODAL CHARTS NOTIFICATIONS-->
<div class="ui modal large NOTIFICATIONS">
    
    <div class="header">
      NOTIFICATIONS
    </div>
    <div class="content">
	      <div class="row">
	    <div class="Row_Action">
	    	<h5 id="Mont_NewHires" class="light-blue-text" style="font-weight: 800 !important;font size: 24px  !important"></h5>
	    </div>

	      <div class="card-panel row z-depth-2">
	      <h6>New Hires</h6>
	      <div class="row">
	        <span id="Badge_NewHires" class="new badge" style="font-size: 16px" ></span>
	      </div>  
	         <ul class="collection" id="UL_NewHires"></ul>
	    </div>  

	      <div class="card-panel row z-depth-2">
	      <h6>For Regularization</h6>
	      <div class="row">   
	        <span id="Badge_ForRegularization" class="new badge" style="font-size: 16px" ></span>
	      </div>
	         <ul class="collection" id="UL_ForRegularization"></ul>
	    </div>

	      <div class="card-panel row z-depth-2">
	      <h6>Birthday Celebrants</h6>
	      <div class="row">
	        <span id="Badge_BirthdayCelebrants" class="new badge" style="font-size: 16px" ></span>
	      </div>  
	         <ul class="collection" id="UL_BirthdayCelebrants"></ul>
	    </div>

	    </div>
    </div>

</div>


<!-- ------------------------------------------------------------------------------------------------------------------- -->

 <!--MODAL INFRACTION ENTRIES SEMANTIC-UI -->
<div class="ui modal fullscreen INFRACTION_ENTRIES">
    
    <div class="header">
      INFRACTION ENTRIES

		<a class="ui icon red basic button right" onclick="Close_InfractionEntries_Modal()">
		  Close
		</a>

    </div>
    <div class="content">
      <div class="row">

    </div>
    <div class="row">
                      <div class="input-field col s2">

	                    <div class="ui input" >
	                      <div class="ui selection dropdown item_status col s12" style="margin-left: 10px !important;" >
	                        <input type="hidden" name="Status" id="DP_Infraction_Filter_Dept">
	                        <i class="dropdown icon"></i>
	                        <div class="default text">Select a Month</div>
	                        <div class="menu" id="Menu_Departments_InfractionEntries">
	                        </div>
	                      </div>
	                    </div>

                      </div>  
                      <div class="input-field col s2">
                        <input id=TB_Infraction_Filter_ID type="text" placeholder="Enter Employee ID">
                        <label for="TB_Infraction_Filter_ID">Employee ID</label>
                      </div>                       
                      <div class="input-field col s2">

	                    <div class="ui input" >
	                      <div class="ui selection dropdown item_status col s12" style="margin-left: 10px !important;" >
	                        <input type="hidden" name="Status" id="DP_Infraction_Month_Filter">
	                        <i class="dropdown icon"></i>
	                        <div class="default text">Select a Month</div>
	                        <div class="menu">
	                          <div class="item" data-value="January">January</div>
	                          <div class="item" data-value="February">February</div>
	                          <div class="item" data-value="March">March</div>
	                          <div class="item" data-value="April">April</div>
	                          <div class="item" data-value="May">May</div>
	                          <div class="item" data-value="June">June</div>
	                          <div class="item" data-value="July">July</div>
	                          <div class="item" data-value="August">August</div>
	                          <div class="item" data-value="September">September</div>
	                          <div class="item" data-value="October">October</div>
	                          <div class="item" data-value="November">November</div>
	                          <div class="item" data-value="December">December</div>
	                        </div>
	                      </div>
	                    </div>

                      </div>   
                      <div class="input-field col s2">
                            <a class="light-blue btn waves-effect waves-light" onclick="Validate_Filter_Infractions()"><i class=" material-icons">search</i></a>   
                      </div>   
                      <div class="input-field col s4">
                            <a class="light-blue AlignButtonRight btn waves-effect waves-light" onclick="Refresh_InfractionEntries()"><i class=" material-icons">refresh</i></a>   
                      </div>                                               
    </div>
    <div class="row">
          <table class="bordered responsive-table card-panel z-depth-2" id="Table_Infraction_Entries">
                  <thead>
                    <tr>
                        <th>Employee ID</th>
                        <th>Name</th>
                        <th>Department</th>
                        <th>Date</th>
                        <th>Incident Number</th>
                        <th>Sanction</th>
                        <th>Breach</th>
                        <th>Points</th>
                    </tr>
                  </thead>
              </table>  
      </div>
    </div>

</div>

<!-- ------------------------------------------------------------------------------------------------------------------- -->

  <!--SCRIPT-->

    <script type = "text/javascript" src = "https://code.jquery.com/jquery-2.1.1.min.js"></script>           
    <script src="https://intranet.houseofit.com.au/SiteAssets/CSR%20TEMPLATE/EmployeeProfile/MaterialDesign/js/materialize.min.js"></script>

    <script src="https://intranet.houseofit.com.au/SiteAssets/CSR%20TEMPLATE/EmployeeProfile/MaterialDesign/SweetAlert2/sweetalert2.js"></script>

<!-- SEMANTIC UI -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.3.1/semantic.min.js"></script>

<!-- CHARTS JS -->
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.1/Chart.bundle.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.1/Chart.bundle.min.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.1/Chart.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.1/Chart.min.js"></script>

  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.20.1/moment.min.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.20.1/moment.js"></script>

</body>
 
</html>
